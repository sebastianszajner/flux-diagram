<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FLUX ‚Äî Interaktywna Mapa Kompetencji | Nowe Motywacje</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
  theme: { extend: { colors: {
    flux: { fast: '#f59e0b', liquid: '#06b6d4', unlearn: '#10b981', experiment: '#8b5cf6' },
    dark: { 950: '#0c0f1a', 900: '#111827', 800: '#1e293b', 700: '#334155' }
  }}}
}
</script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
*{font-family:'Inter',system-ui,sans-serif;box-sizing:border-box}
body{background:#0c0f1a;margin:0}
::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:#111827}::-webkit-scrollbar-thumb{background:#334155;border-radius:3px}

/* Diagram */
.flux-quadrant{cursor:pointer;transition:all .4s cubic-bezier(.4,0,.2,1)}
.flux-quadrant:hover{filter:brightness(1.4);transform:scale(1.03)}
.flux-quadrant:hover .qf{opacity:.35}
.qf{transition:opacity .4s}
.center-pulse{animation:cpulse 3s ease-in-out infinite}
@keyframes cpulse{0%,100%{opacity:.15;transform:scale(1)}50%{opacity:.3;transform:scale(1.05)}}

/* Nav */
.nav-link{position:relative;transition:color .3s}
.nav-link::after{content:'';position:absolute;bottom:-2px;left:0;width:0;height:2px;background:#f59e0b;transition:width .3s}
.nav-link:hover::after,.nav-link.active::after{width:100%}

/* Views */
.view{display:none;opacity:0;transition:opacity .3s}
.view.active{display:block;opacity:1}

/* Cards */
.fcard{transition:all .3s;border:1px solid #1e293b}
.fcard:hover{transform:translateY(-3px);box-shadow:0 8px 30px -10px var(--glow,transparent)}

/* Filters */
.chip{transition:all .2s;cursor:pointer;user-select:none;white-space:nowrap}
.chip:hover{transform:scale(1.03)}
.chip.on{ring:2px;box-shadow:0 0 0 2px var(--ring,#f59e0b)}

/* Animations */
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.fade-up{animation:fadeUp .4s ease forwards}

/* Tab */
.tab-btn{transition:all .3s;border-bottom:2px solid transparent}
.tab-btn.active{border-bottom-color:currentColor}
.tab-content{display:none}.tab-content.active{display:block;animation:fadeUp .3s ease}

/* Hamburger */
.hamburger span{display:block;width:20px;height:2px;background:#94a3b8;margin:4px 0;transition:all .3s}
.hamburger.open span:nth-child(1){transform:rotate(45deg) translate(4px,4px)}
.hamburger.open span:nth-child(2){opacity:0}
.hamburger.open span:nth-child(3){transform:rotate(-45deg) translate(4px,-4px)}
.mobile-menu{max-height:0;overflow:hidden;transition:max-height .3s}
.mobile-menu.open{max-height:300px}

/* Chat widget */
.chat-toggle{position:fixed;bottom:24px;right:24px;width:52px;height:52px;border-radius:50%;background:linear-gradient(135deg,#f59e0b,#8b5cf6);cursor:pointer;z-index:9999;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 20px rgba(139,92,246,.4);transition:transform .3s}
.chat-toggle:hover{transform:scale(1.1)}
.chat-panel{position:fixed;bottom:88px;right:24px;width:380px;max-height:520px;background:#111827;border:1px solid #334155;border-radius:16px;z-index:9998;display:none;flex-direction:column;box-shadow:0 20px 60px -10px rgba(0,0,0,.7)}
.chat-panel.open{display:flex}
.chat-messages{flex:1;overflow-y:auto;padding:16px;min-height:200px;max-height:360px}
.chat-msg{margin-bottom:12px;max-width:85%;padding:10px 14px;border-radius:12px;font-size:13px;line-height:1.5}
.chat-msg.user{background:#1e293b;margin-left:auto;color:#e2e8f0}
.chat-msg.assistant{background:linear-gradient(135deg,rgba(245,158,11,.1),rgba(139,92,246,.1));color:#cbd5e1;border:1px solid #334155}
.chat-input-area{border-top:1px solid #1e293b;padding:12px;display:flex;gap:8px}
.chat-input-area textarea{flex:1;background:#0c0f1a;border:1px solid #334155;border-radius:10px;padding:8px 12px;color:#e2e8f0;font-size:13px;resize:none;outline:none;font-family:inherit}
.chat-input-area textarea:focus{border-color:#8b5cf6}
.chat-input-area button{background:#8b5cf6;color:white;border:none;border-radius:10px;padding:8px 14px;cursor:pointer;font-size:13px;font-weight:600}
.chat-input-area button:disabled{opacity:.4;cursor:not-allowed}

/* Settings modal */
.settings-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:10000;display:none;align-items:center;justify-content:center;backdrop-filter:blur(4px)}
.settings-overlay.open{display:flex}

/* Scenario card */
.scenario-card{transition:all .3s;cursor:pointer}
.scenario-card:hover{transform:translateY(-2px);box-shadow:0 8px 30px -8px rgba(0,0,0,.5)}

@media(max-width:768px){
  .chat-panel{right:12px;left:12px;width:auto;bottom:80px}
  .chat-toggle{bottom:16px;right:16px;width:46px;height:46px}
}

/* Projector-friendly base */
html{font-size:18px}
html.projector{font-size:24px}
html.projector .chat-toggle,html.projector .chat-panel{display:none!important}

/* Toggle switch */
.tgl{position:relative;width:44px;height:24px;background:#334155;border-radius:12px;cursor:pointer;transition:background .3s;flex-shrink:0}
.tgl.on{background:#f59e0b}
.tgl::after{content:'';position:absolute;top:2px;left:2px;width:20px;height:20px;background:white;border-radius:50%;transition:transform .3s}
.tgl.on::after{transform:translateX(20px)}

/* Progress bar */
.flux-progress{position:fixed;top:3.5rem;left:0;right:0;height:3px;z-index:49;background:#1e293b;display:none}
.flux-progress-fill{height:100%;background:linear-gradient(90deg,#f59e0b,#06b6d4,#10b981,#8b5cf6);transition:width .5s;border-radius:0 2px 2px 0}

/* Module group card */
.mod-group{border:1px solid #1e293b;border-radius:1rem;padding:1.25rem;margin-bottom:1rem}
.mod-row{display:flex;align-items:center;justify-content:space-between;padding:.75rem 0;border-bottom:1px solid rgba(30,41,59,.5)}
.mod-row:last-child{border-bottom:none}

/* Reflection FAB */
.refl-fab{position:fixed;bottom:1.5rem;left:1.5rem;width:3rem;height:3rem;border-radius:50%;background:linear-gradient(135deg,#10b981,#06b6d4);cursor:pointer;z-index:9997;display:none;align-items:center;justify-content:center;box-shadow:0 4px 20px rgba(16,185,129,.4);transition:transform .3s}
.refl-fab:hover{transform:scale(1.1)}

/* Overlays */
.overlay-modal{position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:10001;display:none;align-items:center;justify-content:center;backdrop-filter:blur(6px)}
.overlay-modal.open{display:flex}

/* ===== ABOUT PANEL ===== */
.about-body{--panel-bg:#0f1535;--card-bg:#162042;--line:rgba(255,255,255,0.08);--accent:#e91e63;--accent2:#9c27b0;--txt-main:#e2e8f0;--txt-muted:#64748b;--bg-panel:rgba(255,255,255,0.03);padding:1.5rem;display:flex;flex-direction:column;gap:1.5rem;max-width:900px;margin:0 auto}
.about-card{background:var(--card-bg);border-radius:1rem;padding:1.5rem;border:1px solid var(--line);display:flex;gap:1.5rem;align-items:flex-start}
.about-photo-wrap{flex-shrink:0;width:140px;height:140px;border-radius:1rem;overflow:hidden;border:2px solid var(--accent)}
.about-photo{width:100%;height:100%;object-fit:cover}
.about-content{flex:1;min-width:0}
.about-name{font-size:1.5rem;font-weight:800;color:white;margin:0 0 .25rem}
.about-role{font-size:.8rem;color:var(--txt-muted);margin:0 0 .75rem}
.about-tags{display:flex;flex-wrap:wrap;gap:.4rem;margin-bottom:.75rem}
.about-tag{font-size:.65rem;padding:3px 10px;border-radius:99px;background:rgba(233,30,99,.1);color:var(--accent);border:1px solid rgba(233,30,99,.2);white-space:nowrap}
.about-desc{font-size:.82rem;line-height:1.6;color:var(--txt-main);margin:0 0 .5rem;opacity:.85}
.about-section-title{font-size:1rem;font-weight:700;color:white;padding-bottom:.5rem;border-bottom:1px solid var(--line)}
.about-intro-text{font-size:.82rem;color:var(--txt-muted);line-height:1.6;margin:0}
.group-process-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1rem}
.group-process-card{background:var(--card-bg);border:1px solid var(--line);border-radius:.75rem;padding:1rem;display:flex;gap:.75rem;align-items:flex-start}
.group-process-icon{font-size:1.5rem;flex-shrink:0;margin-top:2px}
.group-process-title{font-size:.82rem;color:white;display:block;margin-bottom:.25rem}
.group-process-desc{font-size:.75rem;color:var(--txt-muted);line-height:1.5;margin:0}
.about-psych-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}
.about-psych-card{background:var(--card-bg);border:1px solid var(--line);border-radius:.75rem;padding:1rem}
.about-psych-card--wide{grid-column:span 2}
.about-psych-header{display:flex;align-items:center;gap:.5rem;margin-bottom:.5rem}
.about-psych-badge{font-size:.65rem;padding:3px 8px;border-radius:99px;font-weight:600}
.rmp-badge{background:rgba(255,87,34,.15);color:#ff5722}
.perso-badge{background:rgba(33,150,243,.15);color:#2196f3}
.harrison-badge{background:rgba(76,175,80,.15);color:#4caf50}
.opto-badge{background:rgba(156,39,176,.15);color:#ce93d8}
.about-psych-name{font-size:.78rem;color:white;font-weight:600}
.about-psych-desc{font-size:.75rem;color:var(--txt-muted);line-height:1.5;margin:0 0 .75rem}
.drives-list{display:flex;flex-direction:column;gap:.75rem}
.drive-item{display:flex;flex-direction:column;gap:.25rem}
.drive-top{display:flex;align-items:center;gap:.5rem}
.drive-icon{font-size:1rem;flex-shrink:0}
.drive-label{font-size:.75rem;color:white;white-space:nowrap;min-width:120px}
.drive-track{flex:1;height:6px;border-radius:3px;background:rgba(255,255,255,.07);overflow:hidden}
.drive-fill{height:100%;border-radius:3px;transition:width .6s}
.drive-desc{font-size:.7rem;color:var(--txt-muted);line-height:1.4;padding-left:calc(1rem + .5rem + 120px);margin:0}
.people-chips{display:flex;flex-direction:column;gap:.75rem}
.people-chip{display:flex;gap:.6rem;align-items:flex-start}
.people-icon{font-size:1.1rem;flex-shrink:0;margin-top:2px}
.people-chip strong{font-size:.78rem;color:white;display:block;margin-bottom:.1rem}
.people-chip p{font-size:.72rem;color:var(--txt-muted);line-height:1.4;margin:0}
.rmp-bars{display:flex;flex-direction:column;gap:.5rem}
.rmp-row{display:flex;align-items:center;gap:.5rem}
.rmp-label{font-size:.72rem;color:var(--txt-main);flex:1;text-align:left}
.rmp-track{width:80px;height:6px;border-radius:3px;background:rgba(255,255,255,.07);overflow:hidden;flex-shrink:0}
.rmp-fill{height:100%;border-radius:3px;transition:width .6s}
.rmp-val{font-size:.65rem;color:var(--txt-muted);width:30px;text-align:right;flex-shrink:0}
.opto-dims-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:.75rem}
.opto-dim-card{background:var(--bg-panel);border:1px solid var(--line);border-radius:.6rem;padding:.75rem}
.opto-dim-header{display:flex;flex-direction:column;gap:.4rem}
.opto-dim-icon{font-size:1.1rem}
.opto-dim-name{font-size:.78rem;font-weight:700;color:white}
.opto-dim-bars{display:flex;flex-direction:column;gap:.3rem;margin-top:.25rem}
.opto-bar-row{display:flex;align-items:center;gap:.4rem}
.opto-bar-label{font-size:.65rem;color:var(--txt-muted);min-width:100px}
.opto-bar-track{flex:1;height:5px;border-radius:3px;background:rgba(255,255,255,.07);overflow:hidden}
.opto-bar-fill{height:100%;border-radius:3px;transition:width .6s}
.opto-bar-val{font-size:.65rem;font-weight:700;width:20px;text-align:right}
.opto-dim-desc{font-size:.7rem;color:var(--txt-muted);line-height:1.4;margin:.5rem 0 0}
.clients-sectors{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:.75rem}
.clients-sector{background:var(--card-bg);border:1px solid var(--line);border-radius:.6rem;padding:.75rem}
.clients-sector-header{display:flex;align-items:center;gap:.4rem;margin-bottom:.5rem}
.clients-sector-icon{font-size:1rem}
.clients-sector-name{font-size:.75rem;font-weight:600;color:white}
.clients-list{display:flex;flex-wrap:wrap;gap:.3rem}
.client-chip{font-size:.65rem;padding:2px 8px;border-radius:99px;background:rgba(255,255,255,.05);color:var(--txt-muted);border:1px solid var(--line)}
.about-app-note{background:var(--card-bg);border:1px solid var(--line);border-radius:.75rem;padding:1rem}
.about-app-label{font-size:.65rem;text-transform:uppercase;letter-spacing:.1em;color:var(--accent);font-weight:600;display:block;margin-bottom:.4rem}
.about-app-note p{font-size:.78rem;color:var(--txt-muted);line-height:1.5;margin:0}
.about-footer{text-align:center;font-size:.7rem;color:rgba(255,255,255,.25);padding:.5rem 0}
.training-areas-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:.75rem}
.training-area-card{background:var(--card-bg);border:1px solid var(--line);border-radius:.6rem;padding:.75rem;display:flex;flex-direction:column;gap:.5rem}
.training-area-header{display:flex;align-items:center;gap:.6rem}
.training-area-icon{font-size:1.5rem;flex-shrink:0}
.training-area-title{font-size:.82rem;color:white;display:block}
.training-area-level{font-size:.65rem;color:var(--accent);font-weight:600}
.training-area-desc{font-size:.75rem;color:var(--txt-muted);line-height:1.5;margin:0}
.training-area-tags{display:flex;flex-wrap:wrap;gap:.25rem}
.training-area-tag{font-size:.6rem;padding:2px 7px;border-radius:99px;background:rgba(255,255,255,.05);color:var(--txt-muted);border:1px solid var(--line)}
.training-methodologies{background:var(--card-bg);border:1px solid var(--line);border-radius:.6rem;padding:.75rem}
.training-methodologies-label{font-size:.7rem;font-weight:700;color:white;display:block;margin-bottom:.4rem}
.training-methodologies-list{display:flex;flex-wrap:wrap;gap:.35rem}
.training-methodology-chip{font-size:.7rem;padding:3px 10px;border-radius:99px;background:rgba(233,30,99,.1);color:var(--accent);border:1px solid rgba(233,30,99,.2);font-weight:600}
@media(max-width:640px){.about-card{flex-direction:column;align-items:center;text-align:center}.about-photo-wrap{width:110px;height:110px}.about-tags{justify-content:center}.about-psych-grid{grid-template-columns:1fr}.about-psych-card--wide{grid-column:span 1}.drive-desc{padding-left:0}.opto-dims-grid{grid-template-columns:1fr}}

/* Diagnostic scale buttons */
.scale-btn{width:2.5rem;height:2.5rem;border-radius:.5rem;border:1px solid #334155;background:#1e293b;color:#94a3b8;cursor:pointer;font-weight:700;transition:all .2s}
.scale-btn:hover{border-color:#f59e0b;color:#f59e0b}
.scale-btn.selected{background:#f59e0b;color:#0c0f1a;border-color:#f59e0b}

/* ROPES wizard */
.ropes-indicator{display:flex;gap:.5rem;justify-content:center;margin-bottom:1rem}
.ropes-dot{width:2rem;height:2rem;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:700;border:2px solid #334155;color:#64748b;transition:all .3s}
.ropes-dot.active{border-color:#f59e0b;color:#f59e0b;background:rgba(245,158,11,.1)}
.ropes-dot.done{border-color:#10b981;color:#10b981;background:rgba(16,185,129,.1)}

/* Projector toggle btn */
.projector-btn{transition:all .2s}
.projector-btn.on{color:#f59e0b!important}

/* Cloud Tooltip on FLUX wheel */
.flux-tooltip{position:fixed;z-index:100;max-width:320px;max-height:360px;overflow-y:auto;padding:1.25rem;background:rgba(17,24,39,.95);backdrop-filter:blur(12px);border:1px solid rgba(51,65,85,.5);border-radius:1rem;box-shadow:0 20px 60px -10px rgba(0,0,0,.7);opacity:0;transform:translateY(8px);transition:opacity .3s,transform .3s;pointer-events:none}
.flux-tooltip.visible{opacity:1;transform:translateY(0);pointer-events:auto}
.flux-tooltip::after{content:'';position:absolute;width:12px;height:12px;background:rgba(17,24,39,.95);border:1px solid rgba(51,65,85,.5);transform:rotate(45deg)}
.flux-tooltip.tt-fast::after{bottom:-7px;left:30%;border-top:none;border-left:none}
.flux-tooltip.tt-liquid::after{top:-7px;left:30%;border-bottom:none;border-right:none}
.flux-tooltip.tt-unlearn::after{top:-7px;right:30%;border-bottom:none;border-left:none}
.flux-tooltip.tt-experiment::after{bottom:-7px;right:30%;border-top:none;border-right:none}
html.projector .flux-tooltip{max-width:420px;font-size:1.1rem;padding:1.5rem}
@media(max-width:768px){.flux-tooltip{max-width:280px;padding:1rem}}

/* Mini tooltip for FLUX badges */
#mini-tooltip{animation:fadeUp .2s ease}

/* Megaworld badge */
.mw-badge{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:9999px;font-size:10px;font-weight:600;white-space:nowrap}

/* Search overlay */
.search-overlay{position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:10003;display:none;align-items:flex-start;justify-content:center;padding-top:8vh;backdrop-filter:blur(6px)}
.search-overlay.open{display:flex}
.search-box{width:100%;max-width:640px;background:#111827;border:1px solid #334155;border-radius:1rem;overflow:hidden;max-height:78vh;display:flex;flex-direction:column;margin:0 1rem;box-shadow:0 25px 60px -12px rgba(0,0,0,.8)}
.search-input{width:100%;background:transparent;border:none;border-bottom:1px solid #1e293b;padding:1rem 1.25rem;color:#e2e8f0;font-size:1rem;outline:none;font-family:inherit}
.search-input::placeholder{color:#475569}
.search-results{overflow-y:auto;padding:.75rem;max-height:60vh}
.search-result{padding:.75rem 1rem;border-radius:.75rem;cursor:pointer;transition:background .2s;margin-bottom:.25rem}
.search-result:hover{background:rgba(245,158,11,.08)}
.search-cat{font-size:9px;text-transform:uppercase;letter-spacing:2px;color:#64748b;padding:.5rem 1rem;font-weight:600}
.search-kbd{display:inline-flex;align-items:center;padding:2px 6px;border-radius:4px;font-size:10px;background:#1e293b;color:#64748b;border:1px solid #334155;font-family:monospace}

/* Download button */
.dl-btn{display:inline-flex;align-items:center;gap:4px;padding:4px 12px;border-radius:.5rem;font-size:11px;background:rgba(245,158,11,.08);color:#f59e0b;border:1px solid rgba(245,158,11,.15);cursor:pointer;transition:all .2s;font-weight:500}
.dl-btn:hover{background:rgba(245,158,11,.18);transform:translateY(-1px)}

/* Scroll to top */
.scroll-top{position:fixed;bottom:5.5rem;right:1.5rem;width:2.5rem;height:2.5rem;border-radius:50%;background:#1e293b;border:1px solid #334155;color:#94a3b8;cursor:pointer;z-index:9996;display:none;align-items:center;justify-content:center;transition:all .3s;font-size:1rem}
.scroll-top:hover{background:#334155;color:white;transform:translateY(-2px)}
.scroll-top.show{display:flex}

/* Section header with download */
.section-header{display:flex;align-items:center;justify-content:center;gap:.75rem;flex-wrap:wrap}
.section-header .dl-btn{margin-top:.25rem}

/* Quick challenge chips */
.challenge-quick{display:inline-flex;align-items:center;gap:4px;padding:6px 14px;border-radius:2rem;font-size:12px;background:#1e293b;color:#94a3b8;border:1px solid #334155;cursor:pointer;transition:all .2s;white-space:nowrap}
.challenge-quick:hover{background:rgba(245,158,11,.1);border-color:#f59e0b;color:#f59e0b}

/* Cross-link pill */
.cross-link{display:inline-flex;align-items:center;gap:3px;padding:2px 10px;border-radius:9999px;font-size:10px;cursor:pointer;transition:all .2s;text-decoration:none}
.cross-link:hover{filter:brightness(1.3);transform:translateY(-1px)}
</style>
</head>
<body class="min-h-screen text-slate-100">

<!-- ========== NAV ========== -->
<nav class="fixed top-0 left-0 right-0 z-50 bg-dark-950/90 backdrop-blur-xl border-b border-dark-700/50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 h-14 flex items-center justify-between">
    <div class="flex items-center gap-2">
      <div class="w-7 h-7 rounded-lg bg-gradient-to-br from-amber-500 via-cyan-500 to-violet-500 flex items-center justify-center"><span class="text-[10px] font-black text-white">F</span></div>
      <span class="font-bold text-base">FLUX</span>
      <span class="text-slate-600 text-xs hidden sm:inline">| Nowe Motywacje</span>
      <span class="text-slate-700 text-xs hidden sm:inline">¬∑</span>
      <a onclick="nav('about')" class="nav-link text-xs font-medium text-slate-500 hover:text-amber-400 cursor-pointer hidden sm:inline" data-v="about">O autorze</a>
    </div>
    <!-- Desktop nav -->
    <div class="hidden md:flex items-center gap-6">
      <a onclick="nav('home')" class="nav-link active text-xs font-medium text-slate-400 hover:text-white cursor-pointer" data-v="home">Model</a>
      <a onclick="nav('explore')" class="nav-link text-xs font-medium text-slate-400 hover:text-white cursor-pointer" data-v="explore">Eksplorator</a>
      <a onclick="nav('trends')" class="nav-link text-xs font-medium text-slate-400 hover:text-white cursor-pointer" data-v="trends">Trendy</a>
      <a onclick="nav('research')" class="nav-link text-xs font-medium text-slate-400 hover:text-white cursor-pointer" data-v="research">Badania</a>
      <a onclick="nav('tools')" class="nav-link text-xs font-medium text-slate-400 hover:text-white cursor-pointer" data-v="tools">Narzƒôdzia</a>
      <button onclick="openSearch()" class="text-slate-500 hover:text-white transition-colors" title="Szukaj (Ctrl+K)">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
      </button>
      <button onclick="toggleProjector()" class="projector-btn text-slate-500 hover:text-white transition-colors" title="Tryb projektorowy">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
      </button>
      <button onclick="openSettings()" class="text-slate-500 hover:text-white transition-colors" title="Ustawienia">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.066 2.573c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.573 1.066c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.066-2.573c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
      </button>
    </div>
    <!-- Mobile hamburger -->
    <button class="hamburger md:hidden" onclick="toggleMobile()"><span></span><span></span><span></span></button>
  </div>
  <!-- Mobile menu -->
  <div class="mobile-menu md:hidden bg-dark-950 border-t border-dark-700/50 px-4">
    <div class="py-3 space-y-2">
      <a onclick="nav('home');toggleMobile()" class="block py-2 text-sm text-slate-400 hover:text-white cursor-pointer">Model FLUX</a>
      <a onclick="nav('explore');toggleMobile()" class="block py-2 text-sm text-slate-400 hover:text-white cursor-pointer">Eksplorator</a>
      <a onclick="nav('trends');toggleMobile()" class="block py-2 text-sm text-slate-400 hover:text-white cursor-pointer">Trendy</a>
      <a onclick="nav('research');toggleMobile()" class="block py-2 text-sm text-slate-400 hover:text-white cursor-pointer">Badania</a>
      <a onclick="nav('tools');toggleMobile()" class="block py-2 text-sm text-slate-400 hover:text-white cursor-pointer">Narzƒôdzia</a>
      <a onclick="nav('about');toggleMobile()" class="block py-2 text-sm text-slate-400 hover:text-white cursor-pointer">O mnie</a>
      <a onclick="openSettings();toggleMobile()" class="block py-2 text-sm text-slate-400 hover:text-white cursor-pointer">Ustawienia Gemini</a>
    </div>
  </div>
</nav>

<!-- ========== HOME ========== -->
<section id="view-home" class="view active pt-16">
<div class="max-w-7xl mx-auto px-4 sm:px-6 py-6">
  <div class="text-center mb-6">
    <h1 class="text-4xl sm:text-5xl font-black"><span class="text-amber-400">F</span><span class="text-cyan-400">L</span><span class="text-emerald-400">U</span><span class="text-violet-400">X</span> <span class="text-white">Model</span></h1>
    <p class="text-slate-400 text-base sm:text-lg mt-2 max-w-xl mx-auto">Rama kompetencyjno-operacyjna do funkcjonowania w ≈õwiecie zmienno≈õci.</p>
  </div>
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 items-start">
    <!-- Left cards -->
    <div class="space-y-3 order-2 lg:order-1">
      <div class="fcard rounded-xl p-4 bg-dark-900 cursor-pointer" style="--glow:rgba(245,158,11,.15)" onclick="showDetail('fast')">
        <div class="flex items-center gap-2 mb-2"><div class="w-8 h-8 rounded-lg bg-amber-500/20 flex items-center justify-center"><span class="text-amber-400 font-black">F</span></div><div><h3 class="font-bold text-sm text-amber-400">FAST</h3><p class="text-[10px] text-slate-500">Tempo decyzji i dzia≈Çania</p></div></div>
        <p class="text-xs text-slate-400">Szybkie reagowanie i podejmowanie decyzji w warunkach niepewno≈õci.</p>
      </div>
      <div class="fcard rounded-xl p-4 bg-dark-900 cursor-pointer" style="--glow:rgba(16,185,129,.15)" onclick="showDetail('unlearn')">
        <div class="flex items-center gap-2 mb-2"><div class="w-8 h-8 rounded-lg bg-emerald-500/20 flex items-center justify-center"><span class="text-emerald-400 font-black">U</span></div><div><h3 class="font-bold text-sm text-emerald-400">UNLEARN & RELEARN</h3><p class="text-[10px] text-slate-500">Uczenie siƒô i aktualizacja</p></div></div>
        <p class="text-xs text-slate-400">≈öwiadome porzucanie przestarza≈Çych modeli mentalnych.</p>
      </div>
    </div>
    <!-- Diagram -->
    <div class="flex justify-center order-1 lg:order-2" style="position:relative">
      <div class="w-full max-w-[440px] aspect-square">
        <svg viewBox="0 0 800 800" class="w-full h-full">
          <defs><radialGradient id="cg" cx="50%" cy="50%" r="50%"><stop offset="0%" stop-color="#1e293b"/><stop offset="100%" stop-color="#0c0f1a"/></radialGradient></defs>
          <circle cx="400" cy="400" r="350" fill="none" stroke="#1e293b" stroke-width=".5" stroke-dasharray="4 4"/>
          <circle cx="400" cy="400" r="260" fill="none" stroke="#1e293b" stroke-width=".5" stroke-dasharray="4 4"/>
          <line x1="400" y1="50" x2="400" y2="750" stroke="#1e293b" stroke-width=".5"/>
          <line x1="50" y1="400" x2="750" y2="400" stroke="#1e293b" stroke-width=".5"/>
          <g class="flux-quadrant" onclick="showDetail('fast')"><path d="M400,400 L400,50 A350,350 0 0,1 750,400 Z" class="qf" fill="#f59e0b" opacity=".12"/><text x="570" y="210" text-anchor="middle" fill="#f59e0b" font-size="24" font-weight="800" letter-spacing="3">FAST</text><text x="570" y="230" text-anchor="middle" fill="#f59e0b" font-size="9" opacity=".5">Tempo decyzji</text></g>
          <g class="flux-quadrant" onclick="showDetail('liquid')"><path d="M400,400 L750,400 A350,350 0 0,1 400,750 Z" class="qf" fill="#06b6d4" opacity=".12"/><text x="570" y="580" text-anchor="middle" fill="#06b6d4" font-size="24" font-weight="800" letter-spacing="3">LIQUID</text><text x="570" y="600" text-anchor="middle" fill="#06b6d4" font-size="9" opacity=".5">Wsp√≥≈Çpraca</text></g>
          <g class="flux-quadrant" onclick="showDetail('unlearn')"><path d="M400,400 L400,750 A350,350 0 0,1 50,400 Z" class="qf" fill="#10b981" opacity=".12"/><text x="230" y="580" text-anchor="middle" fill="#10b981" font-size="20" font-weight="800" letter-spacing="2">UNLEARN</text><text x="230" y="600" text-anchor="middle" fill="#10b981" font-size="9" opacity=".5">Adaptacja</text></g>
          <g class="flux-quadrant" onclick="showDetail('experiment')"><path d="M400,400 L50,400 A350,350 0 0,1 400,50 Z" class="qf" fill="#8b5cf6" opacity=".12"/><text x="220" y="210" text-anchor="middle" fill="#8b5cf6" font-size="18" font-weight="800" letter-spacing="2">EXPERIMENT</text><text x="220" y="230" text-anchor="middle" fill="#8b5cf6" font-size="9" opacity=".5">Innowacje</text></g>
          <!-- Trend dots (dynamically populated) -->
          <g id="wheel-trend-dots"></g>
          <circle cx="400" cy="400" r="65" fill="url(#cg)" stroke="#334155" stroke-width="1"/>
          <circle cx="400" cy="400" r="70" fill="none" stroke="#f59e0b" stroke-width=".5" opacity=".3" class="center-pulse"/>
          <text x="400" y="395" text-anchor="middle" fill="white" font-size="26" font-weight="900" letter-spacing="5">FLUX</text>
          <text x="400" y="414" text-anchor="middle" fill="#64748b" font-size="8" letter-spacing="2">KLIKNIJ OBSZAR</text>
        </svg>
      </div>
    </div>
    <!-- Right cards -->
    <div class="space-y-3 order-3">
      <div class="fcard rounded-xl p-4 bg-dark-900 cursor-pointer" style="--glow:rgba(6,182,212,.15)" onclick="showDetail('liquid')">
        <div class="flex items-center gap-2 mb-2"><div class="w-8 h-8 rounded-lg bg-cyan-500/20 flex items-center justify-center"><span class="text-cyan-400 font-black">L</span></div><div><h3 class="font-bold text-sm text-cyan-400">LIQUID</h3><p class="text-[10px] text-slate-500">Wsp√≥≈Çpraca i przep≈Çyw</p></div></div>
        <p class="text-xs text-slate-400">P≈Çynno≈õƒá struktur, r√≥l i przep≈Çywu wiedzy. Bezpiecze≈Ñstwo psychologiczne.</p>
      </div>
      <div class="fcard rounded-xl p-4 bg-dark-900 cursor-pointer" style="--glow:rgba(139,92,246,.15)" onclick="showDetail('experiment')">
        <div class="flex items-center gap-2 mb-2"><div class="w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center"><span class="text-violet-400 font-black">X</span></div><div><h3 class="font-bold text-sm text-violet-400">EXPERIMENT</h3><p class="text-[10px] text-slate-500">Eksperymentowanie</p></div></div>
        <p class="text-xs text-slate-400">Systematyczne testowanie hipotez, uczenie siƒô z b≈Çƒôd√≥w.</p>
      </div>
    </div>
  </div>
  <!-- Evolution bar -->
  <div class="mt-8 bg-dark-900/50 border border-dark-700/50 rounded-xl p-4">
    <div class="flex items-center justify-center gap-3 overflow-x-auto text-xs">
      <span class="px-3 py-1 rounded-lg bg-slate-800/50 text-slate-500 whitespace-nowrap">VUCA <span class="text-[9px] text-slate-600">1987</span></span>
      <span class="text-slate-700">‚Üí</span>
      <span class="px-3 py-1 rounded-lg bg-slate-800/50 text-slate-500 whitespace-nowrap">BANI <span class="text-[9px] text-slate-600">2020</span></span>
      <span class="text-slate-700">‚Üí</span>
      <span class="px-4 py-1.5 rounded-lg bg-gradient-to-r from-amber-500/10 via-cyan-500/10 to-violet-500/10 border border-amber-500/20 whitespace-nowrap font-bold bg-clip-text"><span class="bg-gradient-to-r from-amber-400 via-cyan-400 to-violet-400 bg-clip-text text-transparent">FLUX</span> <span class="text-[9px] text-slate-400">2025+</span></span>
    </div>
  </div>
</div>
</section>

<!-- ========== DETAIL ========== -->
<section id="view-detail" class="view pt-16">
<div class="max-w-5xl mx-auto px-4 sm:px-6 py-6">
  <button onclick="nav('home')" class="flex items-center gap-1 text-xs text-slate-500 hover:text-white mb-4"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>Powr√≥t</button>
  <div id="detail-header"></div>
  <div class="flex gap-4 border-b border-dark-700 mb-4 mt-4 overflow-x-auto" id="detail-tabs"></div>
  <div id="detail-content"></div>
</div>
</section>

<!-- ========== EXPLORE (SCENARIOS + FILTERS) ========== -->
<section id="view-explore" class="view pt-16">
<div class="max-w-6xl mx-auto px-4 sm:px-6 py-6">
  <div class="text-center mb-6">
    <div class="section-header"><h2 class="text-2xl sm:text-3xl font-black">Eksplorator <span class="text-amber-400">FLUX</span></h2><button class="dl-btn" onclick="downloadSection('explore')">üì• Pobierz</button></div>
    <p class="text-slate-400 text-sm">Filtruj scenariusze po roli, bran≈ºy, sytuacji i typie wyzwania.</p>
  </div>
  <!-- FILTER BAR -->
  <div class="bg-dark-900 border border-dark-700 rounded-xl p-4 mb-6 space-y-3" id="filter-bar">
    <!-- FLUX Area -->
    <div>
      <p class="text-xs uppercase tracking-widest text-slate-500 mb-2">Obszar FLUX</p>
      <div class="flex flex-wrap gap-1.5">
        <span class="chip on text-sm px-4 py-1.5 rounded-full bg-slate-800 text-slate-300 border border-slate-700" style="--ring:#94a3b8" data-f="area" data-v="all" onclick="toggleFilter(this)">Wszystkie</span>
        <span class="chip text-sm px-4 py-1.5 rounded-full bg-amber-500/10 text-amber-400 border border-amber-500/20" style="--ring:#f59e0b" data-f="area" data-v="fast" onclick="toggleFilter(this)">F ‚Äî FAST</span>
        <span class="chip text-sm px-4 py-1.5 rounded-full bg-cyan-500/10 text-cyan-400 border border-cyan-500/20" style="--ring:#06b6d4" data-f="area" data-v="liquid" onclick="toggleFilter(this)">L ‚Äî LIQUID</span>
        <span class="chip text-sm px-4 py-1.5 rounded-full bg-emerald-500/10 text-emerald-400 border border-emerald-500/20" style="--ring:#10b981" data-f="area" data-v="unlearn" onclick="toggleFilter(this)">U ‚Äî UNLEARN</span>
        <span class="chip text-sm px-4 py-1.5 rounded-full bg-violet-500/10 text-violet-400 border border-violet-500/20" style="--ring:#8b5cf6" data-f="area" data-v="experiment" onclick="toggleFilter(this)">X ‚Äî EXPERIMENT</span>
      </div>
    </div>
    <!-- Industry -->
    <div>
      <p class="text-xs uppercase tracking-widest text-slate-500 mb-2">Bran≈ºa</p>
      <div class="flex flex-wrap gap-1.5" id="industry-chips"></div>
    </div>
    <!-- Role type -->
    <div>
      <p class="text-xs uppercase tracking-widest text-slate-500 mb-2">Rola / Stanowisko</p>
      <div class="flex flex-wrap gap-1.5" id="role-chips"></div>
    </div>
    <!-- Situation -->
    <div>
      <p class="text-xs uppercase tracking-widest text-slate-500 mb-2">Sytuacja</p>
      <div class="flex flex-wrap gap-1.5" id="situation-chips"></div>
    </div>
    <!-- Life context -->
    <div>
      <p class="text-xs uppercase tracking-widest text-slate-500 mb-2">Kontekst ≈ºyciowy</p>
      <div class="flex flex-wrap gap-1.5" id="context-chips"></div>
    </div>
    <!-- Challenge type -->
    <div>
      <p class="text-xs uppercase tracking-widest text-slate-500 mb-2">Typ wyzwania</p>
      <div class="flex flex-wrap gap-1.5" id="challenge-chips"></div>
    </div>
    <div class="flex justify-between items-center pt-2 border-t border-dark-700">
      <span class="text-[10px] text-slate-600" id="result-count">0 scenariuszy</span>
      <button onclick="resetFilters()" class="text-[10px] text-slate-500 hover:text-white">Resetuj filtry</button>
    </div>
  </div>
  <!-- Results -->
  <div id="explore-results" class="grid grid-cols-1 md:grid-cols-2 gap-3"></div>
</div>
</section>

<!-- ========== TRENDS ========== -->
<section id="view-trends" class="view pt-16">
<div class="max-w-7xl mx-auto px-4 sm:px-6 py-6">
  <div class="text-center mb-6">
    <div class="section-header"><h2 class="text-2xl sm:text-3xl font-black">Mapa Trend√≥w <span class="text-amber-400">FLUX</span></h2><button class="dl-btn" onclick="downloadSection('trends')">üì• Pobierz</button></div>
    <p class="text-slate-400 text-sm">Trendy wg horyzontu czasowego i obszaru FLUX. <button onclick="openSearch()" class="text-amber-400 hover:underline text-sm">üîç Szukaj po wyzwaniu ‚Üí</button></p>
  </div>
  <div class="flex justify-center gap-2 mb-6 flex-wrap">
    <button onclick="filterTrends('all')" class="tf on px-3 py-1 rounded-full text-[11px] bg-slate-800 text-slate-300 border border-slate-700">Wszystkie</button>
    <button onclick="filterTrends('fast')" class="tf px-3 py-1 rounded-full text-[11px] bg-amber-500/10 text-amber-400 border border-amber-500/20">FAST</button>
    <button onclick="filterTrends('liquid')" class="tf px-3 py-1 rounded-full text-[11px] bg-cyan-500/10 text-cyan-400 border border-cyan-500/20">LIQUID</button>
    <button onclick="filterTrends('unlearn')" class="tf px-3 py-1 rounded-full text-[11px] bg-emerald-500/10 text-emerald-400 border border-emerald-500/20">UNLEARN</button>
    <button onclick="filterTrends('experiment')" class="tf px-3 py-1 rounded-full text-[11px] bg-violet-500/10 text-violet-400 border border-violet-500/20">EXPERIMENT</button>
  </div>
  <div class="flex justify-center"><div class="w-full max-w-[900px]" style="aspect-ratio:1/1"><svg id="trend-map" viewBox="0 0 1400 1400" class="w-full h-full"></svg></div></div>
  <div id="trend-filters" class="mt-4 max-w-3xl mx-auto"></div>
  <div class="flex justify-center gap-6 mt-4 text-[10px] text-slate-500 flex-wrap">
    <span class="flex items-center gap-1"><span class="w-1.5 h-1.5 rounded-full bg-white/30"></span>NOW</span>
    <span class="flex items-center gap-1"><span class="w-1.5 h-1.5 rounded-full bg-white/20"></span>NEW 1‚Äì2y</span>
    <span class="flex items-center gap-1"><span class="w-1.5 h-1.5 rounded-full bg-white/10"></span>NEXT 3‚Äì5y</span>
    <span class="flex items-center gap-1"><span class="w-1.5 h-1.5 rounded-full bg-white/5"></span>BEYOND 5+</span>
  </div>
</div>
</section>

<!-- ========== RESEARCH ========== -->
<section id="view-research" class="view pt-16">
<div class="max-w-5xl mx-auto px-4 sm:px-6 py-6">
  <div class="text-center mb-6">
    <div class="section-header"><h2 class="text-2xl sm:text-3xl font-black">Biblioteka <span class="text-emerald-400">Bada≈Ñ</span></h2><button class="dl-btn" onclick="downloadSection('research')">üì• Pobierz</button></div>
    <p class="text-slate-400 text-sm">Evidence-based: badania naukowe stojƒÖce za modelem FLUX.</p>
  </div>
  <div class="flex justify-center gap-2 mb-6 flex-wrap">
    <button onclick="filterRes('all')" class="rf on px-3 py-1 rounded-full text-[11px] bg-slate-800 text-slate-300 border border-slate-700">Wszystkie</button>
    <button onclick="filterRes('fast')" class="rf px-3 py-1 rounded-full text-[11px] bg-amber-500/10 text-amber-400 border border-amber-500/20">FAST</button>
    <button onclick="filterRes('liquid')" class="rf px-3 py-1 rounded-full text-[11px] bg-cyan-500/10 text-cyan-400 border border-cyan-500/20">LIQUID</button>
    <button onclick="filterRes('unlearn')" class="rf px-3 py-1 rounded-full text-[11px] bg-emerald-500/10 text-emerald-400 border border-emerald-500/20">UNLEARN</button>
    <button onclick="filterRes('experiment')" class="rf px-3 py-1 rounded-full text-[11px] bg-violet-500/10 text-violet-400 border border-violet-500/20">EXPERIMENT</button>
  </div>
  <div id="research-grid" class="grid grid-cols-1 md:grid-cols-2 gap-3"></div>
</div>
</section>

<!-- ========== TOOLS ========== -->
<section id="view-tools" class="view pt-16">
<div class="max-w-5xl mx-auto px-4 sm:px-6 py-6">
  <div class="text-center mb-6">
    <div class="section-header"><h2 class="text-2xl sm:text-3xl font-black">Narzƒôdzia <span class="text-violet-400">FLUX</span></h2><button class="dl-btn" onclick="downloadSection('tools')">üì• Pobierz</button></div>
    <p class="text-slate-400 text-sm">Gotowe klocki: checklisty, canvasy, prompty, diagnostyki.</p>
  </div>
  <div id="tools-grid"></div>
</div>
</section>

<!-- ========== DIAGNOSTIC ========== -->
<section id="view-diagnostic" class="view pt-16">
<div class="max-w-4xl mx-auto px-4 sm:px-6 py-6">
  <div class="text-center mb-6">
    <h2 class="text-2xl sm:text-3xl font-black">Diagnostyka <span class="text-amber-400">FLUX</span></h2>
    <p class="text-slate-400 text-sm">Oce≈Ñ swoje kompetencje w 4 obszarach FLUX (skala 1-5).</p>
  </div>
  <div id="diagnostic-content"></div>
</div>
</section>

<!-- ========== ACTION PLAN ========== -->
<section id="view-actionplan" class="view pt-16">
<div class="max-w-4xl mx-auto px-4 sm:px-6 py-6">
  <div class="text-center mb-6">
    <h2 class="text-2xl sm:text-3xl font-black">Action Plan <span class="text-amber-400">Builder</span></h2>
    <p class="text-slate-400 text-sm">Zaplanuj konkretne dzia≈Çania z deadlinami i metrykami sukcesu.</p>
  </div>
  <div id="actionplan-content"></div>
</div>
</section>

<!-- ========== TRAINER ========== -->
<section id="view-trainer" class="view pt-16">
<div class="max-w-5xl mx-auto px-4 sm:px-6 py-6">
  <div class="text-center mb-6">
    <h2 class="text-2xl sm:text-3xl font-black">Trainer <span class="text-violet-400">Dashboard</span></h2>
    <p class="text-slate-400 text-sm">Panel trenera: QR code, diagnostyki, gap analysis.</p>
  </div>
  <div id="trainer-content"></div>
</div>
</section>

<!-- ========== MODULES ========== -->
<section id="view-modules" class="view pt-16">
<div class="max-w-3xl mx-auto px-4 sm:px-6 py-6">
  <div class="text-center mb-6">
    <h2 class="text-2xl sm:text-3xl font-black">Modu≈Çy <span class="text-amber-400">FLUX</span></h2>
    <p class="text-slate-400 text-sm">W≈ÇƒÖczaj i wy≈ÇƒÖczaj funkcje aplikacji wg potrzeb.</p>
  </div>
  <div id="modules-content"></div>
</div>
</section>

<!-- ========== ABOUT ========== -->
<section id="view-about" class="view pt-16">
<div class="about-body">

  <!-- Hero card -->
  <div class="about-card">
    <div class="about-photo-wrap">
      <img src="author.jpg" alt="Sebastian Szajner" class="about-photo">
    </div>
    <div class="about-content">
      <h2 class="about-name">Sebastian Szajner</h2>
      <p class="about-role">Trener ¬∑ Konsultant ¬∑ Coach ¬∑ Psycholog</p>
      <div class="about-tags">
        <span class="about-tag">C-level</span>
        <span class="about-tag">N-1 / N-2</span>
        <span class="about-tag">ZarzƒÖdzanie</span>
        <span class="about-tag">Przyw√≥dztwo</span>
        <span class="about-tag">Psychologia sprzeda≈ºy</span>
        <span class="about-tag">Efektywno≈õƒá osobista</span>
        <span class="about-tag">AI w biznesie</span>
      </div>
      <p class="about-desc">
        Trener i konsultant z ponad <strong>10-letnim do≈õwiadczeniem</strong> w obszarze
        szkole≈Ñ i rozwoju (L&amp;D). Wcze≈õniej pracowa≈Ç bezpo≈õrednio w sprzeda≈ºy
        (m.in. Noble Bank), przeszed≈Ç pe≈ÇnƒÖ ≈õcie≈ºkƒô ‚Äî od trenera wewnƒôtrznego,
        przez L&amp;D Experta i Senior Trenera Sprzeda≈ºy, po Kierownika Szkole≈Ñ.
      </p>
      <p class="about-desc">
        Specjalizuje siƒô w szkoleniach z zakresu <strong>psychologii sprzeda≈ºy</strong>,
        <strong>efektywno≈õci osobistej</strong> i <strong>zarzƒÖdzania</strong>.
        Ponad <strong>6 000 godzin</strong> pracy warsztatowej. Od 2023 roku szkoli
        dzia≈Çy sprzeda≈ºy z <strong>efektywnego u≈ºycia AI</strong>. Prowadzi szkolenia
        w jƒôzyku polskim i angielskim.
      </p>
    </div>
  </div>

  <!-- Podej≈õcie do procesu grupowego -->
  <div class="about-section-title">Podej≈õcie do procesu grupowego</div>
  <p class="about-intro-text">
    Warsztat to ≈ºywy organizm. To, co dzieje siƒô miƒôdzy lud≈∫mi ‚Äî dynamika, napiƒôcia,
    energie ‚Äî ma r√≥wnie du≈ºe znaczenie jak tre≈õƒá merytoryczna. Poni≈ºej kilka zasad,
    kt√≥rymi kierujƒô siƒô podczas pracy z grupƒÖ.
  </p>
  <div class="group-process-grid">
    <div class="group-process-card"><div class="group-process-icon">üé≤</div><div><strong class="group-process-title">Losowo≈õƒá jako narzƒôdzie, nie chaos</strong><p class="group-process-desc">Podzia≈Ç na grupy i losowanie uczestnik√≥w to nie tylko "kto z kim" ‚Äî to ≈õwiadoma interwencja w dynamikƒô grupy. Losowo≈õƒá rozbija nieformalne koalicje, wymusza nowe perspektywy i tworzy warunki do autentycznej wsp√≥≈Çpracy.</p></div></div>
    <div class="group-process-card"><div class="group-process-icon">üå°Ô∏è</div><div><strong class="group-process-title">Temperatura grupy</strong><p class="group-process-desc">Na ka≈ºdym etapie warsztatu monitorujƒô poziom energii, napiƒôcia i zaanga≈ºowania. Wiem, kiedy przyspieszyƒá, kiedy zwolniƒá ‚Äî i kiedy potrzebny jest reset. Narzƒôdzia jak losowanie czy ko≈Ço fortuny pomagajƒÖ zmieniaƒá rytm i utrzymywaƒá uwagƒô.</p></div></div>
    <div class="group-process-card"><div class="group-process-icon">üß±</div><div><strong class="group-process-title">Fazy grupowe ‚Äî od formowania do dzia≈Çania</strong><p class="group-process-desc">Grupy przechodzƒÖ przez przewidywalne fazy: forming ‚Üí storming ‚Üí norming ‚Üí performing. Dobry trener nie omija "stormingu" ‚Äî pomaga grupie przez niego przej≈õƒá. Losujƒô, mieszam sk≈Çady i prowokujƒô dialog w≈Ça≈õnie wtedy, gdy jest to najbardziej potrzebne.</p></div></div>
    <div class="group-process-card"><div class="group-process-icon">üéØ</div><div><strong class="group-process-title">Struktura, kt√≥ra uwalnia</strong><p class="group-process-desc">Paradoks procesu grupowego: im lepsza struktura, tym wiƒôcej swobody tw√≥rczej. Jasne zasady losowania, przejrzyste regu≈Çy gry i przewidywalny rytm dajƒÖ uczestnikom poczucie bezpiecze≈Ñstwa ‚Äî i przestrze≈Ñ do autentycznego zaanga≈ºowania.</p></div></div>
    <div class="group-process-card"><div class="group-process-icon">üëÅÔ∏è</div><div><strong class="group-process-title">Uwa≈ºno≈õƒá na to, co niewidoczne</strong><p class="group-process-desc">Dynamika grupy dzieje siƒô zar√≥wno w s≈Çowach, jak i miƒôdzy nimi. Obserwujƒô, kto milczy, kto dominuje, jakie nieformalne role siƒô tworzƒÖ. Narzƒôdzia losowania pomagajƒÖ mi jako trenerowi ‚Äî bez t≈Çumaczenia siƒô ‚Äî zmieniƒá uk≈Çad si≈Ç i daƒá g≈Ços tym, kt√≥rzy go nie zabierajƒÖ.</p></div></div>
  </div>

  <!-- Tematy szkoleniowe & kompetencje -->
  <div class="about-section-title">Tematy szkoleniowe & kompetencje</div>
  <p class="about-intro-text">
    7 g≈Ç√≥wnych obszar√≥w tematycznych, w kt√≥rych prowadzƒô szkolenia i warsztaty.
    Ka≈ºdy temat adaptujƒô do poziomu grupy ‚Äî od podstawowego po zaawansowany.
  </p>
  <div class="training-areas-grid">
    <div class="training-area-card"><div class="training-area-header"><span class="training-area-icon">ü§ñ</span><div><strong class="training-area-title">AI w biznesie</strong><span class="training-area-level">Flagowy temat</span></div></div><p class="training-area-desc">Od podstaw po zaawansowane wdro≈ºenia. Prompt engineering, automatyzacja proces√≥w, AI w sprzeda≈ºy i zarzƒÖdzaniu.</p><div class="training-area-tags"><span class="training-area-tag">ChatGPT</span><span class="training-area-tag">Claude</span><span class="training-area-tag">Gemini</span><span class="training-area-tag">Copilot</span><span class="training-area-tag">Automatyzacja</span></div></div>
    <div class="training-area-card"><div class="training-area-header"><span class="training-area-icon">üß†</span><div><strong class="training-area-title">Psychologia sprzeda≈ºy</strong><span class="training-area-level">2 dni</span></div></div><p class="training-area-desc">Challenger Sale, SPIN Selling, psychologia decyzji zakupowych, praca z oporem klienta.</p><div class="training-area-tags"><span class="training-area-tag">Challenger Sale</span><span class="training-area-tag">SPIN</span><span class="training-area-tag">Negocjacje</span><span class="training-area-tag">Obiekcje</span></div></div>
    <div class="training-area-card"><div class="training-area-header"><span class="training-area-icon">üí¨</span><div><strong class="training-area-title">Komunikacja</strong><span class="training-area-level">1‚Äì2 dni</span></div></div><p class="training-area-desc">Feedback, NVC, prezentacje, storytelling, trudne rozmowy, asertywno≈õƒá.</p><div class="training-area-tags"><span class="training-area-tag">NVC</span><span class="training-area-tag">Feedback</span><span class="training-area-tag">Storytelling</span><span class="training-area-tag">Asertywno≈õƒá</span></div></div>
    <div class="training-area-card"><div class="training-area-header"><span class="training-area-icon">üëî</span><div><strong class="training-area-title">ZarzƒÖdzanie & Przyw√≥dztwo</strong><span class="training-area-level">1‚Äì2 dni</span></div></div><p class="training-area-desc">VUCA leadership, zarzƒÖdzanie zespo≈Çem, delegowanie, motywowanie, zarzƒÖdzanie zmianƒÖ.</p><div class="training-area-tags"><span class="training-area-tag">VUCA</span><span class="training-area-tag">Delegowanie</span><span class="training-area-tag">Motywacja</span><span class="training-area-tag">Zmiana</span></div></div>
    <div class="training-area-card"><div class="training-area-header"><span class="training-area-icon">‚ö°</span><div><strong class="training-area-title">Efektywno≈õƒá osobista</strong><span class="training-area-level">1 dzie≈Ñ</span></div></div><p class="training-area-desc">GTD, Deep Work, zarzƒÖdzanie energiƒÖ, priorytetyzacja, produktywno≈õƒá w erze AI.</p><div class="training-area-tags"><span class="training-area-tag">GTD</span><span class="training-area-tag">Deep Work</span><span class="training-area-tag">Priorytety</span><span class="training-area-tag">Nawyki</span></div></div>
    <div class="training-area-card"><div class="training-area-header"><span class="training-area-icon">üë•</span><div><strong class="training-area-title">Praca z grupƒÖ</strong><span class="training-area-level">1‚Äì2 dni</span></div></div><p class="training-area-desc">Dynamika grupowa, facylitacja, moderowanie dyskusji, zarzƒÖdzanie konfliktem w grupie.</p><div class="training-area-tags"><span class="training-area-tag">Facylitacja</span><span class="training-area-tag">Dynamika</span><span class="training-area-tag">Tuckman</span><span class="training-area-tag">World Caf√©</span></div></div>
    <div class="training-area-card"><div class="training-area-header"><span class="training-area-icon">üéì</span><div><strong class="training-area-title">Train the Trainer</strong><span class="training-area-level">2‚Äì3 dni</span></div></div><p class="training-area-desc">Projektowanie szkole≈Ñ (ROPES), metody aktywne, praca z energiƒÖ grupy, ewaluacja.</p><div class="training-area-tags"><span class="training-area-tag">ROPES</span><span class="training-area-tag">Metody aktywne</span><span class="training-area-tag">Ewaluacja</span><span class="training-area-tag">Kirkpatrick</span></div></div>
  </div>

  <div class="training-methodologies">
    <span class="training-methodologies-label">Metodologie & frameworki:</span>
    <div class="training-methodologies-list">
      <span class="training-methodology-chip">Challenger Sale</span>
      <span class="training-methodology-chip">SPIN Selling</span>
      <span class="training-methodology-chip">NVC</span>
      <span class="training-methodology-chip">Design Thinking</span>
      <span class="training-methodology-chip">GTD</span>
      <span class="training-methodology-chip">ROPES</span>
      <span class="training-methodology-chip">Kirkpatrick</span>
      <span class="training-methodology-chip">Tuckman</span>
      <span class="training-methodology-chip">Kolb</span>
      <span class="training-methodology-chip">DISC</span>
    </div>
  </div>

  <!-- Profil osobowo≈õciowy -->
  <div class="about-section-title">Kim jestem ‚Äî profil osobowo≈õciowy</div>
  <p class="about-intro-text">
    Poni≈ºszy opis powsta≈Ç na podstawie kilku bada≈Ñ psychometrycznych z ostatnich lat.
    To nie sƒÖ wyniki test√≥w ‚Äî to <strong>obraz tego, jak naprawdƒô funkcjonujƒô</strong>,
    co mnie napƒôdza i jak wchodzƒô w relacje. Warto to znaƒá, ≈ºeby dobrze ze mnƒÖ wsp√≥≈Çpracowaƒá.
  </p>

  <div class="about-psych-grid">

    <!-- Co mnie napƒôdza -->
    <div class="about-psych-card about-psych-card--wide">
      <div class="about-psych-header">
        <span class="about-psych-badge rmp-badge">üî• Motywacja</span>
        <span class="about-psych-name">Co mnie napƒôdza do dzia≈Çania</span>
      </div>
      <div class="drives-list">
        <div class="drive-item"><div class="drive-top"><span class="drive-icon">üèÜ</span><span class="drive-label">Uznanie &amp; Status</span><div class="drive-track"><div class="drive-fill" style="width:100%;background:#e91e63"></div></div></div><p class="drive-desc">Potrzebujƒô wiedzieƒá, ≈ºe moja praca ma znaczenie i jest dostrzegana. Status nie jest celem samym w sobie ‚Äî to informacja zwrotna, ≈ºe idƒô we w≈Ça≈õciwym kierunku.</p></div>
        <div class="drive-item"><div class="drive-top"><span class="drive-icon">üí°</span><span class="drive-label">Idealizm &amp; Misja</span><div class="drive-track"><div class="drive-fill" style="width:100%;background:#9c27b0"></div></div></div><p class="drive-desc">Dzia≈Çam z poczuciem sensu. Muszƒô wierzyƒá, ≈ºe to co robiƒô zmienia co≈õ na lepsze ‚Äî u ludzi, w organizacji, w ≈õwiecie.</p></div>
        <div class="drive-item"><div class="drive-top"><span class="drive-icon">‚ö°</span><span class="drive-label">W≈Çadza &amp; Wp≈Çyw</span><div class="drive-track"><div class="drive-fill" style="width:90%;background:#ff9800"></div></div></div><p class="drive-desc">Naturalnie przejmujƒô inicjatywƒô. Nie po to, by kontrolowaƒá ‚Äî po to, by rzeczy siƒô dzia≈Çy. Brak sprawczo≈õci dzia≈Ça na mnie demotywujƒÖco.</p></div>
        <div class="drive-item"><div class="drive-top"><span class="drive-icon">üîç</span><span class="drive-label">Ciekawo≈õƒá &amp; Rozw√≥j</span><div class="drive-track"><div class="drive-fill" style="width:90%;background:#2196f3"></div></div></div><p class="drive-desc">Potrzeba ciƒÖg≈Çego uczenia siƒô to m√≥j motor. Nowe idee, nowe dziedziny, intelektualne dyskusje ‚Äî to mnie ≈Çaduje, nie wyczerpuje.</p></div>
        <div class="drive-item"><div class="drive-top"><span class="drive-icon">üåä</span><span class="drive-label">Napiƒôcie, nie spok√≥j</span><div class="drive-track"><div class="drive-fill" style="width:85%;background:#00bcd4"></div></div></div><p class="drive-desc">Dzia≈Çam najlepiej pod presjƒÖ i w zmiennym ≈õrodowisku. Cisza i rutyna mnie nie relaksujƒÖ ‚Äî to wyzwania i z≈Ço≈ºone zadania dajƒÖ mi energiƒô.</p></div>
      </div>
    </div>

    <!-- Jak funkcjonujƒô z lud≈∫mi -->
    <div class="about-psych-card">
      <div class="about-psych-header">
        <span class="about-psych-badge perso-badge">üë• Relacje</span>
        <span class="about-psych-name">Jak funkcjonujƒô z lud≈∫mi</span>
      </div>
      <div class="people-chips">
        <div class="people-chip"><span class="people-icon">ü§ù</span><div><strong>Zaufanie jako default</strong><p>Wychodzƒô z za≈Ço≈ºenia, ≈ºe ludzie sƒÖ szczerzy i dobrzy w intencjach. Dajƒô kredyt zaufania ‚Äî i oczekujƒô tego samego.</p></div></div>
        <div class="people-chip"><span class="people-icon">‚ù§Ô∏è</span><div><strong>Wra≈ºliwo≈õƒá spo≈Çeczna</strong><p>Ciƒô≈ºko mi przej≈õƒá obojƒôtnie obok kogo≈õ w potrzebie. Anga≈ºujƒô siƒô w sprawy innych ‚Äî to naturalne, nie wykalkulowane.</p></div></div>
        <div class="people-chip"><span class="people-icon">‚öîÔ∏è</span><div><strong>Komfort w konflikcie</strong><p>Nie uciekam od trudnych rozm√≥w. Konfrontacja nie jest dla mnie zagro≈ºeniem ‚Äî to narzƒôdzie do rozwiƒÖzywania problem√≥w.</p></div></div>
        <div class="people-chip"><span class="people-icon">üîÑ</span><div><strong>Mediator &amp; Partner</strong><p>Szukam rozwiƒÖza≈Ñ korzystnych dla obu stron. Praca zar√≥wno samodzielna, jak i zespo≈Çowa przychodzi mi naturalnie.</p></div></div>
      </div>
    </div>

    <!-- Jak my≈õlƒô i dzia≈Çam -->
    <div class="about-psych-card">
      <div class="about-psych-header">
        <span class="about-psych-badge harrison-badge">üß† Styl dzia≈Çania</span>
        <span class="about-psych-name">Jak my≈õlƒô i dzia≈Çam</span>
      </div>
      <p class="about-psych-desc">
        Niekonwencjonalny, otwarty na nowe do≈õwiadczenia ‚Äî w g√≥rnym percentylu populacji.
        Unikam rutyny, chƒôtnie wchodzƒô w intelektualne spory i eksperymentujƒô.
        Wyr√≥≈ºnia mnie du≈ºa wra≈ºliwo≈õƒá emocjonalna po≈ÇƒÖczona z komfortem w trudnych sytuacjach.
      </p>
      <div class="rmp-bars">
        <div class="rmp-row"><span class="rmp-label">üéØ Wytrwa≈Ço≈õƒá w obliczu przeszk√≥d</span><div class="rmp-track"><div class="rmp-fill" style="width:92%;background:#4caf50"></div></div><span class="rmp-val">92%</span></div>
        <div class="rmp-row"><span class="rmp-label">üß© Wszechstronna ciekawo≈õƒá intelektualna</span><div class="rmp-track"><div class="rmp-fill" style="width:98%;background:#4caf50"></div></div><span class="rmp-val">98%</span></div>
        <div class="rmp-row"><span class="rmp-label">üöÄ Inicjatywa i samomotywacja</span><div class="rmp-track"><div class="rmp-fill" style="width:90%;background:#4caf50"></div></div><span class="rmp-val">90%</span></div>
        <div class="rmp-row"><span class="rmp-label">üé® Otwarto≈õƒá ‚Äî nowe idee i do≈õwiadczenia</span><div class="rmp-track"><div class="rmp-fill" style="width:98%;background:#4caf50"></div></div><span class="rmp-val">98%</span></div>
        <div class="rmp-row"><span class="rmp-label">üî¨ Refleksyjno≈õƒá i wieloperspektywowo≈õƒá</span><div class="rmp-track"><div class="rmp-fill" style="width:95%;background:#4caf50"></div></div><span class="rmp-val">95%</span></div>
        <div class="rmp-row"><span class="rmp-label">üõ†Ô∏è Coaching i praca jeden na jeden</span><div class="rmp-track"><div class="rmp-fill" style="width:82%;background:#4caf50"></div></div><span class="rmp-val">82%</span></div>
      </div>
    </div>

    <!-- OPTO by Master ‚Äî 8 wymiar√≥w -->
    <div class="about-psych-card about-psych-card--wide">
      <div class="about-psych-header">
        <span class="about-psych-badge opto-badge">üìä OPTO ¬∑ Master</span>
        <span class="about-psych-name">Profil osobowo≈õci ‚Äî 8 wymiar√≥w (skala 1‚Äì10)</span>
      </div>
      <p class="about-psych-desc">
        Badanie OPTO (Master, 06.10.2025) mierzy 8 kluczowych wymiar√≥w osobowo≈õci z punktu
        widzenia efektywno≈õci w pracy. Dwa dominujƒÖce obszary to <strong>Wp≈Çyw</strong> i
        <strong>Innowacyjno≈õƒá</strong> ‚Äî co przek≈Çada siƒô na styl pracy: inicjatywa,
        perswazja, nieustanne kwestionowanie status quo i orientacja na cel maksymalny (10/10).
      </p>
      <div class="opto-dims-grid">
        <div class="opto-dim-card"><div class="opto-dim-header"><span class="opto-dim-icon">üì£</span><span class="opto-dim-name">Wp≈Çyw</span><div class="opto-dim-bars"><div class="opto-bar-row"><span class="opto-bar-label">Asertywno≈õƒá</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:90%;background:#1565c0"></div></div><span class="opto-bar-val" style="color:#1565c0">9</span></div><div class="opto-bar-row"><span class="opto-bar-label">Komunikacja</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:90%;background:#1565c0"></div></div><span class="opto-bar-val" style="color:#1565c0">9</span></div><div class="opto-bar-row"><span class="opto-bar-label">Pewno≈õƒá siebie</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:80%;background:#1565c0"></div></div><span class="opto-bar-val" style="color:#1565c0">8</span></div></div></div><p class="opto-dim-desc">Bardzo wysoka asertywno≈õƒá (9/10) i komunikatywno≈õƒá (9/10) ‚Äî naturalnie przejmujƒô inicjatywƒô, wiem jak zjednaƒá sobie ludzi i jestem bardzo przekonujƒÖcy. Pewno≈õƒá siebie w sytuacjach spo≈Çecznych (8/10).</p></div>
        <div class="opto-dim-card"><div class="opto-dim-header"><span class="opto-dim-icon">üß±</span><span class="opto-dim-name">Odporno≈õƒá</span><div class="opto-dim-bars"><div class="opto-bar-row"><span class="opto-bar-label">Radzenie sobie ze stresem</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:90%;background:#2e7d32"></div></div><span class="opto-bar-val" style="color:#2e7d32">9</span></div><div class="opto-bar-row"><span class="opto-bar-label">Opanowanie</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:70%;background:#2e7d32"></div></div><span class="opto-bar-val" style="color:#2e7d32">7</span></div></div></div><p class="opto-dim-desc">Najwy≈ºszy wynik w radzeniu sobie ze stresem (9/10) ‚Äî zawsze zachowujƒô spok√≥j pod presjƒÖ, w stresie wykazujƒô siƒô odporno≈õciƒÖ psychicznƒÖ. Opanowanie emocji w pracy (7/10).</p></div>
        <div class="opto-dim-card"><div class="opto-dim-header"><span class="opto-dim-icon">üéØ</span><span class="opto-dim-name">Efektywno≈õƒá</span><div class="opto-dim-bars"><div class="opto-bar-row"><span class="opto-bar-label">Orientacja na cel</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:100%;background:#e65100"></div></div><span class="opto-bar-val" style="color:#e65100">10</span></div><div class="opto-bar-row"><span class="opto-bar-label">Pracowito≈õƒá</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:80%;background:#e65100"></div></div><span class="opto-bar-val" style="color:#e65100">8</span></div><div class="opto-bar-row"><span class="opto-bar-label">Zapa≈Ç</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:50%;background:#e65100"></div></div><span class="opto-bar-val" style="color:#e65100">5</span></div></div></div><p class="opto-dim-desc">Orientacja na cel na poziomie maksymalnym (10/10) ‚Äî zawsze zdeterminowany do osiƒÖgania wyznaczonych cel√≥w, bardzo ambitny. Pracowito≈õƒá i samodyscyplina (8/10).</p></div>
        <div class="opto-dim-card"><div class="opto-dim-header"><span class="opto-dim-icon">üí°</span><span class="opto-dim-name">Innowacyjno≈õƒá</span><div class="opto-dim-bars"><div class="opto-bar-row"><span class="opto-bar-label">Pomys≈Çowo≈õƒá</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:90%;background:#6a1b9a"></div></div><span class="opto-bar-val" style="color:#6a1b9a">9</span></div><div class="opto-bar-row"><span class="opto-bar-label">Podejmowanie ryzyka</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:80%;background:#6a1b9a"></div></div><span class="opto-bar-val" style="color:#6a1b9a">8</span></div><div class="opto-bar-row"><span class="opto-bar-label">Zdolno≈õƒá adaptacji</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:70%;background:#6a1b9a"></div></div><span class="opto-bar-val" style="color:#6a1b9a">7</span></div></div></div><p class="opto-dim-desc">Wysoka pomys≈Çowo≈õƒá (9/10) ‚Äî ca≈Çy czas kwestionujƒô istniejƒÖcy stan rzeczy, mam mn√≥stwo nowych pomys≈Ç√≥w. Gotowo≈õƒá do podejmowania ryzyka i przedsiƒôbiorczo≈õƒá (8/10).</p></div>
        <div class="opto-dim-card"><div class="opto-dim-header"><span class="opto-dim-icon">‚úÖ</span><span class="opto-dim-name">Sumienno≈õƒá</span><div class="opto-dim-bars"><div class="opto-bar-row"><span class="opto-bar-label">ObowiƒÖzkowo≈õƒá</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:80%;background:#37474f"></div></div><span class="opto-bar-val" style="color:#78909c">8</span></div><div class="opto-bar-row"><span class="opto-bar-label">Szczero≈õƒá</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:80%;background:#37474f"></div></div><span class="opto-bar-val" style="color:#78909c">8</span></div><div class="opto-bar-row"><span class="opto-bar-label">Organizacja</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:70%;background:#37474f"></div></div><span class="opto-bar-val" style="color:#78909c">7</span></div><div class="opto-bar-row"><span class="opto-bar-label">Zapewnianie jako≈õci</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:50%;background:#37474f"></div></div><span class="opto-bar-val" style="color:#78909c">5</span></div></div></div><p class="opto-dim-desc">Wysoka obowiƒÖzkowo≈õƒá (8/10) i szczero≈õƒá (8/10) ‚Äî zawsze dotrzymujƒô zobowiƒÖza≈Ñ, mo≈ºna na mnie polegaƒá. Organizacja pracy (7/10).</p></div>
        <div class="opto-dim-card"><div class="opto-dim-header"><span class="opto-dim-icon">ü§ù</span><span class="opto-dim-name">Wsp√≥≈Çpraca</span><div class="opto-dim-bars"><div class="opto-bar-row"><span class="opto-bar-label">Utrzymywanie relacji</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:90%;background:#00838f"></div></div><span class="opto-bar-val" style="color:#00838f">9</span></div><div class="opto-bar-row"><span class="opto-bar-label">Altruizm</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:60%;background:#00838f"></div></div><span class="opto-bar-val" style="color:#00838f">6</span></div><div class="opto-bar-row"><span class="opto-bar-label">Zaufanie</span><div class="opto-bar-track"><div class="opto-bar-fill" style="width:50%;background:#00838f"></div></div><span class="opto-bar-val" style="color:#00838f">5</span></div></div></div><p class="opto-dim-desc">Bardzo wysoka otwarto≈õƒá i towarzysko≈õƒá (9/10) ‚Äî lubiƒô pracowaƒá w zespole, ≈Çatwo nawiƒÖzujƒô rozmowy. Altruizm (6/10). Zaufanie do ludzi (5/10) ‚Äî z natury weryfikujƒô intencje.</p></div>
      </div>
    </div>

  </div>

  <!-- Klienci wed≈Çug sektor√≥w -->
  <div class="about-section-title">Wybrani klienci ‚Äî wed≈Çug bran≈º</div>
  <p class="about-intro-text">
    Ponad 10 lat pracy z organizacjami z r√≥≈ºnych sektor√≥w. Poni≈ºej wybrane firmy i instytucje, z kt√≥rymi wsp√≥≈Çpracowa≈Çem.
  </p>
  <div class="clients-sectors">
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">üè¶</span><span class="clients-sector-name">Bankowo≈õƒá &amp; Finanse</span></div><div class="clients-list"><span class="client-chip">AASA Poland</span><span class="client-chip">Alior Bank</span><span class="client-chip">Bank BPH</span><span class="client-chip">CERI International</span><span class="client-chip">Noble Bank</span></div></div>
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">üõ°Ô∏è</span><span class="clients-sector-name">Ubezpieczenia</span></div><div class="clients-list"><span class="client-chip">Aviva</span><span class="client-chip">Generali</span></div></div>
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">üíª</span><span class="clients-sector-name">IT &amp; Technologie</span></div><div class="clients-list"><span class="client-chip">Atman</span><span class="client-chip">Capgemini</span><span class="client-chip">InPost</span><span class="client-chip">ISCH</span><span class="client-chip">Packhelp</span></div></div>
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">üíº</span><span class="clients-sector-name">Consulting &amp; Doradztwo biznesowe</span></div><div class="clients-list"><span class="client-chip">Deloitte</span><span class="client-chip">McKinsey &amp; Company</span></div></div>
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">üéì</span><span class="clients-sector-name">Szkolenia &amp; Rozw√≥j (L&amp;D)</span></div><div class="clients-list"><span class="client-chip">Certes</span><span class="client-chip">CERI</span><span class="client-chip">House of Skills</span><span class="client-chip">Polska Izba Firm Szkoleniowych</span><span class="client-chip">Teamformacja</span><span class="client-chip">Wszechnica UJ</span></div></div>
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">üõí</span><span class="clients-sector-name">FMCG &amp; Artyku≈Çy konsumenckie</span></div><div class="clients-list"><span class="client-chip">Coty</span><span class="client-chip">Danone</span><span class="client-chip">Intersnack</span><span class="client-chip">JTI</span><span class="client-chip">L'Or√©al</span><span class="client-chip">Philip Morris Polska</span><span class="client-chip">TTI</span></div></div>
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">üõçÔ∏è</span><span class="clients-sector-name">Retail &amp; E-commerce</span></div><div class="clients-list"><span class="client-chip">Allegro</span><span class="client-chip">Empik</span><span class="client-chip">Lidl</span><span class="client-chip">NEINVER (Factory Outlets)</span></div></div>
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">üëî</span><span class="clients-sector-name">Rekrutacja &amp; HR</span></div><div class="clients-list"><span class="client-chip">Adecco</span><span class="client-chip">Antal</span><span class="client-chip">Benefit Systems (MultiSport)</span></div></div>
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">üíä</span><span class="clients-sector-name">Ochrona Zdrowia &amp; Farmacja</span></div><div class="clients-list"><span class="client-chip">Apteki DOZ</span><span class="client-chip">NFZ</span></div></div>
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">üì¶</span><span class="clients-sector-name">Dystrybucja &amp; Logistyka</span></div><div class="clients-list"><span class="client-chip">Agility Logistics</span><span class="client-chip">Lyreco</span><span class="client-chip">Orange</span></div></div>
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">üöó</span><span class="clients-sector-name">Motoryzacja &amp; Wynajem</span></div><div class="clients-list"><span class="client-chip">99Rent</span></div></div>
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">‚ö°</span><span class="clients-sector-name">OZE &amp; Energetyka</span></div><div class="clients-list"><span class="client-chip">4-Eco (fotowoltaika)</span><span class="client-chip">Solenerga</span></div></div>
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">‚öñÔ∏è</span><span class="clients-sector-name">Bran≈ºa prawna &amp; Odszkodowania</span></div><div class="clients-list"><span class="client-chip">Helpea</span></div></div>
    <div class="clients-sector"><div class="clients-sector-header"><span class="clients-sector-icon">üèõÔ∏è</span><span class="clients-sector-name">Administracja publiczna &amp; NGO</span></div><div class="clients-list"><span class="client-chip">Akademia PAN</span><span class="client-chip">Akademia Przysz≈Ço≈õci</span><span class="client-chip">Fundacja im. Les≈Çawa Pagi</span><span class="client-chip">Fundacja ‚ÄûTw√≥j Startup"</span><span class="client-chip">Ministerstwo ≈örodowiska</span><span class="client-chip">Ministerstwo Sprawiedliwo≈õci</span><span class="client-chip">SGGW</span></div></div>
  </div>

  <!-- O aplikacji -->
  <div class="about-app-note">
    <span class="about-app-label">O aplikacji</span>
    <p>
      <strong>FLUX ‚Äî Interaktywna Mapa Kompetencji</strong> to rama kompetencyjno-operacyjna
      do funkcjonowania w ≈õwiecie zmienno≈õci. ≈ÅƒÖczy 4 wymiary: FAST (tempo decyzji),
      LIQUID (wsp√≥≈Çpraca), UNLEARN (oduczanie) i EXPERIMENT (eksperymentowanie)
      w interaktywny diagram z eksploratorem scenariuszy, trend√≥w i narzƒôdzi diagnostycznych.
    </p>
  </div>

  <div class="about-footer">
    Created &amp; designed by <strong>Sebastian Szajner</strong> ¬∑ 2025
  </div>

</div>
</section>

<!-- ========== PROGRESS BAR ========== -->
<div class="flux-progress" id="progress-bar"><div class="flux-progress-fill" id="progress-fill" style="width:0%"></div></div>

<!-- ========== ONBOARDING MODAL ========== -->
<div class="overlay-modal" id="onboarding-overlay">
  <div class="bg-dark-900 border border-dark-700 rounded-2xl p-6 max-w-lg w-full mx-4">
    <div id="onboarding-content"></div>
  </div>
</div>

<!-- ========== REFLECTION MODAL ========== -->
<div class="overlay-modal" id="reflection-overlay" onclick="if(event.target===this)closeReflection()">
  <div class="bg-dark-900 border border-dark-700 rounded-2xl p-6 max-w-lg w-full mx-4">
    <div class="flex justify-between items-center mb-4">
      <h3 class="font-bold text-slate-200">Refleksja 3-2-1</h3>
      <button onclick="closeReflection()" class="text-slate-500 hover:text-white"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button>
    </div>
    <div class="space-y-3">
      <div><label class="text-xs text-amber-400 font-medium">3 rzeczy, kt√≥re zapamiƒôtam</label><textarea id="refl-3" rows="2" class="w-full mt-1 bg-dark-950 border border-dark-700 rounded-lg px-3 py-2 text-sm text-slate-200 outline-none focus:border-amber-500 resize-none"></textarea></div>
      <div><label class="text-xs text-cyan-400 font-medium">2 pytania, kt√≥re mam</label><textarea id="refl-2" rows="2" class="w-full mt-1 bg-dark-950 border border-dark-700 rounded-lg px-3 py-2 text-sm text-slate-200 outline-none focus:border-cyan-500 resize-none"></textarea></div>
      <div><label class="text-xs text-emerald-400 font-medium">1 dzia≈Çanie, kt√≥re podejmƒô</label><textarea id="refl-1" rows="2" class="w-full mt-1 bg-dark-950 border border-dark-700 rounded-lg px-3 py-2 text-sm text-slate-200 outline-none focus:border-emerald-500 resize-none"></textarea></div>
    </div>
    <div class="flex gap-2 mt-4">
      <button onclick="saveReflection()" class="flex-1 bg-emerald-600 hover:bg-emerald-500 text-white text-sm font-medium py-2 rounded-lg">Zapisz</button>
      <button onclick="saveAndAskAI()" class="flex-1 bg-violet-600 hover:bg-violet-500 text-white text-sm font-medium py-2 rounded-lg">Zapisz + Zapytaj AI</button>
    </div>
    <p id="refl-status" class="text-xs mt-2 h-4"></p>
  </div>
</div>

<!-- ========== REFLECTION FAB ========== -->
<div class="refl-fab" id="refl-fab" onclick="openReflection()" title="Refleksja 3-2-1">
  <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/></svg>
</div>

<!-- ========== GEMINI CHAT WIDGET ========== -->
<div class="chat-toggle" onclick="toggleChat()" title="Zapytaj AI o FLUX">
  <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"/></svg>
</div>
<div class="chat-panel" id="chat-panel">
  <div class="p-3 border-b border-dark-700 flex items-center justify-between">
    <div class="flex items-center gap-2">
      <div class="w-6 h-6 rounded-full bg-gradient-to-br from-amber-500 to-violet-500 flex items-center justify-center"><span class="text-[8px] font-black text-white">AI</span></div>
      <span class="text-sm font-semibold text-slate-200">FLUX Asystent</span>
      <span class="text-[9px] text-slate-600">Gemini</span>
    </div>
    <button onclick="toggleChat()" class="text-slate-500 hover:text-white"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button>
  </div>
  <div class="chat-messages" id="chat-messages">
    <div class="chat-msg assistant">Cze≈õƒá! Jestem asystentem FLUX. Zapytaj mnie o model, scenariusze, narzƒôdzia lub jak zastosowaƒá FLUX w Twojej bran≈ºy.</div>
  </div>
  <div id="chat-status" class="px-4 text-[10px] text-violet-400 h-4"></div>
  <div class="chat-input-area">
    <textarea id="chat-input" rows="1" placeholder="Zapytaj o FLUX..." onkeydown="if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();sendChat()}"></textarea>
    <button onclick="sendChat()" id="chat-send">Wy≈õlij</button>
  </div>
</div>

<!-- ========== SETTINGS ========== -->
<div class="settings-overlay" id="settings-overlay" onclick="if(event.target===this)closeSettings()">
  <div class="bg-dark-900 border border-dark-700 rounded-2xl p-6 max-w-md w-full mx-4">
    <div class="flex justify-between items-center mb-4">
      <h3 class="font-bold text-slate-200">Ustawienia Gemini API</h3>
      <button onclick="closeSettings()" class="text-slate-500 hover:text-white"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button>
    </div>
    <p class="text-xs text-slate-400 mb-4">Klucz API Gemini z <a href="https://aistudio.google.com/apikey" target="_blank" class="text-violet-400 hover:underline">aistudio.google.com</a> (darmowy).</p>
    <input type="password" id="api-key-input" placeholder="AIza..." class="w-full bg-dark-950 border border-dark-700 rounded-lg px-3 py-2 text-sm text-slate-200 outline-none focus:border-violet-500 mb-3">
    <div class="flex gap-2">
      <button onclick="saveApiKey()" class="flex-1 bg-violet-600 hover:bg-violet-500 text-white text-sm font-medium py-2 rounded-lg transition-colors">Zapisz</button>
      <button onclick="clearApiKey()" class="px-4 bg-slate-800 hover:bg-slate-700 text-slate-300 text-sm py-2 rounded-lg transition-colors">Wyczy≈õƒá</button>
    </div>
    <p id="settings-status" class="text-xs mt-2 h-4"></p>
  </div>
</div>

<!-- Wheel tooltip (fixed position, appended to body) -->
<div id="flux-tooltip" class="flux-tooltip"></div>

<!-- ========== SEARCH OVERLAY ========== -->
<div class="search-overlay" id="search-overlay" onclick="if(event.target===this)closeSearch()">
  <div class="search-box">
    <div class="flex items-center gap-2 px-4 border-b border-dark-700">
      <svg class="w-5 h-5 text-slate-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
      <input class="search-input" id="search-input" placeholder="Opisz wyzwanie, problem lub szukaj trendu..." oninput="performSearch(this.value)" autocomplete="off">
      <span class="search-kbd">Esc</span>
    </div>
    <div class="px-4 py-2 border-b border-dark-700/50">
      <p class="text-[10px] text-slate-500 mb-1.5">Szybkie wyzwania:</p>
      <div class="flex flex-wrap gap-1.5" id="quick-challenges">
        <span class="challenge-quick" onclick="quickSearch('zesp√≥≈Ç nie komunikuje siƒô')">üí¨ Brak komunikacji</span>
        <span class="challenge-quick" onclick="quickSearch('op√≥r przed zmianƒÖ AI')">ü§ñ Op√≥r przed AI</span>
        <span class="challenge-quick" onclick="quickSearch('wolne decyzje parali≈º')">‚è±Ô∏è Wolne decyzje</span>
        <span class="challenge-quick" onclick="quickSearch('wypalenie stres')">üî• Wypalenie</span>
        <span class="challenge-quick" onclick="quickSearch('innowacje eksperyment')">üß™ Brak innowacji</span>
        <span class="challenge-quick" onclick="quickSearch('zaufanie bezpiecze≈Ñstwo')">ü§ù Brak zaufania</span>
        <span class="challenge-quick" onclick="quickSearch('reskilling kompetencje')">üìö Luka kompetencyjna</span>
        <span class="challenge-quick" onclick="quickSearch('polaryzacja konflikty')">‚ö° Konflikty w zespole</span>
      </div>
    </div>
    <div class="search-results" id="search-results">
      <div class="text-center py-8 text-slate-500 text-sm">Wpisz wyzwanie lub problem ‚Äî poka≈ºemy adekwatne trendy, scenariusze i narzƒôdzia.</div>
    </div>
  </div>
</div>

<!-- ========== SCROLL TO TOP ========== -->
<button class="scroll-top" id="scroll-top" onclick="window.scrollTo({top:0,behavior:'smooth'})">‚Üë</button>

<!-- ========== SCRIPTS ========== -->
<script>
// ===== COLORS & CLASSES =====
const C={fast:'#f59e0b',liquid:'#06b6d4',unlearn:'#10b981',experiment:'#8b5cf6'};
const CC={fast:{t:'text-amber-400',bg:'bg-amber-500/10',b:'border-amber-500/20'},liquid:{t:'text-cyan-400',bg:'bg-cyan-500/10',b:'border-cyan-500/20'},unlearn:{t:'text-emerald-400',bg:'bg-emerald-500/10',b:'border-emerald-500/20'},experiment:{t:'text-violet-400',bg:'bg-violet-500/10',b:'border-violet-500/20'}};

// ===== MODULE SYSTEM =====
const MODULES=[
  {id:'diagnostic',name:'Diagnostyka FLUX',group:'Wiedza',icon:'üìä',desc:'Autodiagnoza 16 pyta≈Ñ + radar chart',nav:true},
  {id:'radar',name:'Radar Chart',group:'Wiedza',icon:'üéØ',desc:'Spider chart profilu FLUX'},
  {id:'actionplan',name:'Action Plan Builder',group:'Wiedza',icon:'üìã',desc:'Dzia≈Çania z deadlinami i metrykami',nav:true},
  {id:'trainer',name:'Trainer Dashboard',group:'Wiedza',icon:'üéì',desc:'QR, gap analysis, eksport raportu',nav:true},
  {id:'casestudies',name:'Deep Case Studies',group:'≈öcie≈ºka',icon:'üìñ',desc:'Rozbudowane analizy SCAR'},
  {id:'evidence',name:'Evidence Cards',group:'≈öcie≈ºka',icon:'üî¨',desc:'Tier bada≈Ñ przy scenariuszach'},
  {id:'antipatterns',name:'Antywzorce Detector',group:'≈öcie≈ºka',icon:'üö®',desc:'Interaktywna diagnoza antywzorc√≥w'},
  {id:'frameworks',name:'Personal Frameworks',group:'≈öcie≈ºka',icon:'üß©',desc:'NVC, STOP‚ÜíTHINK‚ÜíACT, Atomic Habits'},
  {id:'exercises',name:'Interactive Exercises',group:'≈öcie≈ºka',icon:'üèãÔ∏è',desc:'Quiz, speed round, ranking'},
  {id:'canvases',name:'Downloadable Canvases',group:'≈öcie≈ºka',icon:'üì•',desc:'Pobierz canvasy do druku'},
  {id:'ropes',name:'ROPES Learning Path',group:'UX',icon:'üß≠',desc:'5-krokowy wizard nauki'},
  {id:'onboarding',name:'Onboarding Wizard',group:'UX',icon:'üëã',desc:'Profil roli, bran≈ºy, wyzwania'},
  {id:'reflection',name:'Refleksja 3-2-1',group:'UX',icon:'üí≠',desc:'3 rzeczy / 2 pytania / 1 dzia≈Çanie'},
  {id:'progress',name:'Progress Tracker',group:'UX',icon:'üìà',desc:'≈öledzenie postƒôp√≥w, bookmarki'},
  {id:'mobileux',name:'Mobile UX',group:'UX',icon:'üì±',desc:'Bottom nav, sticky filters'}
];

function getModuleState(){try{return JSON.parse(localStorage.getItem('flux_modules')||'{}')}catch(e){return{}}}
function setModuleState(s){localStorage.setItem('flux_modules',JSON.stringify(s))}
function isModuleOn(id){return getModuleState()[id]===true}
function toggleModule(id){const s=getModuleState();s[id]=!s[id];setModuleState(s);applyModules()}

function applyModules(){
  renderNav();
  // Progress bar
  document.getElementById('progress-bar').style.display=isModuleOn('progress')?'block':'none';
  if(isModuleOn('progress'))updateProgressBar();
  // Reflection FAB
  document.getElementById('refl-fab').style.display=isModuleOn('reflection')?'flex':'none';
  // Onboarding check
  if(isModuleOn('onboarding')&&!localStorage.getItem('flux_profile'))showOnboarding();
  // Re-render current view if module-dependent
  renderModulesView();
}

function renderNav(){
  const base=[
    {id:'home',label:'Model'},{id:'explore',label:'Eksplorator'},{id:'trends',label:'Trendy'},
    {id:'research',label:'Badania'},{id:'tools',label:'Narzƒôdzia'}
  ];
  const modNav=MODULES.filter(m=>m.nav&&isModuleOn(m.id)).map(m=>({id:m.id,label:m.name.split(' ')[0]}));
  const all=[...base,...modNav,{id:'modules',label:'Modu≈Çy'}];
  // Desktop
  const dNav=document.querySelector('.hidden.md\\:flex');
  if(dNav){
    const btns=dNav.querySelectorAll('button');
    const btnHtml=Array.from(btns).map(b=>b.outerHTML).join('');
    dNav.innerHTML=all.map(n=>`<a onclick="nav('${n.id}')" class="nav-link text-xs font-medium text-slate-400 hover:text-white cursor-pointer" data-v="${n.id}">${n.label}</a>`).join('')+btnHtml;
  }
  // Mobile
  const mMenu=document.querySelector('.mobile-menu .py-3');
  if(mMenu)mMenu.innerHTML=all.map(n=>`<a onclick="nav('${n.id}');toggleMobile()" class="block py-2 text-sm text-slate-400 hover:text-white cursor-pointer">${n.label}</a>`).join('')+`<a onclick="openSettings();toggleMobile()" class="block py-2 text-sm text-slate-400 hover:text-white cursor-pointer">Ustawienia Gemini</a>`;
}

function renderModulesView(){
  const el=document.getElementById('modules-content');if(!el)return;
  const state=getModuleState();
  const groups=['Wiedza','≈öcie≈ºka','UX'];
  el.innerHTML=groups.map(g=>{
    const mods=MODULES.filter(m=>m.group===g);
    return`<div class="mod-group"><h3 class="text-sm font-bold text-slate-300 mb-3">${g}</h3>${mods.map(m=>`<div class="mod-row"><div class="flex items-center gap-3"><span class="text-lg">${m.icon}</span><div><p class="text-sm font-medium text-slate-200">${m.name}</p><p class="text-xs text-slate-500">${m.desc}</p></div></div><div class="tgl ${state[m.id]?'on':''}" onclick="toggleModule('${m.id}');renderModulesView()"></div></div>`).join('')}</div>`;
  }).join('')+`<div class="text-center mt-4"><button onclick="enableAllModules()" class="text-xs text-amber-400 hover:underline mr-4">W≈ÇƒÖcz wszystkie</button><button onclick="disableAllModules()" class="text-xs text-slate-500 hover:underline">Wy≈ÇƒÖcz wszystkie</button></div>`;
}

function enableAllModules(){const s={};MODULES.forEach(m=>s[m.id]=true);setModuleState(s);applyModules()}
function disableAllModules(){setModuleState({});applyModules()}

// Projector mode
function toggleProjector(){
  document.documentElement.classList.toggle('projector');
  const on=document.documentElement.classList.contains('projector');
  localStorage.setItem('flux_projector',on?'1':'0');
  document.querySelector('.projector-btn')?.classList.toggle('on',on);
}

// ===== FLUX CORE DATA =====
const FLUX={
  fast:{letter:'F',name:'FAST',full:'Tempo decyzji i dzia≈Çania',color:'#f59e0b',
    def:'Szybkie reagowanie i podejmowanie decyzji w warunkach niepewno≈õci. Eliminacja zbƒôdnych op√≥≈∫nie≈Ñ.',
    q:'Jak szybko Tw√≥j zesp√≥≈Ç przechodzi od sygna≈Çu do dzia≈Çania?',
    anti:['Parali≈º analityczny ‚Äî ‚Äûpotrzebujemy jeszcze jednej analizy"','Nadmierne komitety ‚Äî decyzja przechodzi przez 5 poziom√≥w','Czekanie na pe≈Çne dane','Reaktywno≈õƒá bez refleksji'],
    levels:[{l:'PoczƒÖtkujƒÖcy',d:'Rozpoznaje potrzebƒô szybszych decyzji'},{l:'Praktyk',d:'Checklisty decyzyjne, skr√≥cone cykle'},{l:'Zaawansowany',d:'Autonomiczne zespo≈Çy, sensing + responding'}]},
  liquid:{letter:'L',name:'LIQUID',full:'Wsp√≥≈Çpraca i przep≈Çyw',color:'#06b6d4',
    def:'P≈Çynno≈õƒá struktur, r√≥l i przep≈Çywu wiedzy. Bezpiecze≈Ñstwo psychologiczne jako fundament.',
    q:'Czy ludzie czujƒÖ siƒô bezpiecznie, m√≥wiƒÖc co my≈õlƒÖ?',
    anti:['Silosy ‚Äî ‚Äûto nie moja odpowiedzialno≈õƒá"','Brak feedbacku ‚Äî b≈Çƒôdy siƒô powtarzajƒÖ','Hierarchia blokujƒÖca','Spotkania bez warto≈õci'],
    levels:[{l:'PoczƒÖtkujƒÖcy',d:'Rozumie PS, ale nie mierzy'},{l:'Praktyk',d:'Retrospektywy, feedback loops'},{l:'Zaawansowany',d:'Kultura otwarto≈õci, self-organizing'}]},
  unlearn:{letter:'U',name:'UNLEARN & RELEARN',full:'Uczenie siƒô i aktualizacja',color:'#10b981',
    def:'≈öwiadome porzucanie przestarza≈Çych modeli mentalnych. W erze AI ‚Äî ciƒÖg≈Ça aktualizacja.',
    q:'Kiedy ostatnio zesp√≥≈Ç ≈õwiadomie porzuci≈Ç stary spos√≥b dzia≈Çania?',
    anti:['‚ÄûZawsze tak robili≈õmy"','Op√≥r przed AI','Ignorowanie danych','Szkolenie = event jednorazowy'],
    levels:[{l:'PoczƒÖtkujƒÖcy',d:'Dostrzega potrzebƒô aktualizacji'},{l:'Praktyk',d:'PrzeglƒÖdy kompetencji, AI eksperymenty'},{l:'Zaawansowany',d:'Organizacja uczƒÖca siƒô'}]},
  experiment:{letter:'X',name:'EXPERIMENT',full:'Eksperymentowanie i innowacje',color:'#8b5cf6',
    def:'Systematyczne testowanie hipotez. Eksperyment to ≈∫r√≥d≈Ço danych, nie pora≈ºka.',
    q:'Ile eksperyment√≥w przeprowadzi≈Ç Tw√≥j zesp√≥≈Ç w ostatnim kwartale?',
    anti:['Perfekcjonizm ‚Äî ‚Äûmusi byƒá idealne"','Zero-defect culture','Brak bud≈ºetu na testy','Kopiowanie zamiast testowania'],
    levels:[{l:'PoczƒÖtkujƒÖcy',d:'Pojedyncze pr√≥by bez struktury'},{l:'Praktyk',d:'A/B testy, pilota≈ºe, logowanie'},{l:'Zaawansowany',d:'Kultura eksperyment√≥w'}]}
};

// ===== FILTER DIMENSIONS =====
const INDUSTRIES=[
  {id:'automotive',name:'Automotive',icon:'üöó'},{id:'ecommerce',name:'E-commerce',icon:'üõí'},
  {id:'pharma',name:'Farmacja',icon:'üíä'},{id:'insurance',name:'Ubezpieczenia',icon:'üõ°Ô∏è'},
  {id:'oze',name:'OZE / Energia',icon:'‚ö°'},{id:'fmcg',name:'FMCG',icon:'üì¶'},
  {id:'startup',name:'Start-up',icon:'üöÄ'},{id:'it',name:'IT / Software',icon:'üíª'},
  {id:'banking',name:'Bankowo≈õƒá',icon:'üè¶'},{id:'retail',name:'Handel / Retail',icon:'üè¨'}
];
const ROLES=[
  {id:'manager',name:'Kierownik / Manager'},{id:'teamlead',name:'Team Lead'},
  {id:'specialist',name:'Specjalista'},{id:'agent',name:'Agent / Doradca'},
  {id:'sales',name:'Handlowiec / KAM'},{id:'founder',name:'Founder / C-level'},
  {id:'hr',name:'HR / People'},{id:'trainer',name:'Trener / Coach'}
];
const SITUATIONS=[
  {id:'online',name:'Online / Remote',icon:'üíª'},{id:'offline',name:'Offline / Sala',icon:'üè¢'},
  {id:'one2one',name:'1:1',icon:'üë§'},{id:'group',name:'Grupowe',icon:'üë•'},
  {id:'crisis',name:'Kryzysowe',icon:'üî•'},{id:'hybrid',name:'Hybrydowe',icon:'üîÄ'}
];
const LIFE_CONTEXTS=[
  {id:'professional',name:'Zawodowy',icon:'üíº'},{id:'leader',name:'Lider zespo≈Çu',icon:'üëë'},
  {id:'husband',name:'MƒÖ≈º / Partner',icon:'üíë'},{id:'father',name:'Ojciec / Rodzic',icon:'üë®‚Äçüë¶'},
  {id:'health',name:'Zdrowie / Nawyki',icon:'üßò'},{id:'hobby',name:'Hobby / Pasja',icon:'üèéÔ∏è'},
  {id:'finance',name:'Finanse',icon:'üí∞'},{id:'learner',name:'UczƒÖcy siƒô',icon:'üìö'}
];
const CHALLENGE_TYPES=[
  {id:'decision',name:'Decyzyjne',flux:'fast'},{id:'communication',name:'Komunikacyjne',flux:'liquid'},
  {id:'adaptation',name:'Adaptacyjne',flux:'unlearn'},{id:'innovation',name:'Innowacyjne',flux:'experiment'},
  {id:'trust',name:'Relacyjne / Zaufanie',flux:'liquid'},{id:'learning',name:'Uczeniowe',flux:'unlearn'},
  {id:'speed',name:'Tempo / Presja czasu',flux:'fast'},{id:'error',name:'Kultura b≈Çƒôdu',flux:'experiment'}
];

// ===== SCENARIOS (multi-tagged) =====
const SCENARIOS=[
  // FAST - professional
  {title:'Decyzja cenowa pod presjƒÖ',desc:'Kierownik sprzeda≈ºy musi odpowiedzieƒá na ofertƒô konkurencji w 24h ‚Äî bez czekania na centralƒô.',area:['fast'],industry:['automotive','fmcg'],role:['manager','sales'],situation:['offline','crisis'],context:['professional','leader'],challenge:['decision','speed'],tip:'U≈ºyj checklisty "Decyzja w 15 min": co wiem ‚Üí czego nie wiem ‚Üí konsekwencje bezczynno≈õci.',fluxWhy:'FAST: 24h okno decyzyjne wymaga eliminacji zbƒôdnych eskalacji ‚Äî checklista zamiast komitetu.'},
  {title:'Priorytety backlogu w sprincie',desc:'Team lead reaguje na dane z test√≥w A/B i przesuwa priorytety w ≈õrodku sprintu.',area:['fast'],industry:['ecommerce','it','startup'],role:['teamlead','specialist'],situation:['online','group'],context:['professional'],challenge:['decision','speed'],tip:'Decision Log po ka≈ºdej zmianie priorytet√≥w ‚Äî 2 min na rationale.',fluxWhy:'FAST: Dane real-time wymagajƒÖ natychmiastowej zmiany priorytet√≥w ‚Äî op√≥≈∫nienie = strata.'},
  {title:'Zmiana regulacji w 48h',desc:'Regionalny musi zmieniƒá przekaz po decyzji regulatora ‚Äî w 48h, bez centralnego briefu.',area:['fast','unlearn'],industry:['pharma'],role:['manager','sales'],situation:['offline'],context:['professional'],challenge:['decision','adaptation'],tip:'Signal Scanning Ritual: co ta zmiana oznacza dla naszych klient√≥w? Nowy skrypt w 24h.',fluxWhy:'FAST: 48h na zmianƒô przekazu ‚Äî nie ma czasu na centralny brief. UNLEARN: stary skrypt nie dzia≈Ça po zmianie regulacji.'},
  {title:'Decyzja inwestycyjna w niepewno≈õci',desc:'Head of Dev decyduje o projekcie, gdy przepisy mogƒÖ siƒô zmieniƒá w kwarta≈Ç.',area:['fast'],industry:['oze'],role:['manager','founder'],situation:['offline','group'],context:['professional','leader'],challenge:['decision'],tip:'Scenariusze: co je≈õli TAK, co je≈õli NIE? Decision Tempo Tracker dla ca≈Çego pipeline.',fluxWhy:'FAST: Niepewno≈õƒá regulacyjna wymaga szybkich scenariuszy zamiast czekania na pewno≈õƒá.'},
  {title:'Odpowied≈∫ na ofertƒô w rozmowie',desc:'Agent ubezpieczeniowy musi podjƒÖƒá decyzjƒô o ofercie na spotkaniu z klientem ‚Äî teraz, bez "wr√≥cƒô z odpowiedziƒÖ".',area:['fast'],industry:['insurance','banking'],role:['agent','sales'],situation:['offline','one2one'],context:['professional'],challenge:['decision','speed'],tip:'Przygotuj "decision tree" dla najczƒôstszych scenariuszy przed spotkaniem.',fluxWhy:'FAST: Decyzja musi zapa≈õƒá TU I TERAZ ‚Äî ‚Äûwr√≥cƒô z odpowiedziƒÖ" = utrata klienta.'},
  // FAST - personal
  {title:'Pilna decyzja finansowa',desc:'Okazja inwestycyjna z 48h oknem ‚Äî jak szybko podjƒÖƒá decyzjƒô, nie rezygnujƒÖc z analizy?',area:['fast'],industry:[],role:[],situation:['one2one'],context:['finance'],challenge:['decision','speed'],tip:'52 Notatki: masz swojƒÖ strategiƒô ‚Äî sprawd≈∫ czy mie≈õci siƒô w niej ta okazja. TAK/NIE w 30 min.',fluxWhy:'FAST: 48h okno inwestycyjne wymaga szybkiej decyzji w ramach gotowej strategii.'},
  {title:'Kryzys zdrowotny na szkoleniu',desc:'B√≥l plec√≥w/migrena przed prowadzeniem 8h warsztatu. Szybka decyzja: jechaƒá, zmieniƒá format, odwo≈Çaƒá?',area:['fast'],industry:[],role:['trainer'],situation:['crisis'],context:['health','professional'],challenge:['decision','speed'],tip:'STOP ‚Üí 3 opcje ‚Üí wybierz tƒô z najmniejszym kosztem d≈Çugoterminowym.',fluxWhy:'FAST: Kryzys wymaga natychmiastowej decyzji z 3 wariant√≥w ‚Äî nie ma czasu na analizƒô.'},
  // LIQUID - professional
  {title:'Przekaz lead√≥w bez strat',desc:'Lead z digital trafia do salonu ‚Äî kto przejmuje, jak szybko, z jakim kontekstem?',area:['liquid'],industry:['automotive'],role:['manager','teamlead','sales'],situation:['hybrid'],context:['professional'],challenge:['communication','trust'],tip:'Collaboration Flow Map: kto ‚Üí komu ‚Üí co ‚Üí jak szybko. Zidentyfikuj bottlenecki.',fluxWhy:'LIQUID: Przep≈Çyw informacji miƒôdzy kana≈Çami (digital‚Üísalon) wymaga p≈Çynnej struktury i jasnych r√≥l.'},
  {title:'Sp√≥jno≈õƒá komunikacji w terenie',desc:'30 przedstawicieli w 5 regionach m√≥wi r√≥≈ºne rzeczy o tym samym produkcie.',area:['liquid'],industry:['pharma','fmcg'],role:['manager','sales'],situation:['offline','group'],context:['professional','leader'],challenge:['communication'],tip:'Cross-Team Sync: wsp√≥lny brief + cotygodniowy flash update z centrali.',fluxWhy:'LIQUID: 30 os√≥b √ó 5 region√≥w = chaos bez wsp√≥lnego przep≈Çywu wiedzy i synchronizacji.'},
  {title:'Bezpiecze≈Ñstwo psychologiczne w IT',desc:'Junior developer boi siƒô zg≈Çosiƒá bug w kodzie seniora.',area:['liquid'],industry:['it','startup'],role:['teamlead','specialist'],situation:['online','group'],context:['professional','leader'],challenge:['trust'],tip:'PS Radar co kwarta≈Ç + retrospektywa: "co utrudnia nam m√≥wienie prawdy?"',fluxWhy:'LIQUID: Brak PS blokuje przep≈Çyw informacji o b≈Çƒôdach ‚Äî kluczowy element jako≈õci kodu.'},
  {title:'Feedback miƒôdzy agentami',desc:'Do≈õwiadczony agent nie dzieli siƒô technikami z nowymi ‚Äî ‚Äûniech siƒô sami nauczƒÖ".',area:['liquid'],industry:['insurance','banking'],role:['agent','trainer'],situation:['offline','group'],context:['professional'],challenge:['trust','communication'],tip:'Liquid Collaboration Canvas: zmapuj przep≈Çywy wiedzy. Kto jest bottleneckiem?',fluxWhy:'LIQUID: Blokada przep≈Çywu wiedzy miƒôdzy do≈õwiadczonymi a nowymi ‚Äî bottleneck kompetencji.'},
  // LIQUID - personal
  {title:'Trudna rozmowa z partnerem',desc:'Ola czuje siƒô zaniedbana po tygodniu intensywnych szkole≈Ñ. Jak rozmawiaƒá, nie eskalujƒÖc?',area:['liquid'],industry:[],role:[],situation:['one2one','offline'],context:['husband'],challenge:['communication','trust'],tip:'NVC: obserwacja ‚Üí uczucia ‚Üí potrzeby ‚Üí pro≈õba. M√≥w "czujƒô X, potrzebujƒô Y" nie "Ty zawsze..."',fluxWhy:'LIQUID: Emocje i potrzeby wymagajƒÖ p≈Çynnego, niehierarchicznego przep≈Çywu komunikacji.'},
  {title:'Budowanie zaufania z synem',desc:'Syn (przedszkolak/szkolak) nie chce opowiadaƒá co by≈Ço w szkole.',area:['liquid'],industry:[],role:[],situation:['one2one','offline'],context:['father'],challenge:['trust','communication'],tip:'15 min "just us" bez ekran√≥w, bez pyta≈Ñ. Obecno≈õƒá > przes≈Çuchanie. M√≥w o swoim dniu pierwszy.',fluxWhy:'LIQUID: Zaufanie = fundament przep≈Çywu komunikacji. Bez bezpiecze≈Ñstwa psychologicznego syn milczy.'},
  {title:'Feedback w zespole NM',desc:'Chcesz daƒá feedback liderowi z NM, kt√≥ry stosuje metody, z kt√≥rymi siƒô nie zgadzasz.',area:['liquid'],industry:[],role:['trainer'],situation:['one2one','offline'],context:['professional','leader'],challenge:['communication','trust'],tip:'SBI: Sytuacja ‚Üí Zachowanie ‚Üí Wp≈Çyw. Konkretnie, bez osƒÖdzania.',fluxWhy:'LIQUID: Feedback miƒôdzy liderami wymaga bezpiecznej struktury komunikacji peer-to-peer.'},
  // UNLEARN - professional
  {title:'Wdro≈ºenie AI w zespole sprzeda≈ºy',desc:'Handlowcy bojƒÖ siƒô AI ‚Äî ‚ÄûzastƒÖpi nas". Jak zmieniƒá mindset?',area:['unlearn'],industry:['fmcg','automotive','insurance'],role:['manager','sales','hr'],situation:['group','offline'],context:['professional','leader'],challenge:['adaptation','learning'],tip:'AI Prompt Pack: poka≈º konkretne use cases (podsumowanie CRM, mail follow-up). Efekt WOW > teoria.',fluxWhy:'UNLEARN: Lƒôk przed AI (AI-fobia) wymaga porzucenia mitu ‚ÄûAI zastƒÖpi ludzi" na rzecz ‚ÄûAI wspiera ludzi".'},
  {title:'Zmiana ≈õcie≈ºki klienta na digital-first',desc:'Klienci kupujƒÖ online, ale zesp√≥≈Ç wciƒÖ≈º optymalizuje proces offline.',area:['unlearn'],industry:['automotive','retail','ecommerce'],role:['manager','teamlead'],situation:['group','hybrid'],context:['professional'],challenge:['adaptation'],tip:'Learning Cycle Canvas: co siƒô sprawdza vs co nie ‚Äî dane, nie opinie. Skill Gap Analyzer na dzisiaj.',fluxWhy:'UNLEARN: Zesp√≥≈Ç musi porzuciƒá model offline-first i nauczyƒá siƒô digital-first ‚Äî dane > przyzwyczajenia.'},
  {title:'Nowy produkt, stare skrypty',desc:'Nowa terapia wymaga przebudowy pitchu. Stare argumenty nie dzia≈ÇajƒÖ.',area:['unlearn'],industry:['pharma','insurance'],role:['sales','trainer'],situation:['offline','group'],context:['professional'],challenge:['adaptation','learning'],tip:'Adaptive Learning Loop: Dzia≈Çaj ‚Üí Obserwuj ‚Üí Reflektuj ‚Üí Adaptuj. 3 tygodnie na nowy skrypt.',fluxWhy:'UNLEARN: Stary skrypt to mentalny model ‚Äî trzeba go ≈õwiadomie odrzuciƒá, by nowy mia≈Ç szansƒô.'},
  // UNLEARN - personal
  {title:'Stare nawyki ≈ºywieniowe',desc:'Wiesz co jest zdrowe, ale wciƒÖ≈º jesz to co zawsze. Jak zmieniƒá?',area:['unlearn'],industry:[],role:[],situation:['one2one'],context:['health'],challenge:['adaptation','learning'],tip:'Atomic Habits: 1 zmiana na 3 tygodnie. Stack na istniejƒÖcym nawyku: "po kawie ‚Üí szklanka wody".',fluxWhy:'UNLEARN: Nawyki ≈ºywieniowe to g≈Çƒôboko zakorzenione wzorce ‚Äî bez oduczenia nowe nie wejdƒÖ.'},
  {title:'Porzucenie przestarza≈Çej rutyny ojcowskiej',desc:'‚ÄûJak by≈Çem ma≈Çy to nikt ze mnƒÖ nie rozmawia≈Ç i wyros≈Çem". Ale Tw√≥j syn potrzebuje inaczej.',area:['unlearn'],industry:[],role:[],situation:['one2one','offline'],context:['father'],challenge:['adaptation'],tip:'STOP ‚Üí THINK ‚Üí ACT. Co syn potrzebuje TERAZ? Modelowanie > instrukcja.',fluxWhy:'UNLEARN: Model ojcostwa odziedziczony po rodzicach mo≈ºe nie pasowaƒá do potrzeb Twojego dziecka.'},
  {title:'Zmiana podej≈õcia do finans√≥w',desc:'‚ÄûKiedy≈õ zacznƒô oszczƒôdzaƒá" ‚Äî ale kiedy? Zmiana mentalnego modelu pieniƒôdzy.',area:['unlearn'],industry:[],role:[],situation:['one2one'],context:['finance'],challenge:['adaptation','learning'],tip:'52 Notatki: systematyczno≈õƒá > kwota. Zacznij od 100 z≈Ç/msc, automatyczny przelew.',fluxWhy:'UNLEARN: ‚ÄûKiedy≈õ zacznƒô" to model mentalny do porzucenia ‚Äî systematyczno≈õƒá > jednorazowy zryw.'},
  // EXPERIMENT - professional
  {title:'Test nowego formatu szkolenia',desc:'Chcesz sprawdziƒá czy 4√ó2h online > 1√ó8h offline. Jak zmierzyƒá?',area:['experiment'],industry:[],role:['trainer','hr'],situation:['online','group'],context:['professional'],challenge:['innovation','error'],tip:'Hypothesis Builder: "Je≈õli 4√ó2h to NPS bƒôdzie >8 poniewa≈º mniej zmƒôczenia". Mierz, nie zgaduj.',fluxWhy:'EXPERIMENT: Format szkolenia to hipoteza ‚Äî testuj z metrykami zamiast zak≈Çadaƒá co dzia≈Ça.'},
  {title:'A/B test komunikatu sprzeda≈ºowego',desc:'Dwa warianty pitch\'a ‚Äî kt√≥ry konwertuje lepiej? Jak testowaƒá w terenie?',area:['experiment'],industry:['fmcg','automotive','insurance'],role:['sales','manager'],situation:['offline'],context:['professional'],challenge:['innovation'],tip:'Experiment Design Kit: grupa A vs B, 2 tygodnie, ta sama baza klient√≥w. Log wynik√≥w.',fluxWhy:'EXPERIMENT: Dwa pitche = dwie hipotezy. Kontrolowany test w terenie daje twarde dane.'},
  {title:'Pilota≈º nowego procesu',desc:'Nowy workflow w jednym zespole przed skalowaniem na organizacjƒô.',area:['experiment'],industry:['it','startup','banking'],role:['teamlead','manager','founder'],situation:['group','hybrid'],context:['professional','leader'],challenge:['innovation','error'],tip:'Safe-to-fail probe: 1 zesp√≥≈Ç, 4 tygodnie, jasne metryki. Pre-mortem: co mo≈ºe p√≥j≈õƒá nie tak?',fluxWhy:'EXPERIMENT: Pilota≈º = safe-to-fail probe. 1 zesp√≥≈Ç testuje, ca≈Ça organizacja uczy siƒô z wyniku.'},
  {title:'MVP produktu w start-upie',desc:'Founder decyduje o pivocie na podstawie danych z 2 tygodni, nie 2 kwarta≈Ç√≥w.',area:['experiment','fast'],industry:['startup'],role:['founder','teamlead'],situation:['hybrid','crisis'],context:['professional'],challenge:['innovation','decision','speed'],tip:'Experiment Outcome Log: hipoteza ‚Üí test ‚Üí wynik ‚Üí wniosek ‚Üí nastƒôpny krok. Nie pivot bez danych.',fluxWhy:'EXPERIMENT: MVP to eksperyment z ograniczonym ryzykiem. FAST: 2 tygodnie danych > 2 kwarta≈Çy opinii.'},
  // EXPERIMENT - personal
  {title:'Test nowego hobby',desc:'RC Cars czy fotografia? Nie musisz wybieraƒá od razu ‚Äî testuj.',area:['experiment'],industry:[],role:[],situation:['offline'],context:['hobby'],challenge:['innovation'],tip:'2 tygodnie: 1 hobby. Notuj flow state (skala 1-10). Po miesiƒÖcu por√≥wnaj.',fluxWhy:'EXPERIMENT: Nie wybieraj ‚Äî testuj. 2 tygodnie na hobby z pomiarem flow state to kontrolowany test.'},
  {title:'Eksperyment z rutynƒÖ porannƒÖ',desc:'Wstaƒá o 5:30 i ƒáwiczyƒá? Albo medytacja? Test 21 dni.',area:['experiment'],industry:[],role:[],situation:['one2one'],context:['health'],challenge:['innovation'],tip:'Hypothesis Builder: "Je≈õli wstanƒô o 5:30 to energia do 14:00 wzro≈õnie". Mierz przez 3 tygodnie.',fluxWhy:'EXPERIMENT: Rutyna poranna to hipoteza do sprawdzenia ‚Äî 21 dni pomiaru energii da odpowied≈∫.'},
  {title:'Nowy format randki z OlƒÖ',desc:'Zamiast kina ‚Äî escape room, gotowanie razem, wsp√≥lny projekt? Testuj co daje wiƒôcej.',area:['experiment'],industry:[],role:[],situation:['one2one','offline'],context:['husband'],challenge:['innovation'],tip:'1 nowe do≈õwiadczenie/miesiƒÖc. Refleksja: co da≈Ço wiƒôcej blisko≈õci? Konto emocjonalne: + czy -?',fluxWhy:'EXPERIMENT: Relacja to ≈ºywy organizm ‚Äî nowe formy randek testujƒÖ co generuje wiƒôcej blisko≈õci.'},
];

// ===== RESEARCH =====
const RESEARCH=[
  {area:'fast',authors:'Eisenhardt, K.M.',year:1989,title:'Making Fast Strategic Decisions in High-Velocity Environments',finding:'Szybkie zespo≈Çy decyzyjne u≈ºywajƒÖ wiƒôcej informacji i tworzƒÖ wiƒôcej alternatyw ni≈º wolne.',type:'Badanie empiryczne',src:'https://www.jstor.org/stable/256434'},
  {area:'fast',authors:'Werder, K. et al.',year:2022,title:'IT capability ‚Üí organizational agility (meta-analysis)',finding:'Zdolno≈õci IT wspierajƒÖ zwinno≈õƒá w wymiarze sensing i responding.',type:'Meta-analiza',src:'https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0268761'},
  {area:'fast',authors:'Czur≈Çowska, M.',year:2024,title:'Agile w praktyce ‚Äî wp≈Çyw na komunikacjƒô i adaptacjƒô',finding:'Wdro≈ºenie Agile poprawia wsp√≥≈Çpracƒô i tempo adaptacji.',type:'Badanie',src:null},
  {area:'liquid',authors:'Frazier, M.L. et al.',year:2017,title:'Psychological Safety: A Meta-Analytic Review',finding:'PS wiƒÖ≈ºe siƒô z lepszƒÖ efektywno≈õciƒÖ, dzieleniem wiedzy i zachowaniami obywatelskimi.',type:'Meta-analiza',src:'https://onlinelibrary.wiley.com/doi/abs/10.1111/peps.12183'},
  {area:'liquid',authors:'Edmondson, A.C.',year:1999,title:'Psychological safety and learning behavior in work teams',finding:'Klimat ryzyka interpersonalnego u≈Çatwia uczenie siƒô zespo≈Çowe.',type:'Badanie empiryczne',src:'https://journals.sagepub.com/doi/10.2307/2666999'},
  {area:'liquid',authors:'Jin, X.',year:2024,title:'Psychological Safety i innowacyjno≈õƒá pracownik√≥w',finding:'Komunikacja jest mechanizmem ≈ÇƒÖczƒÖcym PS z efektywno≈õciƒÖ innowacyjnƒÖ.',type:'Badanie',src:null},
  {area:'liquid',authors:'Santana, R. et al.',year:2025,title:'Psychological safety w ≈õrodowisku IT',finding:'PS = warunek wsp√≥≈Çpracy, uczenia siƒô i dostosowania do zmian w zespo≈Çach cross-funkcyjnych.',type:'PrzeglƒÖd systematyczny',src:null},
  {area:'liquid',authors:'Dickel, D. et al.',year:2026,title:'PS, wsp√≥≈Çpraca i dynamic capabilities',finding:'PS ‚Üí wsp√≥≈Çpraca ‚Üí dynamic capabilities. R√≥≈ºnice kulturowe (Brazylia vs Niemcy).',type:'Badanie por√≥wnawcze',src:null},
  {area:'unlearn',authors:'Brynjolfsson, E. et al.',year:2023,title:'Generative AI at Work (NBER)',finding:'AI w obs≈Çudze klienta: +14% produktywno≈õƒá, najwiƒôkszy zysk dla najmniej do≈õwiadczonych.',type:'Badanie NBER',src:'https://www.nber.org/papers/w31161'},
  {area:'unlearn',authors:'Sisk, V.F. et al.',year:2018,title:'Growth mindset meta-analysis',finding:'ZwiƒÖzek growth mindset z wynikami istotny ale niewielki. Kontekst > interwencja.',type:'Meta-analiza',src:'https://journals.sagepub.com/doi/10.1177/0956797617739704'},
  {area:'experiment',authors:'van Dyck, C. et al.',year:2005,title:'Organizational Error Management Culture',finding:'Kultura zarzƒÖdzania b≈Çƒôdami (nie unikania) ‚Üí lepsza wydajno≈õƒá. Otwarta komunikacja o b≈Çƒôdach kluczowa.',type:'Badanie empiryczne',src:'https://pubmed.ncbi.nlm.nih.gov/16316276/'}
];

// ===== TOOLS =====
const TOOLS=[
  {area:'fast',name:'Decyzja w 15 minut',type:'Checklista',desc:'Co wiem ‚Üí czego nie wiem ‚Üí konsekwencje bezczynno≈õci ‚Üí decyzja.',use:'Przed ka≈ºdƒÖ decyzjƒÖ czekajƒÖcƒÖ >24h.'},
  {area:'fast',name:'2-min Decision Log',type:'Mikro-nawyk',desc:'Po decyzji: 2 min na kontekst, opcje, rationale. Buduje bazƒô wiedzy.',use:'Codziennie.'},
  {area:'fast',name:'Signal Scanning Ritual',type:'Rytua≈Ç',desc:'5 sygna≈Ç√≥w/tydzie≈Ñ z rynku: co to znaczy dla nas?',use:'Poniedzia≈Çkowy stand-up.'},
  {area:'fast',name:'Decision Tempo Tracker',type:'Metryka',desc:'Od identyfikacji problemu do dzia≈Çania ‚Äî ile dni? Benchmark.',use:'Miesiƒôczny przeglƒÖd.'},
  {area:'liquid',name:'Psychological Safety Radar',type:'Diagnostyka',desc:'7 pyta≈Ñ Edmondson + 3 o przep≈Çyw wiedzy. Skala 1-5.',use:'Co kwarta≈Ç.'},
  {area:'liquid',name:'Collaboration Flow Map',type:'Canvas',desc:'Kto ‚Üí komu ‚Üí co ‚Üí jak czƒôsto ‚Üí warto≈õƒá. Bottlenecki.',use:'Raz na kwarta≈Ç.'},
  {area:'liquid',name:'Cross-Team Sync Checklist',type:'Checklista',desc:'Agenda, decyzje, action items, ownership, deadline.',use:'Ka≈ºde spotkanie cross-fun.'},
  {area:'liquid',name:'Liquid Collaboration Canvas',type:'Canvas',desc:'Role ‚Üí kana≈Çy ‚Üí czƒôstotliwo≈õƒá ‚Üí jako≈õƒá w zespo≈Çach.',use:'Sprint retrospective.'},
  {area:'liquid',name:'Team Dynamics Diagnostic',type:'Diagnostyka',desc:'PS + wsp√≥≈Çpraca ‚Üí dynamic capabilities. Benchmarki Dickel 2026.',use:'Kwartalna diagnoza.'},
  {area:'unlearn',name:'Adaptive Learning Loop',type:'Framework',desc:'Dzia≈Çaj ‚Üí Obserwuj ‚Üí Reflektuj ‚Üí Adaptuj. 4 pytania.',use:'Po ka≈ºdym sprincie/projekcie.'},
  {area:'unlearn',name:'Skill Gap Analyzer',type:'Diagnostyka',desc:'Obecne vs wymagane umiejƒôtno≈õci. Plan 30/60/90 dni.',use:'Kwartalnie, przed transformacjƒÖ.'},
  {area:'unlearn',name:'Learning Cycle Canvas',type:'Canvas',desc:'Co siƒô wydarzy≈Ço ‚Üí sprawdzi≈Ço ‚Üí nie dzia≈Ça≈Ço ‚Üí zmieniamy ‚Üí mierzymy.',use:'Retrospektywy, post-mortemy.'},
  {area:'unlearn',name:'AI Prompt Pack',type:'Prompt Pack',desc:'Podsumowanie spotkania, analiza sprzeda≈ºy, brainstorm, warianty.',use:'Codziennie z AI.'},
  {area:'experiment',name:'Hypothesis Builder',type:'Framework',desc:'Je≈õli [X] to [Y] poniewa≈º [Z]. Metryka + timeline.',use:'Przed ka≈ºdym eksperymentem.'},
  {area:'experiment',name:'Experiment Outcome Log',type:'Rejestr',desc:'Hipoteza ‚Üí test ‚Üí wynik ‚Üí wniosek ‚Üí next step.',use:'Po ka≈ºdym eksperymencie.'},
  {area:'experiment',name:'Experiment Design Kit',type:'Framework',desc:'MVP canvas, A/B template, pilot protocol, failure pre-mortem.',use:'Warsztaty innowacyjne.'},
];

// ===== MEGAWORLDS (Hatalska 2025) =====
const MEGAWORLDS={
  spoleczny:    {name:'Przeobra≈ºenia Spo≈Çeczne', color:'#6366f1', icon:'üë•'},
  ai:           {name:'≈öwiat AI',                color:'#3b82f6', icon:'ü§ñ'},
  lustrzany:    {name:'≈öwiat Lustrzany',         color:'#a78bfa', icon:'ü™û'},
  zrownowazony: {name:'Zr√≥wnowa≈ºony ≈öwiat',      color:'#22c55e', icon:'üåç'},
  zdrowie:      {name:'Kryzys Zdrowotny',        color:'#ef4444', icon:'üè•'},
  wojny:        {name:'≈öwiat Wojen',             color:'#64748b', icon:'‚öîÔ∏è'}
};

// ===== TRENDS (Mapa Trend√≥w Hatalska 2025) =====
const TRENDS=[
  // === ≈öWIAT PRZEOBRA≈ªE≈É SPO≈ÅECZNYCH ===
  {name:'Polaryzacja',mw:'spoleczny',ring:'now',flux:['unlearn'],hr:true,desc:'Pog≈Çƒôbianie podzia≈Ç√≥w spo≈Çecznych, politycznych i kulturowych.'},
  {name:'Nier√≥wno≈õci spo≈Çeczne',mw:'spoleczny',ring:'now',flux:['liquid'],hr:true,desc:'NarastajƒÖce nier√≥wno≈õci socjoekonomiczne widoczne globalnie.'},
  {name:'Kryzys demokracji',mw:'spoleczny',ring:'now',flux:['unlearn','liquid'],hr:false,desc:'Spadek zaufania obywateli, popularno≈õƒá ruch√≥w autorytarnych i populistycznych.'},
  {name:'Wojny miƒôdzypokoleniowe',mw:'spoleczny',ring:'now',flux:['liquid','unlearn'],hr:true,desc:'Napiƒôcia miƒôdzy pokoleniami w kwestii warto≈õci, pracy i zasob√≥w.'},
  {name:'Dyktat produktywno≈õci',mw:'spoleczny',ring:'now',flux:['fast','unlearn'],hr:true,desc:'Produktywno≈õƒá jako priorytet kosztem dobrostanu. AI wspiera automatyzacjƒô rutyn.'},
  {name:'P≈Çynno≈õƒá to≈ºsamo≈õci',mw:'spoleczny',ring:'now',flux:['liquid','unlearn'],hr:false,desc:'Rozmywanie tradycyjnych r√≥l, to≈ºsamo≈õci i granic spo≈Çecznych.'},
  {name:'Posteuropocentryzm',mw:'spoleczny',ring:'now',flux:['unlearn'],hr:false,desc:'Przesuniƒôcie centrum kulturowego i ekonomicznego poza Europƒô.'},
  {name:'StarzejƒÖce siƒô spo≈Çecze≈Ñstwo',mw:'spoleczny',ring:'new',flux:['liquid','unlearn'],hr:true,desc:'RosnƒÖcy odsetek ludzi 65+ zmienia rynek pracy i opiekƒô zdrowotnƒÖ.'},
  {name:'Depopulacja',mw:'spoleczny',ring:'new',flux:['liquid'],hr:false,desc:'Spadek liczby ludno≈õci w wielu krajach, zmiany regulacyjne i spo≈Çeczne.'},
  {name:'Nowe modele rodziny',mw:'spoleczny',ring:'next',flux:['unlearn'],hr:false,desc:'Ewolucja struktury rodziny wykraczajƒÖca poza tradycyjne modele.'},
  {name:'Rozpad pa≈Ñstwowo≈õci',mw:'spoleczny',ring:'next',flux:['liquid'],hr:false,desc:'NarastajƒÖce napiƒôcia geopolityczne podwa≈ºajƒÖce instytucje pa≈Ñstw.'},
  // === ≈öWIAT AI ===
  {name:'Algokracja',mw:'ai',ring:'now',flux:['fast','unlearn'],hr:true,desc:'RosnƒÖcy wp≈Çyw algorytm√≥w na decyzje, procesy i polaryzacjƒô spo≈ÇecznƒÖ.'},
  {name:'Bezrobocie technologiczne',mw:'ai',ring:'now',flux:['fast','unlearn'],hr:true,desc:'Zastƒôpowanie pracownik√≥w przez AI w us≈Çugach, produkcji i logistyce.'},
  {name:'Ekonomia tw√≥rc√≥w',mw:'ai',ring:'now',flux:['liquid','experiment'],hr:false,desc:'Demokratyzacja kompetencji tw√≥rczych dziƒôki generatywnej AI.'},
  {name:'Niestabilno≈õƒá rynku pracy',mw:'ai',ring:'now',flux:['fast','unlearn'],hr:true,desc:'Automatyzacja i AI transformujƒÖ rynek pracy ‚Äî reskilling i upskilling.'},
  {name:'Etyczna AI',mw:'ai',ring:'new',flux:['unlearn','experiment'],hr:false,desc:'Budowanie AI zgodnej z warto≈õciami etycznymi, wolnej od uprzedze≈Ñ.'},
  {name:'Citizen Developer Era',mw:'ai',ring:'new',flux:['liquid','experiment'],hr:false,desc:'Demokratyzacja tworzenia oprogramowania dziƒôki no-code i AI-driven development.'},
  {name:'Human-like AI',mw:'ai',ring:'new',flux:['unlearn','experiment'],hr:false,desc:'AI coraz bardziej przypominajƒÖca cz≈Çowieka w my≈õleniu i interakcji.'},
  {name:'Inteligencja kolektywna',mw:'ai',ring:'new',flux:['liquid'],hr:false,desc:'Synergia ludzkiej intuicji i zdolno≈õci AI do analizy z≈Ço≈ºonych problem√≥w.'},
  {name:'Autonomiczno≈õƒá 2.0',mw:'ai',ring:'next',flux:['fast','experiment'],hr:false,desc:'Systemy AI zdolne do samodzielnego podejmowania decyzji i adaptacji.'},
  {name:'Og√≥lna sztuczna inteligencja (AGI)',mw:'ai',ring:'beyond',flux:['fast','experiment'],hr:false,desc:'AI o zdolno≈õciach poznawczych por√≥wnywalnych z ludzkim umys≈Çem.'},
  {name:'Sztuczna superinteligencja',mw:'ai',ring:'beyond',flux:['experiment'],hr:false,desc:'AI przewy≈ºszajƒÖca ludzkie zdolno≈õci we wszystkich domenach.'},
  // === ≈öWIAT LUSTRZANY ===
  {name:'Chroniczinie online',mw:'lustrzany',ring:'now',flux:['unlearn'],hr:true,desc:'Izolacja spo≈Çeczna, spadek empatii, zaburzenia zdrowia psychicznego.'},
  {name:'Zniekszta≈Çcona rzeczywisto≈õƒá',mw:'lustrzany',ring:'now',flux:['unlearn'],hr:false,desc:'Manipulacja informacjƒÖ, deepfakes, zaburzenie granicy prawda/fa≈Çsz.'},
  {name:'Antytech',mw:'lustrzany',ring:'now',flux:['unlearn'],hr:true,desc:'Sprzeciw wobec wp≈Çywu tech-gigant√≥w. ≈öwiadome ograniczanie technologii.'},
  {name:'Analfabetyzm funkcjonalny',mw:'lustrzany',ring:'now',flux:['unlearn','liquid'],hr:true,desc:'Obni≈ºenie zdolno≈õci czytania ze zrozumieniem i formu≈Çowania my≈õli.'},
  {name:'Antynauka',mw:'lustrzany',ring:'now',flux:['unlearn'],hr:true,desc:'Kwestionowanie nauki, rozprzestrzenianie teorii spiskowych i fake news√≥w.'},
  {name:'Datafikacja spo≈Çecze≈Ñstwa',mw:'lustrzany',ring:'new',flux:['fast','liquid'],hr:false,desc:'Przekszta≈Çcanie ≈ºycia spo≈Çecznego w dane ‚Äî algorytmy i inwigiliacja.'},
  {name:'Syntetyczna rzeczywisto≈õƒá',mw:'lustrzany',ring:'new',flux:['experiment'],hr:false,desc:'Generowane przez AI ≈õrodowiska zastƒôpujƒÖce do≈õwiadczenie fizyczne.'},
  {name:'Spo≈Çecze≈Ñstwo hybrydowe',mw:'lustrzany',ring:'new',flux:['liquid'],hr:false,desc:'≈ªycie jednocze≈õnie w ≈õwiecie fizycznym i cyfrowym jako norma.'},
  {name:'Internet istot',mw:'lustrzany',ring:'new',flux:['experiment','liquid'],hr:false,desc:'Rozszerzenie IoT na organizmy ≈ºywe ‚Äî zbieranie i analiza danych biologicznych.'},
  // === ZR√ìWNOWA≈ªONY ≈öWIAT ===
  {name:'Dekarbonizacja',mw:'zrownowazony',ring:'now',flux:['experiment','fast'],hr:false,desc:'Redukcja emisji CO‚ÇÇ i zastosowanie innowacyjnych technologii klimatycznych.'},
  {name:'Hiperlokalno≈õƒá',mw:'zrownowazony',ring:'now',flux:['liquid'],hr:false,desc:'Lokalna produkcja, kr√≥tkie ≈Ça≈Ñcuchy dostaw, budowanie sieci lokalnych.'},
  {name:'Decentralizacja',mw:'zrownowazony',ring:'now',flux:['liquid','experiment'],hr:false,desc:'Zwiƒôkszenie odporno≈õci system√≥w przez rozproszenie zasob√≥w i w≈Çadzy.'},
  {name:'Regeneratywne miasta',mw:'zrownowazony',ring:'new',flux:['experiment'],hr:false,desc:'Miasta aktywnie odbudowujƒÖce ekosystemy, nie tylko minimalizujƒÖce szkody.'},
  {name:'Rezyliencja energetyczna',mw:'zrownowazony',ring:'new',flux:['experiment','fast'],hr:false,desc:'Odporno≈õƒá system√≥w energetycznych na kryzysy i zak≈Ç√≥cenia.'},
  {name:'Nowe materia≈Çy',mw:'zrownowazony',ring:'next',flux:['experiment'],hr:false,desc:'Biomateria≈Çy, materia≈Çy postkrzemowe, programowalne substancje.'},
  {name:'Biocomputing',mw:'zrownowazony',ring:'beyond',flux:['experiment'],hr:false,desc:'Przetwarzanie danych na strukturach biologicznych ‚Äî DNA, bia≈Çka, kom√≥rki.'},
  // === ≈öWIAT KRYZYS√ìW ZDROWOTNYCH ===
  {name:'Kryzys zdrowia psychicznego',mw:'zdrowie',ring:'now',flux:['unlearn','liquid'],hr:true,desc:'Stale nasilajƒÖcy siƒô stres, lƒôki, depresja ‚Äî szczeg√≥lnie w≈õr√≥d m≈Çodych.'},
  {name:'Spo≈Çecze≈Ñstwo wypalenia',mw:'zdrowie',ring:'now',flux:['unlearn','fast'],hr:true,desc:'Chroniczny stres i przepracowanie jako norma spo≈Çeczna.'},
  {name:'Osamotnienie',mw:'zdrowie',ring:'now',flux:['liquid','unlearn'],hr:true,desc:'Epidemia samotno≈õci mimo hiper≈ÇƒÖczno≈õci cyfrowej.'},
  {name:'Dehumanizacja relacji',mw:'zdrowie',ring:'now',flux:['liquid','unlearn'],hr:false,desc:'Spadek umiejƒôtno≈õci komunikacyjnych, izolacja i zanik empatii.'},
  {name:'Dobrostan',mw:'zdrowie',ring:'now',flux:['liquid','experiment'],hr:false,desc:'Podej≈õcie holistyczne do zdrowia ‚Äî fizyczne, psychiczne, spo≈Çeczne.'},
  {name:'Spo≈Çecze≈Ñstwo uzale≈ºnionych',mw:'zdrowie',ring:'now',flux:['unlearn'],hr:true,desc:'Uzale≈ºnienia od technologii, substancji, medi√≥w spo≈Çeczno≈õciowych.'},
  {name:'Lekooporno≈õƒá',mw:'zdrowie',ring:'new',flux:['experiment'],hr:false,desc:'Oporno≈õƒá bakterii na antybiotyki jako kolejny globalny kryzys zdrowotny.'},
  {name:'Medycyna regeneratywna',mw:'zdrowie',ring:'new',flux:['experiment'],hr:false,desc:'Terapie oparte na regeneracji kom√≥rek, tkanek i narzƒÖd√≥w.'},
  {name:'Epidemia chor√≥b m√≥zgu',mw:'zdrowie',ring:'next',flux:['experiment','unlearn'],hr:false,desc:'Wzrost chor√≥b neurodegeneracyjnych: Alzheimer, Parkinson, ALS.'},
  {name:'Wellaging',mw:'zdrowie',ring:'next',flux:['experiment'],hr:false,desc:'Op√≥≈∫nianie, hamowanie lub odwracanie proces√≥w starzenia.'},
  {name:'Eliminacja staro≈õci',mw:'zdrowie',ring:'next',flux:['experiment'],hr:false,desc:'DƒÖ≈ºenie naukowe do spowolnienia biologicznego starzenia.'},
  // === ≈öWIAT WOJEN ===
  {name:'Erozja ≈Çadu jednobiegunowego',mw:'wojny',ring:'now',flux:['fast','liquid'],hr:false,desc:'Spadek zaufania do instytucji, wielobiegunowy i niestabilny ≈õwiat.'},
  {name:'Imperializm technologiczny',mw:'wojny',ring:'now',flux:['fast'],hr:false,desc:'Pa≈Ñstwa z przewagƒÖ AI i robotyki uzyskujƒÖ globalnƒÖ dominacjƒô.'},
  {name:'Militaryzacja AI',mw:'wojny',ring:'now',flux:['fast','experiment'],hr:false,desc:'Automatyzacja proces√≥w decyzyjnych w dzia≈Çaniach zbrojnych.'},
  {name:'Deglobalizacja',mw:'wojny',ring:'now',flux:['liquid','unlearn'],hr:false,desc:'Os≈Çabienie integracji globalnej ‚Äî napiƒôcia handlowe i geopolityczne.'},
  {name:'Kryzys wodny',mw:'wojny',ring:'now',flux:['fast','experiment'],hr:false,desc:'Eskalacja niedoboru zasob√≥w wodnych miƒôdzy pa≈Ñstwami.'},
  {name:'Wojny kognitywne',mw:'wojny',ring:'now',flux:['unlearn'],hr:false,desc:'Manipulacja percepcjƒÖ i przekonaniami jako bro≈Ñ wsp√≥≈Çczesna.'},
  {name:'Era nadmiaru danych',mw:'wojny',ring:'now',flux:['fast','unlearn'],hr:false,desc:'Lawinowy wzrost danych i trudno≈õci z ich przetwarzaniem i selekcjƒÖ.'},
  {name:'Wy≈õcig kosmiczny 2.0',mw:'wojny',ring:'next',flux:['experiment','fast'],hr:false,desc:'Rywalizacja o zasoby i dominacjƒô w przestrzeni kosmicznej.'},
  {name:'Geopolityka kosmosu',mw:'wojny',ring:'next',flux:['fast'],hr:false,desc:'Regulacje orbitalne, cyberzagro≈ºenia satelitarne, bro≈Ñ antysatelitarna.'},
  // === CROSS-DOMAIN (pojawiajƒÖ siƒô w wielu mega≈õwiatach) ===
  {name:'AI-fobia',mw:'ai',ring:'now',flux:['unlearn'],hr:true,desc:'Lƒôk przed AI, utratƒÖ kontroli, FOBO ‚Äî Fear of Becoming Obsolete.'},
  {name:'Korpokracja',mw:'spoleczny',ring:'now',flux:['liquid','fast'],hr:false,desc:'Przejmowanie w≈Çadzy przez korporacje technologiczne kosztem demokracji.'},
  {name:'Migracje',mw:'wojny',ring:'now',flux:['liquid','unlearn'],hr:false,desc:'Z≈Ço≈ºono≈õƒá migracji wymagajƒÖca strategicznego podej≈õcia i adaptacji.'},
  {name:'Biologia syntetyczna',mw:'zrownowazony',ring:'next',flux:['experiment'],hr:false,desc:'Projektowanie i modyfikowanie organizm√≥w biologicznych na zam√≥wienie.'},
  {name:'Lab Grown',mw:'zrownowazony',ring:'next',flux:['experiment'],hr:false,desc:'Produkty wytwarzane w laboratorium ‚Äî miƒôso, materia≈Çy, leki.'},
  {name:'Cz≈Çowiek+',mw:'zdrowie',ring:'new',flux:['experiment','unlearn'],hr:false,desc:'Polepszanie ludzkiego cia≈Ça i umys≈Çu przez technologiƒô i genetykƒô.'},
  {name:'Rewolucja neurotechnologiczna',mw:'zdrowie',ring:'beyond',flux:['experiment'],hr:false,desc:'Interfejsy m√≥zg-maszyna, implanty neuronowe, terapie neuromodulacyjne.'},
  {name:'Prawa istot pozaludzkich',mw:'zrownowazony',ring:'beyond',flux:['unlearn','experiment'],hr:false,desc:'Regulacje prawne dla AI i zwierzƒÖt, redefinicja podmiotowo≈õci.'}
];

// ===== STATE =====
let filters={area:'all',industry:'all',role:'all',situation:'all',context:'all',challenge:'all'};
let trendFilter='all',resFilter='all',mwFilter='all',hrOnly=false;
let tooltipTimer=null;

// ===== FLUX BADGE (reusable clickable badge) =====
function fluxBadge(area,opts={}){
  const {size='sm',showName=false,clickAction='tooltip'}=opts;
  const d=FLUX[area],c=CC[area];
  const sz=size==='md'?'text-sm px-3 py-1':'text-xs px-2 py-0.5';
  const label=showName?d.letter+' ‚Äî '+d.name:d.letter;
  let action;
  if(clickAction==='detail')action="showDetail('"+area+"')";
  else if(clickAction==='filter')action="nav('explore');filters.area='"+area+"';renderExplore()";
  else action="event.stopPropagation();showMiniTooltip(event,'"+area+"')";
  return '<span class="'+sz+' rounded-full '+c.bg+' '+c.t+' font-bold cursor-pointer hover:brightness-125 transition-all" onclick="'+action+'" title="'+d.name+': '+d.full+'">'+label+'</span>';
}

// ===== WHEEL CLOUD TOOLTIP =====
function showWheelTooltip(area){
  clearTimeout(tooltipTimer);
  const tt=document.getElementById('flux-tooltip');
  if(!tt)return;
  const d=FLUX[area],c=CC[area];
  const count=SCENARIOS.filter(s=>{
    if(!s.area.includes(area))return false;
    if(filters.industry!=='all'&&!s.industry.includes(filters.industry)&&s.industry.length>0)return false;
    if(filters.role!=='all'&&!s.role.includes(filters.role)&&s.role.length>0)return false;
    return true;
  }).length;
  const relTrends=TRENDS.filter(t=>t.flux&&t.flux.includes(area)).slice(0,5);
  tt.innerHTML=`
    <div class="flex items-center gap-2 mb-2">
      <span class="w-10 h-10 rounded-lg ${c.bg} flex items-center justify-center"><span class="${c.t} font-black text-xl">${d.letter}</span></span>
      <div><h4 class="${c.t} font-bold text-sm">${d.name}</h4><p class="text-slate-500 text-xs">${d.full}</p></div>
    </div>
    <p class="text-xs text-slate-400 mb-3">${d.def.substring(0,120)}...</p>
    <div class="flex items-center gap-2 mb-2">
      <span class="text-xs px-2 py-0.5 rounded-full ${c.bg} ${c.t} cursor-pointer hover:brightness-125" onclick="hideWheelTooltip();nav('explore');filters.area='${area}';renderExplore()">${count} scenariuszy ‚Üí</span>
    </div>
    <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-1">Antywzorce</p>
    <div class="space-y-0.5 mb-3">${d.anti.slice(0,2).map(a=>'<p class="text-xs text-red-400/70">‚úï '+a.split('‚Äî')[0].trim()+'</p>').join('')}</div>
    ${relTrends.length?`<p class="text-[10px] text-slate-500 uppercase tracking-widest mb-1">Trendy 2025</p>
    <div class="flex flex-wrap gap-1 mb-2">${relTrends.slice(0,4).map(t=>{
      const mw=MEGAWORLDS[t.mw];
      return '<span class="text-[10px] px-1.5 py-0.5 rounded" style="background:'+mw.color+'20;color:'+mw.color+'">'+(t.hr?'‚ö° ':'')+t.name+'</span>';
    }).join('')}</div>`:''}
    <p class="text-xs text-slate-500 mt-1 italic cursor-pointer" onclick="hideWheelTooltip();showDetail('${area}')">Szczeg√≥≈Çy ‚Üí</p>`;
  tt.className='flux-tooltip tt-'+area;
  // Dynamic positioning based on wheel quadrant center
  const svg=document.querySelector('#view-home svg');
  if(svg){
    const sr=svg.getBoundingClientRect();
    const cx=sr.left+sr.width/2,cy=sr.top+sr.height/2;
    const qr=sr.width/4; // quadrant radius
    const vw=document.documentElement.clientWidth;
    const vh=document.documentElement.clientHeight;
    let tx,ty;
    if(area==='fast'){tx=cx+qr/2;ty=cy-qr*1.5;} // top-right ‚Üí tooltip right of center
    else if(area==='liquid'){tx=cx+qr/2;ty=cy+qr/2;} // bottom-right
    else if(area==='unlearn'){tx=cx-qr*1.5-160;ty=cy+qr/2;} // bottom-left
    else{tx=cx-qr*1.5-160;ty=cy-qr*1.5;} // experiment top-left
    // Clamp to viewport
    tx=Math.max(8,Math.min(tx,vw-328));
    ty=Math.max(60,Math.min(ty,vh-380));
    Object.assign(tt.style,{top:ty+'px',left:tx+'px',bottom:'',right:''});
  }
  requestAnimationFrame(()=>tt.classList.add('visible'));
}
function hideWheelTooltip(){
  tooltipTimer=setTimeout(()=>{const tt=document.getElementById('flux-tooltip');if(tt)tt.classList.remove('visible');},200);
}
function keepWheelTooltip(){clearTimeout(tooltipTimer);}

// ===== MINI TOOLTIP (for inline badges) =====
function showMiniTooltip(ev,area){
  ev.stopPropagation();
  document.getElementById('mini-tooltip')?.remove();
  const d=FLUX[area],c=CC[area];
  const div=document.createElement('div');
  div.id='mini-tooltip';
  div.className='fixed z-[10002] max-w-xs p-3 bg-dark-900/95 backdrop-blur-md border border-dark-700 rounded-xl shadow-2xl';
  div.innerHTML=`
    <div class="flex items-center gap-2 mb-1"><span class="${c.t} font-black text-lg">${d.letter}</span><span class="${c.t} font-bold text-sm">${d.name}</span></div>
    <p class="text-xs text-slate-400 mb-2">${d.full}</p>
    <p class="text-xs text-slate-500 mb-2">${d.def.substring(0,100)}...</p>
    <button class="text-xs ${c.t} hover:underline" onclick="showDetail('${area}');document.getElementById('mini-tooltip')?.remove()">Szczeg√≥≈Çy ‚Üí</button>`;
  const rect=ev.target.getBoundingClientRect();
  div.style.left=Math.min(rect.left,window.innerWidth-280)+'px';
  div.style.top=(rect.bottom+8)+'px';
  document.body.appendChild(div);
  setTimeout(()=>{document.addEventListener('click',function h(e){if(!div.contains(e.target)){div.remove();document.removeEventListener('click',h)}})},10);
}

// ===== WHEEL TREND DOTS (Home view) =====
function renderWheelTrendDots(){
  const g=document.getElementById('wheel-trend-dots');if(!g)return;
  const cx=400,cy=400;
  // Quadrant angle ranges (center angles for placing dots)
  const quadrants={fast:{startA:-80,endA:-10,r:[100,170,230]},liquid:{startA:10,endA:80,r:[100,170,230]},unlearn:{startA:100,endA:170,r:[100,170,230]},experiment:{startA:190,endA:260,r:[100,170,230]}};
  let h='';
  ['fast','liquid','unlearn','experiment'].forEach(area=>{
    const hrTrends=TRENDS.filter(t=>t.flux&&t.flux.includes(area)&&t.hr);
    const topTrends=hrTrends.slice(0,6);
    const q=quadrants[area];
    const spread=q.endA-q.startA;
    topTrends.forEach((t,i)=>{
      const mw=MEGAWORLDS[t.mw];
      const rIdx=Math.floor(i/2);
      const r=q.r[Math.min(rIdx,q.r.length-1)];
      const angleOffset=spread/(Math.min(topTrends.length,6)+1)*(i+1);
      const angle=(q.startA+angleOffset)*Math.PI/180;
      const x=cx+r*Math.cos(angle),y=cy+r*Math.sin(angle);
      const dotR=t.ring==='now'?4:3;
      const op=t.ring==='now'?.5:t.ring==='new'?.35:.2;
      h+=`<g class="cursor-pointer" onclick="event.stopPropagation();nav('trends');trendFilter='${area}';renderTrends()">
        <circle cx="${x}" cy="${y}" r="${dotR}" fill="${mw.color}" opacity="${op}"/>
        <text x="${x}" y="${y-dotR-3}" text-anchor="middle" fill="${mw.color}" font-size="5" opacity="${op*.8}" font-weight="500">${t.name.length>14?t.name.substring(0,12)+'‚Ä¶':t.name}</text>
      </g>`;
    });
  });
  g.innerHTML=h;
}

// ===== NAVIGATION =====
function nav(v){
  document.querySelectorAll('.view').forEach(el=>el.classList.remove('active'));
  document.querySelectorAll('.nav-link').forEach(l=>{l.classList.remove('active');l.style.removeProperty('color')});
  const el=document.getElementById('view-'+v);
  if(el)el.classList.add('active');
  document.querySelector(`.nav-link[data-v="${v}"]`)?.classList.add('active');
  if(v==='explore')renderExplore();
  if(v==='trends')renderTrends();
  if(v==='research')renderResearch();
  if(v==='tools')renderTools();
  if(v==='modules')renderModulesView();
  if(v==='diagnostic')renderDiagnosticView();
  if(v==='actionplan')renderActionPlanView();
  if(v==='trainer')renderTrainerView();
  if(isModuleOn('progress'))trackViewVisit(v);
  window.scrollTo({top:0,behavior:'smooth'});
}
function toggleMobile(){
  document.querySelector('.hamburger').classList.toggle('open');
  document.querySelector('.mobile-menu').classList.toggle('open');
}

// ===== DETAIL VIEW =====
let curArea=null,curTab='overview';
function showDetail(a){
  curArea=a;curTab='overview';const d=FLUX[a],c=CC[a];
  document.getElementById('detail-header').innerHTML=`
    <div class="flex items-center gap-3"><div class="w-12 h-12 rounded-xl ${c.bg} flex items-center justify-center"><span class="${c.t} font-black text-2xl">${d.letter}</span></div>
    <div><h2 class="text-2xl font-black ${c.t}">${d.name}</h2><p class="text-slate-400 text-sm">${d.full}</p></div>
    <button class="dl-btn ml-auto" onclick="downloadSection('detail')">üì• Pobierz</button></div>
    <p class="mt-3 text-sm text-slate-300 bg-dark-900 rounded-lg p-3 border ${c.b}">${d.def}</p>`;
  const tabs=['overview','research','industries','tools'];
  const labels=['PrzeglƒÖd','Badania','Scenariusze','Narzƒôdzia'];
  document.getElementById('detail-tabs').innerHTML=tabs.map((t,i)=>`<button class="tab-btn pb-2 text-xs font-medium ${t==='overview'?c.t+' active':'text-slate-500'}" onclick="curTab='${t}';renderDetail()" style="border-bottom-color:${t==='overview'?d.color:'transparent'}">${labels[i]}</button>`).join('');
  renderDetail();nav('detail');
}
function renderDetail(){
  const d=FLUX[curArea],c=CC[curArea],el=document.getElementById('detail-content');
  document.querySelectorAll('.tab-btn').forEach(b=>{b.classList.remove('active',c.t);b.classList.add('text-slate-500');b.style.borderBottomColor='transparent'});
  event?.target?.classList?.add('active',c.t);
  if(event?.target)event.target.style.borderBottomColor=d.color;

  if(curTab==='overview'){
    let antiHtml='';
    if(isModuleOn('antipatterns')){
      antiHtml=`<div class="bg-dark-900 rounded-xl p-5 border border-dark-700 md:col-span-2"><p class="text-xs uppercase tracking-widest text-slate-500 mb-3">Antywzorce ‚Äî zaznacz te, kt√≥re obserwujesz</p><div class="grid grid-cols-1 md:grid-cols-2 gap-2">${d.anti.map((a,i)=>`<label class="flex gap-2 items-start cursor-pointer"><input type="checkbox" class="mt-1 accent-red-400" onchange="updateAntiDetector('${curArea}')"><span class="text-sm text-slate-400">${a}</span></label>`).join('')}</div><div id="anti-recommendations" class="mt-3"></div></div>`;
    } else {
      antiHtml=`<div class="bg-dark-900 rounded-xl p-5 border border-dark-700 md:col-span-2"><p class="text-xs uppercase tracking-widest text-slate-500 mb-3">Antywzorce</p><div class="grid grid-cols-1 md:grid-cols-2 gap-2">${d.anti.map(a=>`<div class="flex gap-2 items-start"><span class="text-red-400 text-sm mt-0.5">‚úï</span><span class="text-sm text-slate-400">${a}</span></div>`).join('')}</div></div>`;
    }
    let exerciseHtml='';
    if(isModuleOn('exercises')){
      const areaExercises=EXERCISES.filter(e=>e.area===curArea);
      if(areaExercises.length)exerciseHtml=`<div class="md:col-span-2"><p class="text-xs uppercase tracking-widest text-slate-500 mb-3 mt-2">ƒÜwiczenia interaktywne</p>${areaExercises.map(e=>renderExercise(e.id)).join('')}</div>`;
    }
    el.innerHTML=`<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div class="bg-dark-900 rounded-xl p-5 border border-dark-700"><p class="text-xs uppercase tracking-widest text-slate-500 mb-2">Kluczowe pytanie</p><p class="${c.t} font-medium text-base">${d.q}</p></div>
      <div class="bg-dark-900 rounded-xl p-5 border border-dark-700"><p class="text-xs uppercase tracking-widest text-slate-500 mb-2">Poziomy</p>${d.levels.map((l,i)=>`<div class="flex gap-2 items-start mb-3"><span class="w-6 h-6 rounded-full ${c.bg} flex items-center justify-center flex-shrink-0"><span class="${c.t} text-xs font-bold">${i+1}</span></span><div><span class="text-sm font-semibold text-slate-300">${l.l}</span><p class="text-xs text-slate-500">${l.d}</p></div></div>`).join('')}</div>
      ${antiHtml}${exerciseHtml}</div>`;
  }
  if(curTab==='research'){
    const r=RESEARCH.filter(x=>x.area===curArea);
    el.innerHTML=r.map(x=>`<div class="bg-dark-900 rounded-xl p-4 border border-dark-700 mb-3"><div class="flex items-center gap-2 mb-1"><span class="text-[10px] px-2 py-0.5 rounded-full ${c.bg} ${c.t}">${x.type}</span><span class="text-[10px] text-slate-600">${x.year}</span></div><h4 class="text-sm font-semibold text-slate-200">${x.title}</h4><p class="text-[11px] text-slate-500 mb-1">${x.authors}</p><p class="text-xs text-slate-400">${x.finding}</p>${x.src?`<a href="${x.src}" target="_blank" class="text-[11px] ${c.t} hover:underline mt-1 inline-block">≈πr√≥d≈Ço ‚Üí</a>`:''}</div>`).join('');
  }
  if(curTab==='industries'){
    const s=SCENARIOS.filter(x=>x.area.includes(curArea));
    el.innerHTML=s.map(x=>{
      let extra='';
      // Evidence badge
      if(isModuleOn('evidence')&&EVIDENCE_MAP[x.title]){const ev=EVIDENCE_MAP[x.title];extra+=`<span class="text-xs px-2 py-0.5 rounded-full bg-emerald-500/10 text-emerald-400 ml-1" title="${EVIDENCE_TIERS[ev.tier]}">${EVIDENCE_TIERS[ev.tier]}</span>`}
      // Case study
      let csHtml='';
      if(isModuleOn('casestudies')&&CASE_STUDIES[x.title]){const cs=CASE_STUDIES[x.title];csHtml=`<details class="mt-2 bg-dark-950 rounded-lg border border-dark-700"><summary class="p-3 text-sm text-amber-400 cursor-pointer font-medium">üìñ Deep Case Study</summary><div class="p-3 pt-0 space-y-2"><p class="text-sm text-slate-300"><strong class="text-slate-400">Sytuacja:</strong> ${cs.situation}</p><p class="text-sm text-slate-300"><strong class="text-slate-400">Kontekst:</strong> ${cs.context}</p><p class="text-sm text-slate-300"><strong class="text-slate-400">Dzia≈Çanie:</strong> ${cs.action}</p><p class="text-sm text-emerald-400"><strong class="text-slate-400">Rezultat:</strong> ${cs.result}</p>${cs.debrief?`<div class="border-t border-dark-700 pt-2 mt-2"><p class="text-xs text-slate-500 font-bold mb-1">Pytania debriefingowe:</p>${cs.debrief.map(q=>`<p class="text-xs text-slate-400">‚Üí ${q}</p>`).join('')}</div>`:''}</div></details>`}
      // Frameworks
      let fwHtml='';
      if(isModuleOn('frameworks')){const fws=Object.entries(FRAMEWORKS).filter(([_,f])=>x.context.some(c=>f.contexts.includes(c)));if(fws.length)fwHtml=`<div class="flex flex-wrap gap-1 mt-2">${fws.map(([k,f])=>`<details class="inline"><summary class="text-xs px-2 py-0.5 rounded-full bg-violet-500/10 text-violet-400 cursor-pointer">üß© ${f.name}</summary><div class="bg-dark-950 rounded-lg p-2 mt-1 text-xs text-slate-400">${f.steps.map(s=>`<p>‚Üí ${s}</p>`).join('')}</div></details>`).join('')}</div>`}
      return`<div class="bg-dark-900 rounded-xl p-5 border border-dark-700 mb-3"><div class="flex items-center flex-wrap gap-1 mb-2"><h4 class="text-sm font-semibold text-slate-200">${x.title}</h4>${extra}</div><p class="text-sm text-slate-400 mb-2">${x.desc}</p><div class="flex flex-wrap gap-1.5 mb-2">${x.industry.map(i=>{const ind=INDUSTRIES.find(z=>z.id===i);return ind?`<span class="text-xs px-2 py-0.5 rounded bg-slate-800 text-slate-400">${ind.icon} ${ind.name}</span>`:''}).join('')}${x.context.map(ctx=>`<span class="text-xs px-2 py-0.5 rounded bg-violet-500/10 text-violet-400">${LIFE_CONTEXTS.find(z=>z.id===ctx)?.icon||''} ${LIFE_CONTEXTS.find(z=>z.id===ctx)?.name||ctx}</span>`).join('')}</div><div class="bg-dark-950 rounded-lg p-3 text-sm text-emerald-400/80"><strong>Tip:</strong> ${x.tip}</div>${csHtml}${fwHtml}</div>`;
    }).join('');
  }
  if(curTab==='tools'){
    const t=TOOLS.filter(x=>x.area===curArea);
    el.innerHTML=`<div class="grid grid-cols-1 md:grid-cols-2 gap-3">${t.map(x=>`<div class="bg-dark-900 rounded-xl p-4 border border-dark-700"><span class="text-[10px] px-2 py-0.5 rounded-full ${c.bg} ${c.t}">${x.type}</span><h4 class="text-sm font-semibold text-slate-200 mt-2 mb-1">${x.name}</h4><p class="text-xs text-slate-400 mb-2">${x.desc}</p><p class="text-[11px] text-slate-500 border-t border-dark-700 pt-2"><span class="text-slate-400">Kiedy:</span> ${x.use}</p></div>`).join('')}</div>`;
  }
}

// ===== EXPLORE (FILTERS + SCENARIOS) =====
function initFilterChips(){
  const mk=(arr,fld,cont)=>{
    let h=`<span class="chip on text-sm px-4 py-1.5 rounded-full bg-slate-800 text-slate-300 border border-slate-700" style="--ring:#94a3b8" data-f="${fld}" data-v="all" onclick="toggleFilter(this)">Wszystkie</span>`;
    arr.forEach(x=>{h+=`<span class="chip text-sm px-4 py-1.5 rounded-full bg-slate-800/50 text-slate-400 border border-slate-700/50" style="--ring:#94a3b8" data-f="${fld}" data-v="${x.id}" onclick="toggleFilter(this)">${x.icon||''} ${x.name}</span>`});
    document.getElementById(cont).innerHTML=h;
  };
  mk(INDUSTRIES,'industry','industry-chips');
  mk(ROLES,'role','role-chips');
  mk(SITUATIONS,'situation','situation-chips');
  mk(LIFE_CONTEXTS,'context','context-chips');
  mk(CHALLENGE_TYPES,'challenge','challenge-chips');
}
function toggleFilter(el){
  const f=el.dataset.f,v=el.dataset.v;
  // deselect all in same group
  el.parentElement.querySelectorAll('.chip').forEach(c=>c.classList.remove('on'));
  el.classList.add('on');
  filters[f]=v;
  renderExplore();
}
function resetFilters(){
  filters={area:'all',industry:'all',role:'all',situation:'all',context:'all',challenge:'all'};
  document.querySelectorAll('#filter-bar .chip').forEach(c=>{c.classList.remove('on');if(c.dataset.v==='all')c.classList.add('on')});
  renderExplore();
}
function renderExplore(){
  let results=SCENARIOS.filter(s=>{
    if(filters.area!=='all'&&!s.area.includes(filters.area))return false;
    if(filters.industry!=='all'&&!s.industry.includes(filters.industry)&&s.industry.length>0)return false;
    if(filters.industry!=='all'&&s.industry.length===0)return false;
    if(filters.role!=='all'&&!s.role.includes(filters.role)&&s.role.length>0)return false;
    if(filters.role!=='all'&&s.role.length===0)return false;
    if(filters.situation!=='all'&&!s.situation.includes(filters.situation))return false;
    if(filters.context!=='all'&&!s.context.includes(filters.context))return false;
    if(filters.challenge!=='all'&&!s.challenge.includes(filters.challenge))return false;
    return true;
  });
  document.getElementById('result-count').textContent=`${results.length} scenariuszy`;
  document.getElementById('explore-results').innerHTML=results.length?results.map(s=>{
    const areaColors=s.area.map(a=>C[a]||'#94a3b8');
    const mainArea=s.area[0];const c=CC[mainArea]||CC.fast;
    const bookmarked=isModuleOn('progress')&&getProgress().bookmarks.includes(s.title);
    let evidBadge='';if(isModuleOn('evidence')&&EVIDENCE_MAP[s.title]){const ev=EVIDENCE_MAP[s.title];evidBadge=`<span class="text-xs px-2 py-0.5 rounded-full bg-emerald-500/10 text-emerald-400">${EVIDENCE_TIERS[ev.tier]}</span>`}
    return`<div class="scenario-card bg-dark-900 rounded-xl p-5 border border-dark-700 hover:${c.b}">
      <div class="flex items-center justify-between mb-2"><div class="flex items-center gap-1.5">${s.area.map(a=>fluxBadge(a)).join('')}${evidBadge}</div>${isModuleOn('progress')?`<button onclick="event.stopPropagation();toggleBookmark('${s.title.replace(/'/g,"\\'")}');renderExplore()" class="text-lg ${bookmarked?'text-amber-400':'text-slate-600 hover:text-amber-400'}" title="Bookmark">${bookmarked?'‚òÖ':'‚òÜ'}</button>`:''}</div>
      <h4 class="text-sm font-semibold text-slate-200 mb-1">${s.title}</h4>
      <p class="text-sm text-slate-400 mb-3">${s.desc}</p>
      <div class="flex flex-wrap gap-1.5 mb-3">${s.industry.map(i=>{const ind=INDUSTRIES.find(z=>z.id===i);return ind?`<span class="text-xs px-2 py-0.5 rounded bg-slate-800 text-slate-400">${ind.icon} ${ind.name}</span>`:''}).join('')}${s.role.map(r=>{const rl=ROLES.find(z=>z.id===r);return rl?`<span class="text-xs px-2 py-0.5 rounded bg-slate-800 text-slate-400">${rl.name}</span>`:''}).join('')}${s.context.map(x=>{const lc=LIFE_CONTEXTS.find(z=>z.id===x);return lc?`<span class="text-xs px-2 py-0.5 rounded bg-violet-500/10 text-violet-400">${lc.icon} ${lc.name}</span>`:''}).join('')}${s.situation.map(x=>{const st=SITUATIONS.find(z=>z.id===x);return st?`<span class="text-xs px-2 py-0.5 rounded bg-cyan-500/10 text-cyan-400">${st.icon} ${st.name}</span>`:''}).join('')}</div>
      <div class="bg-dark-950 rounded-lg p-3 text-sm text-emerald-400/80"><strong>Tip:</strong> ${s.tip}</div>
      ${s.fluxWhy?`<details class="mt-2"><summary class="text-xs text-slate-500 cursor-pointer hover:text-slate-300 transition-colors">Dlaczego ${s.area.map(a=>FLUX[a].letter).join('+')}?</summary><p class="text-xs text-slate-400 mt-1 pl-2 border-l-2 border-dark-700">${s.fluxWhy}</p></details>`:''}
      ${(()=>{const rt=getScenarioTrends(s);return rt.length?`<details class="mt-1"><summary class="text-xs text-slate-500 cursor-pointer hover:text-slate-300 transition-colors">üåç PowiƒÖzane trendy (${rt.length})</summary><div class="flex flex-wrap gap-1 mt-1">${rt.map(t=>{const mw=MEGAWORLDS[t.mw];return`<span class="cross-link" style="background:${mw.color}10;color:${mw.color}" onclick="event.stopPropagation();nav('trends');setTimeout(()=>showTrendPopup({clientX:400,clientY:300,stopPropagation:()=>{}},'${t.name.replace(/'/g,"\\\\'")}'),300)">${t.name}</span>`}).join('')}</div></details>`:''})()}
    </div>`;
  }).join(''):`<div class="col-span-2 text-center py-12 text-slate-500 text-sm">Brak scenariuszy dla wybranych filtr√≥w. <button onclick="resetFilters()" class="text-amber-400 hover:underline">Resetuj</button></div>`;
}

// ===== TREND MAP (Hatalska 2025) =====
function renderTrends(){
  const svg=document.getElementById('trend-map');
  const cx=700,cy=700;
  const rings={now:250,new:390,next:510,beyond:620};
  // 6 megaworld sectors ‚Äî each gets 60¬∞ (wider spacing)
  const mwSectors={spoleczny:[-90,-30],ai:[-30,30],lustrzany:[30,90],zrownowazony:[90,150],zdrowie:[150,210],wojny:[210,270]};
  let h=`<circle cx="${cx}" cy="${cy}" r="${rings.beyond+50}" fill="#0c0f1a" stroke="#1e293b" stroke-width=".5"/>`;
  // Ring circles
  Object.entries(rings).forEach(([k,r])=>{
    const opMap={now:.14,new:.09,next:.06,beyond:.03};
    h+=`<circle cx="${cx}" cy="${cy}" r="${r}" fill="none" stroke="rgba(255,255,255,${opMap[k]})" stroke-width="1" ${k!=='now'?'stroke-dasharray="6 3"':''}/>`;
  });
  // Ring labels
  h+=`<text x="${cx+8}" y="${cy-rings.now-8}" fill="#64748b" font-size="13" font-weight="600" letter-spacing="3">NOW</text>`;
  h+=`<text x="${cx+8}" y="${cy-rings.new-8}" fill="#475569" font-size="13" font-weight="600" letter-spacing="3">NEW 1‚Äì5 lat</text>`;
  h+=`<text x="${cx+8}" y="${cy-rings.next-8}" fill="#334155" font-size="12" letter-spacing="2">NEXT 5‚Äì15 lat</text>`;
  h+=`<text x="${cx+8}" y="${cy-rings.beyond-8}" fill="#1e293b" font-size="12" letter-spacing="2">BEYOND 15+</text>`;
  // Sector dividers
  Object.values(mwSectors).forEach(([start])=>{
    const a=start*Math.PI/180;
    h+=`<line x1="${cx+80*Math.cos(a)}" y1="${cy+80*Math.sin(a)}" x2="${cx+650*Math.cos(a)}" y2="${cy+650*Math.sin(a)}" stroke="#1e293b" stroke-width=".5"/>`;
  });
  // Sector fills + megaworld labels
  Object.entries(mwSectors).forEach(([mwId,[start,end]])=>{
    const mw=MEGAWORLDS[mwId];
    const a1=start*Math.PI/180,a2=end*Math.PI/180;
    const mid=(start+end)/2*Math.PI/180;
    h+=`<path d="M${cx},${cy} L${cx+650*Math.cos(a1)},${cy+650*Math.sin(a1)} A650,650 0 0,1 ${cx+650*Math.cos(a2)},${cy+650*Math.sin(a2)} Z" fill="${mw.color}" opacity=".04"/>`;
    const lx=cx+590*Math.cos(mid),ly=cy+590*Math.sin(mid);
    h+=`<text x="${lx}" y="${ly}" text-anchor="middle" fill="${mw.color}" font-size="12" font-weight="700" opacity=".7">${mw.icon} ${mw.name}</text>`;
  });
  // Build trend positions with collision avoidance
  const trendsByMw={};
  TRENDS.forEach(t=>{if(!trendsByMw[t.mw])trendsByMw[t.mw]={};if(!trendsByMw[t.mw][t.ring])trendsByMw[t.mw][t.ring]=[];trendsByMw[t.mw][t.ring].push(t)});
  // Collision detection for labels
  const placedLabels=[];
  function hasCollision(lx,ly,lw,lh){
    for(const p of placedLabels){
      if(Math.abs(lx-p.x)<(lw+p.w)/2+6 && Math.abs(ly-p.y)<(lh+p.h)/2+2) return true;
    }
    return false;
  }
  // Sort: outer rings first (fewer items, easier to place), then NOW
  const ringOrder=['beyond','next','new','now'];
  const sortedTrends=[...TRENDS].sort((a,b)=>ringOrder.indexOf(a.ring)-ringOrder.indexOf(b.ring));
  // Plot each trend
  sortedTrends.forEach(t=>{
    const sector=mwSectors[t.mw];if(!sector)return;
    const ringTrends=trendsByMw[t.mw]?.[t.ring]||[];
    const idx=ringTrends.indexOf(t);
    const pad=3;
    const spread=sector[1]-sector[0]-pad*2;
    const step=ringTrends.length>1?spread/(ringTrends.length-1):0;
    const baseAngle=sector[0]+pad+(ringTrends.length===1?spread/2:step*idx);
    const r=rings[t.ring];
    // Stagger dots radially for dense rings
    const stagger=ringTrends.length>4?(idx%3-1)*28:ringTrends.length>2?(idx%2===0?16:-16):0;
    const dotR=r+stagger;
    const a=baseAngle*Math.PI/180;
    const dotX=cx+dotR*Math.cos(a),dotY=cy+dotR*Math.sin(a);
    const sz=t.ring==='now'?6:t.ring==='new'?5:t.ring==='next'?4.5:4;
    const op=t.ring==='now'?1:t.ring==='new'?.8:t.ring==='next'?.6:.4;
    const mw=MEGAWORLDS[t.mw];
    const showMw=mwFilter==='all'||mwFilter===t.mw;
    const showFlux=trendFilter==='all'||t.flux.includes(trendFilter);
    const showHr=!hrOnly||t.hr;
    const show=showMw&&showFlux&&showHr;
    // Label: place radially outward, then nudge to avoid collisions
    const labelDist=sz+20+(t.ring==='now'?35:t.ring==='new'?20:10);
    const labelBaseR=dotR+labelDist;
    let lx=cx+labelBaseR*Math.cos(a);
    let ly=cy+labelBaseR*Math.sin(a);
    const isRight=Math.cos(a)>=0;
    const anchor=isRight?'start':'end';
    const estW=t.name.length*7;
    const estH=14;
    // Try nudging: alternate between vertical shifts and radial pushes
    let attempts=0;
    let nudgeY=0,nudgeR=0;
    while(hasCollision(lx+(isRight?estW/2:-estW/2),ly+nudgeY,estW,estH)&&attempts<20){
      if(attempts%3===0)nudgeR+=25;
      else nudgeY+=(attempts%2===0?1:-1)*(Math.floor(attempts/2)+1)*15;
      const nr=labelBaseR+nudgeR;
      lx=cx+nr*Math.cos(a);
      ly=cy+nr*Math.sin(a)+nudgeY;
      attempts++;
    }
    ly+=nudgeY;
    placedLabels.push({x:lx+(isRight?estW/2:-estW/2),y:ly,w:estW,h:estH});
    const fontSize=t.ring==='now'?12:t.ring==='new'?11:10;
    h+=`<g class="cursor-pointer" onclick="showTrendPopup(event,'${t.name.replace(/'/g,"\\'")}')" style="opacity:${show?1:.04};transition:opacity .4s">
      <circle cx="${dotX}" cy="${dotY}" r="${sz}" fill="${mw.color}" opacity="${op}"/>
      ${t.hr?`<circle cx="${dotX}" cy="${dotY}" r="${sz+3}" fill="none" stroke="#eab308" stroke-width="1.5" opacity="${op*.5}"/>`:''}
      <line x1="${dotX}" y1="${dotY}" x2="${lx}" y2="${ly}" stroke="${mw.color}" stroke-width=".6" opacity=".2"/>
      <text x="${lx}" y="${ly+4}" text-anchor="${anchor}" fill="${mw.color}" font-size="${fontSize}" opacity="${Math.min(op+.1,1)}" font-weight="${t.hr?'700':'500'}">${t.name}</text>
    </g>`;
  });
  // Center
  h+=`<circle cx="${cx}" cy="${cy}" r="72" fill="#111827" stroke="#334155"/>`;
  h+=`<text x="${cx}" y="${cy-4}" text-anchor="middle" fill="white" font-size="28" font-weight="900" letter-spacing="5">FLUX</text>`;
  h+=`<text x="${cx}" y="${cy+16}" text-anchor="middle" fill="#64748b" font-size="10" letter-spacing="3">MAPA TREND√ìW 2025</text>`;
  svg.innerHTML=h;
  renderTrendFilters();
}
function renderTrendFilters(){
  const el=document.getElementById('trend-filters');if(!el)return;
  el.innerHTML=`
    <div class="flex flex-wrap gap-2 items-center justify-center mb-2">
      <span class="text-[10px] text-slate-500">FLUX:</span>
      <button onclick="trendFilter='all';renderTrends()" class="tf text-[10px] px-2 py-1 rounded-full border ${trendFilter==='all'?'border-amber-500 text-amber-400':'border-dark-700 text-slate-500'}">Wszystkie</button>
      ${['fast','liquid','unlearn','experiment'].map(a=>`<button onclick="trendFilter='${a}';renderTrends()" class="tf text-[10px] px-2 py-1 rounded-full border ${trendFilter===a?'border-amber-500 '+CC[a].t:'border-dark-700 text-slate-500'}">${FLUX[a].letter}</button>`).join('')}
    </div>
    <div class="flex flex-wrap gap-2 items-center justify-center mb-2">
      <span class="text-[10px] text-slate-500">Mega≈õwiat:</span>
      <button onclick="mwFilter='all';renderTrends()" class="mf text-[10px] px-2 py-1 rounded-full border ${mwFilter==='all'?'border-amber-500 text-amber-400':'border-dark-700 text-slate-500'}">Wszystkie</button>
      ${Object.entries(MEGAWORLDS).map(([id,mw])=>`<button onclick="mwFilter='${id}';renderTrends()" class="mf text-[10px] px-2 py-1 rounded-full border" style="border-color:${mwFilter===id?mw.color:'#334155'};color:${mwFilter===id?mw.color:'#64748b'}">${mw.icon} ${mw.name}</button>`).join('')}
    </div>
    <div class="flex items-center justify-center gap-3 mb-2">
      <label class="flex items-center gap-1 cursor-pointer text-[10px] ${hrOnly?'text-amber-400':'text-slate-500'}">
        <input type="checkbox" ${hrOnly?'checked':''} onchange="hrOnly=this.checked;renderTrends()" class="w-3 h-3 accent-amber-500"> Tylko trendy HR
      </label>
    </div>
    <div class="flex flex-wrap gap-2 items-center justify-center">
      ${Object.entries(MEGAWORLDS).map(([id,mw])=>`<span class="text-[10px] flex items-center gap-1"><span class="w-2 h-2 rounded-full inline-block" style="background:${mw.color}"></span>${mw.name}</span>`).join('')}
      <span class="text-[10px] flex items-center gap-1 ml-2"><span class="w-3 h-3 rounded-full border border-amber-500 inline-block"></span>Trend HR</span>
    </div>`;
}
function showTrendPopup(ev,name){
  ev.stopPropagation();
  document.getElementById('trend-popup')?.remove();
  const t=TRENDS.find(tr=>tr.name===name);if(!t)return;
  const mw=MEGAWORLDS[t.mw];
  const div=document.createElement('div');
  div.id='trend-popup';
  div.className='fixed z-[10002] max-w-sm p-4 bg-dark-900/95 backdrop-blur-md border border-dark-700 rounded-xl shadow-2xl';
  const relScenarios=getTrendScenarios(t.name);
  div.innerHTML=`
    <div class="flex items-center gap-2 mb-2">
      <span class="mw-badge" style="background:${mw.color}20;color:${mw.color}">${mw.icon} ${mw.name}</span>
      <span class="text-[10px] px-2 py-0.5 rounded-full bg-slate-800 text-slate-400">${t.ring.toUpperCase()}</span>
      ${t.hr?'<span class="text-[10px] px-2 py-0.5 rounded-full bg-amber-500/10 text-amber-400">‚ö° Trend HR</span>':''}
    </div>
    <h4 class="text-sm font-bold text-slate-200 mb-1">${t.name}</h4>
    <p class="text-xs text-slate-400 mb-2">${t.desc}</p>
    <p class="text-[10px] text-slate-500 uppercase mb-1">Wp≈Çyw na FLUX</p>
    <div class="flex gap-1 mb-2">${t.flux.map(a=>fluxBadge(a,{clickAction:'detail'})).join('')}</div>
    ${relScenarios.length?`<p class="text-[10px] text-slate-500 uppercase mb-1 mt-2">PowiƒÖzane scenariusze</p>
    <div class="space-y-1 mb-2">${relScenarios.map(s=>`<div class="cross-link" style="background:${C[s.area[0]]}10;color:${C[s.area[0]]}" onclick="document.getElementById('trend-popup')?.remove();nav('explore');filters.area='${s.area[0]}';renderExplore()"><span class="text-[9px]">${FLUX[s.area[0]].letter}</span> ${s.title}</div>`).join('')}</div>`:''}
    <div class="flex gap-2 mt-2">
      <button class="text-xs text-amber-400 hover:underline" onclick="document.getElementById('trend-popup')?.remove();downloadTrend('${t.name.replace(/'/g,"\\'")}')">üì• Pobierz</button>
      <button class="text-xs text-slate-500 hover:text-white" onclick="document.getElementById('trend-popup')?.remove()">Zamknij ‚úï</button>
    </div>`;
  div.style.left=Math.min(ev.clientX,window.innerWidth-350)+'px';
  div.style.top=Math.min(ev.clientY-10,window.innerHeight-250)+'px';
  document.body.appendChild(div);
  setTimeout(()=>{document.addEventListener('click',function h(e){if(!div.contains(e.target)){div.remove();document.removeEventListener('click',h)}})},10);
}
function filterTrends(f){trendFilter=f;renderTrends();}

// ===== RESEARCH VIEW =====
function renderResearch(){
  const list=resFilter==='all'?RESEARCH:RESEARCH.filter(r=>r.area===resFilter);
  document.getElementById('research-grid').innerHTML=list.map(r=>{const c=CC[r.area];return`<div class="bg-dark-900 rounded-xl p-4 border border-dark-700 cursor-pointer" onclick="this.classList.toggle('expanded')"><div class="flex items-center gap-2 mb-1"><span class="text-[10px] px-2 py-0.5 rounded-full ${c.bg} ${c.t}">${FLUX[r.area].name}</span><span class="text-[10px] px-2 py-0.5 rounded-full bg-slate-800 text-slate-400">${r.type}</span><span class="text-[10px] text-slate-600 ml-auto">${r.year}</span></div><h4 class="text-sm font-semibold text-slate-200">${r.title}</h4><p class="text-[11px] text-slate-500">${r.authors}</p><div class="expand-content" style="max-height:0;overflow:hidden;transition:max-height .4s"><div class="mt-2 pt-2 border-t border-dark-700"><p class="text-xs text-slate-400">${r.finding}</p>${r.src?`<a href="${r.src}" target="_blank" class="text-[11px] ${c.t} hover:underline mt-1 inline-block">≈πr√≥d≈Ço ‚Üí</a>`:''}</div></div><p class="text-[10px] text-slate-600 mt-1">Kliknij ‚Üì</p></div>`;}).join('');
  // fix expand
  document.querySelectorAll('#research-grid .expand-content').forEach(el=>{
    el.closest('[onclick]').addEventListener('click',function(){
      const exp=this.querySelector('.expand-content');
      exp.style.maxHeight=exp.style.maxHeight==='0px'||!exp.style.maxHeight?exp.scrollHeight+'px':'0px';
    },{once:false});
  });
}
function filterRes(f){resFilter=f;document.querySelectorAll('.rf').forEach(b=>b.classList.remove('on'));event.target.classList.add('on');renderResearch();}

// ===== TOOLS VIEW =====
function renderTools(){
  const areas=['fast','liquid','unlearn','experiment'];
  document.getElementById('tools-grid').innerHTML=areas.map(a=>{const d=FLUX[a],c=CC[a],t=TOOLS.filter(x=>x.area===a);
    return`<div class="mb-6"><div class="flex items-center gap-2 mb-3"><div class="w-8 h-8 rounded-lg ${c.bg} flex items-center justify-center"><span class="${c.t} font-black">${d.letter}</span></div><span class="${c.t} font-bold">${d.name}</span><span class="text-xs text-slate-600">${t.length} narzƒôdzi</span></div><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">${t.map(x=>{const idx=TOOLS.indexOf(x);return`<div class="bg-dark-900 rounded-xl p-5 border border-dark-700"><span class="text-xs px-2 py-0.5 rounded-full ${c.bg} ${c.t}">${x.type}</span><h4 class="text-sm font-semibold text-slate-200 mt-2 mb-1">${x.name}</h4><p class="text-sm text-slate-400 mb-2">${x.desc}</p><p class="text-xs text-slate-500 border-t border-dark-700 pt-2"><span class="text-slate-400">Kiedy:</span> ${x.use}</p>${isModuleOn('canvases')?`<button onclick="downloadCanvas(${idx})" class="mt-2 text-xs text-amber-400 hover:underline">üì• Pobierz Canvas</button>`:''}</div>`}).join('')}</div></div>`;
  }).join('');
}

// ===== GEMINI CHAT =====
const FLUX_SYSTEM_PROMPT=`Jeste≈õ ekspertem modelu FLUX ‚Äî ramy kompetencyjno-operacyjnej.
FLUX = Fast (tempo decyzji), Liquid (wsp√≥≈Çpraca i PS), Unlearn & Relearn (oduczanie siƒô), eXperiment (innowacje).
Odpowiadaj po polsku, konkretnie, evidence-based. Podawaj przyk≈Çady z bran≈º (automotive, e-commerce, farmacja, ubezpieczenia, OZE, FMCG, start-upy, IT, bankowo≈õƒá, retail).
Model dzia≈Ça zar√≥wno w kontek≈õcie zawodowym (trener, lider, manager, specjalista) jak i prywatnym (mƒÖ≈º, ojciec, zdrowie, hobby, finanse).
Kluczowe badania: Eisenhardt 1989 (fast decisions), Edmondson 1999 (PS), Frazier 2017 (PS meta-analysis), van Dyck 2005 (error management), Brynjolfsson 2023 (GenAI at work).
Narzƒôdzia: Decision 15min, PS Radar, Skill Gap Analyzer, Hypothesis Builder, Learning Loop, Collaboration Flow Map.
BƒÖd≈∫ konkretny, podawaj actionable tips. Nie lej wody.`;

let chatHistory=[];
function toggleChat(){document.getElementById('chat-panel').classList.toggle('open')}
async function sendChat(){
  const input=document.getElementById('chat-input');
  const text=input.value.trim();if(!text)return;
  input.value='';addChatMsg(text,'user');
  const status=document.getElementById('chat-status');
  const btn=document.getElementById('chat-send');
  btn.disabled=true;status.textContent='Analizuje...';

  const apiKey=localStorage.getItem('flux_gemini_key');
  if(!apiKey){addChatMsg('Brak klucza Gemini API. Kliknij ikonƒô ustawie≈Ñ (‚öôÔ∏è) w nawigacji i wpisz klucz z aistudio.google.com (darmowy).','assistant');btn.disabled=false;status.textContent='';return;}

  chatHistory.push({role:'user',parts:[{text}]});
  try{
    const r=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`,{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({system_instruction:{parts:[{text:FLUX_SYSTEM_PROMPT}]},contents:chatHistory,generationConfig:{temperature:0.4,maxOutputTokens:1500}})
    });
    if(!r.ok){const e=await r.text();throw new Error(r.status===429?'Limit API (15/min). Poczekaj.':r.status===403?'Klucz API bez uprawnie≈Ñ.':'B≈ÇƒÖd '+r.status)}
    const d=await r.json();
    const reply=d.candidates?.[0]?.content?.parts?.[0]?.text||'Brak odpowiedzi.';
    chatHistory.push({role:'model',parts:[{text:reply}]});
    addChatMsg(reply,'assistant');
  }catch(e){addChatMsg('B≈ÇƒÖd: '+e.message,'assistant')}
  btn.disabled=false;status.textContent='';
}
function addChatMsg(text,role){
  const div=document.createElement('div');div.className=`chat-msg ${role}`;
  div.innerHTML=role==='assistant'?text.replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>').replace(/\n/g,'<br>'):text;
  document.getElementById('chat-messages').appendChild(div);
  document.getElementById('chat-messages').scrollTop=9999;
}

// ===== SETTINGS =====
function openSettings(){document.getElementById('settings-overlay').classList.add('open');const k=localStorage.getItem('flux_gemini_key');if(k)document.getElementById('api-key-input').value=k}
function closeSettings(){document.getElementById('settings-overlay').classList.remove('open')}
function saveApiKey(){const k=document.getElementById('api-key-input').value.trim();if(!k)return;localStorage.setItem('flux_gemini_key',k);document.getElementById('settings-status').innerHTML='<span class="text-emerald-400">Zapisano!</span>';setTimeout(closeSettings,1000)}
function clearApiKey(){localStorage.removeItem('flux_gemini_key');document.getElementById('api-key-input').value='';document.getElementById('settings-status').innerHTML='<span class="text-slate-400">Wyczyszczono.</span>'}

// ===== MODULE: DIAGNOSTIC + RADAR (#1, #15) =====
const DIAGNOSTIC_QUESTIONS=[
  {area:'fast',q:'Jak szybko Tw√≥j zesp√≥≈Ç przechodzi od identyfikacji problemu do dzia≈Çania?'},
  {area:'fast',q:'Czy masz jasne kryteria "good enough" do podjƒôcia decyzji?'},
  {area:'fast',q:'Jak czƒôsto decyzje sƒÖ blokowane przez oczekiwanie na pe≈Çne dane?'},
  {area:'fast',q:'Czy Tw√≥j zesp√≥≈Ç ma uprawnienia do podejmowania decyzji bez eskalacji?'},
  {area:'liquid',q:'Czy ludzie otwarcie m√≥wiƒÖ o b≈Çƒôdach bez obawy o konsekwencje?'},
  {area:'liquid',q:'Jak sprawnie informacja przep≈Çywa miƒôdzy zespo≈Çami/dzia≈Çami?'},
  {area:'liquid',q:'Czy feedback jest regularny, dwustronny i konstruktywny?'},
  {area:'liquid',q:'Czy spotkania ko≈ÑczƒÖ siƒô konkretnymi action items z w≈Ça≈õcicielami?'},
  {area:'unlearn',q:'Kiedy ostatnio Tw√≥j zesp√≥≈Ç ≈õwiadomie porzuci≈Ç stary proces?'},
  {area:'unlearn',q:'Jak otwarte sƒÖ postawy wobec AI i nowych technologii?'},
  {area:'unlearn',q:'Czy regularnie przeglƒÖdacie i aktualizujecie kompetencje?'},
  {area:'unlearn',q:'Czy organizacja traktuje uczenie siƒô jako proces ciƒÖg≈Çy?'},
  {area:'experiment',q:'Ile eksperyment√≥w przeprowadzili≈õcie w ostatnim kwartale?'},
  {area:'experiment',q:'Czy b≈ÇƒÖd eksperymentu jest traktowany jako ≈∫r√≥d≈Ço danych, nie pora≈ºka?'},
  {area:'experiment',q:'Czy macie bud≈ºet i czas na testowanie nowych pomys≈Ç√≥w?'},
  {area:'experiment',q:'Czy dokumentujecie wyniki eksperyment√≥w systematycznie?'}
];
let diagnosticAnswers={};

function renderDiagnosticView(){
  const el=document.getElementById('diagnostic-content');if(!el)return;
  const saved=localStorage.getItem('flux_diagnostic');
  if(saved&&!window._diagRetake){
    const d=JSON.parse(saved);
    renderDiagnosticResults(d);return;
  }
  const areas=['fast','liquid','unlearn','experiment'];
  el.innerHTML=areas.map(a=>{
    const qs=DIAGNOSTIC_QUESTIONS.filter(q=>q.area===a);const d=FLUX[a],c=CC[a];
    return`<div class="bg-dark-900 rounded-xl p-5 border border-dark-700 mb-4">
      <div class="flex items-center gap-2 mb-3"><div class="w-8 h-8 rounded-lg ${c.bg} flex items-center justify-center"><span class="${c.t} font-black">${d.letter}</span></div><span class="${c.t} font-bold">${d.name}</span></div>
      ${qs.map((q,i)=>{const idx=DIAGNOSTIC_QUESTIONS.indexOf(q);return`<div class="mb-4"><p class="text-sm text-slate-300 mb-2">${i+1}. ${q.q}</p><div class="flex gap-2">${[1,2,3,4,5].map(v=>`<button class="scale-btn ${diagnosticAnswers[idx]===v?'selected':''}" onclick="setDiagAnswer(${idx},${v})">${v}</button>`).join('')}</div></div>`}).join('')}
    </div>`;
  }).join('')+`<div class="text-center"><button onclick="submitDiagnostic()" class="bg-amber-500 hover:bg-amber-400 text-dark-950 font-bold px-8 py-3 rounded-xl text-sm transition-colors">Sprawd≈∫ wyniki</button></div>`;
}

function setDiagAnswer(idx,val){diagnosticAnswers[idx]=val;renderDiagnosticView()}

function submitDiagnostic(){
  if(Object.keys(diagnosticAnswers).length<16){alert('Odpowiedz na wszystkie 16 pyta≈Ñ.');return}
  const scores={};
  ['fast','liquid','unlearn','experiment'].forEach(a=>{
    const qs=DIAGNOSTIC_QUESTIONS.map((q,i)=>({...q,i})).filter(q=>q.area===a);
    scores[a]=+(qs.reduce((s,q)=>s+diagnosticAnswers[q.i],0)/qs.length).toFixed(1);
  });
  const result={timestamp:Date.now(),scores};
  localStorage.setItem('flux_diagnostic',JSON.stringify(result));
  // Save to history
  const hist=JSON.parse(localStorage.getItem('flux_diagnostic_history')||'[]');
  hist.push(result);localStorage.setItem('flux_diagnostic_history',JSON.stringify(hist));
  window._diagRetake=false;diagnosticAnswers={};
  renderDiagnosticResults(result);
}

function renderDiagnosticResults(result){
  const el=document.getElementById('diagnostic-content');const s=result.scores;
  const avg=+((s.fast+s.liquid+s.unlearn+s.experiment)/4).toFixed(1);
  const level=avg>=4?'Zaawansowany':avg>=2.5?'Praktyk':'PoczƒÖtkujƒÖcy';
  const levelColor=avg>=4?'text-emerald-400':avg>=2.5?'text-amber-400':'text-red-400';
  el.innerHTML=`
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <div class="bg-dark-900 rounded-xl p-5 border border-dark-700 text-center">
        <p class="text-xs text-slate-500 mb-1">Tw√≥j poziom FLUX</p>
        <p class="text-2xl font-black ${levelColor}">${level}</p>
        <p class="text-sm text-slate-400 mt-1">≈örednia: ${avg}/5</p>
      </div>
      <div class="bg-dark-900 rounded-xl p-5 border border-dark-700">
        <div class="grid grid-cols-2 gap-3">
          ${['fast','liquid','unlearn','experiment'].map(a=>`<div class="text-center"><span class="${CC[a].t} font-black text-lg">${s[a]}</span><p class="text-xs text-slate-500">${FLUX[a].name}</p></div>`).join('')}
        </div>
      </div>
    </div>
    ${isModuleOn('radar')?`<div class="bg-dark-900 rounded-xl p-5 border border-dark-700 mb-6"><p class="text-xs text-slate-500 mb-3 text-center">Profil FLUX ‚Äî Radar Chart</p><div class="flex justify-center"><svg viewBox="0 0 400 400" class="radar-svg" style="max-width:350px;width:100%">${renderRadarChart(s)}</svg></div></div>`:''}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">${['fast','liquid','unlearn','experiment'].map(a=>{
      const v=s[a],bar=v/5*100,c=CC[a];
      return`<div class="bg-dark-900 rounded-xl p-4 border border-dark-700"><div class="flex justify-between items-center mb-2"><span class="${c.t} font-bold text-sm">${FLUX[a].name}</span><span class="${c.t} font-bold">${v}/5</span></div><div class="w-full h-2 bg-dark-700 rounded-full"><div class="h-full rounded-full" style="width:${bar}%;background:${C[a]}"></div></div><p class="text-xs text-slate-500 mt-1">${v>=4?'Mocna strona ‚Äî utrzymuj!':v>=2.5?'Dobra baza ‚Äî rozwijaj':'Priorytet do rozwoju'}</p></div>`;
    }).join('')}</div>
    <div class="text-center"><button onclick="window._diagRetake=true;diagnosticAnswers={};renderDiagnosticView()" class="text-sm text-amber-400 hover:underline">Wykonaj ponownie</button></div>`;
}

function renderRadarChart(scores){
  const cx=200,cy=200,maxR=150,areas=['fast','liquid','unlearn','experiment'];
  const angles=areas.map((_,i)=>-Math.PI/2+i*(2*Math.PI/4));
  let h='';
  // Grid rings
  [1,2,3,4,5].forEach(l=>{const r=maxR*l/5;
    h+=`<polygon points="${angles.map(a=>`${cx+r*Math.cos(a)},${cy+r*Math.sin(a)}`).join(' ')}" fill="none" stroke="#1e293b" stroke-width="1"/>`;
    if(l%2===1)h+=`<text x="${cx+4}" y="${cy-r+4}" fill="#334155" font-size="9">${l}</text>`;
  });
  // Axis lines + labels
  areas.forEach((a,i)=>{const ang=angles[i];
    h+=`<line x1="${cx}" y1="${cy}" x2="${cx+maxR*Math.cos(ang)}" y2="${cy+maxR*Math.sin(ang)}" stroke="#1e293b" stroke-width="1"/>`;
    const lx=cx+(maxR+25)*Math.cos(ang),ly=cy+(maxR+25)*Math.sin(ang);
    h+=`<text x="${lx}" y="${ly}" text-anchor="middle" fill="${C[a]}" font-size="12" font-weight="700">${FLUX[a].letter}</text>`;
  });
  // Score polygon
  const pts=areas.map((a,i)=>{const r=maxR*scores[a]/5;return`${cx+r*Math.cos(angles[i])},${cy+r*Math.sin(angles[i])}`}).join(' ');
  h+=`<polygon points="${pts}" fill="rgba(245,158,11,.15)" stroke="#f59e0b" stroke-width="2"/>`;
  // Score dots
  areas.forEach((a,i)=>{const r=maxR*scores[a]/5;
    h+=`<circle cx="${cx+r*Math.cos(angles[i])}" cy="${cy+r*Math.sin(angles[i])}" r="5" fill="${C[a]}" stroke="#0c0f1a" stroke-width="2"/>`;
  });
  return h;
}

// ===== MODULE: ONBOARDING (#11) =====
let onboardingStep=0;
const ONBOARDING_ROLES=['Manager','Team Lead','Specjalista','Handlowiec','HR','Trener','Founder','Agent'];
const ONBOARDING_INDUSTRIES=['Automotive','E-commerce','Farmacja','Ubezpieczenia','OZE','FMCG','Start-up','IT','Bankowo≈õƒá','Retail'];
const ONBOARDING_CHALLENGES=['Szybko≈õƒá decyzji','Wsp√≥≈Çpraca w zespole','Adaptacja do zmian','Innowacyjno≈õƒá','Komunikacja','Budowanie zaufania'];

function showOnboarding(){onboardingStep=0;document.getElementById('onboarding-overlay').classList.add('open');renderOnboardingStep()}
function closeOnboarding(){document.getElementById('onboarding-overlay').classList.remove('open')}

function renderOnboardingStep(){
  const el=document.getElementById('onboarding-content');
  const steps=[
    {title:'Kim jeste≈õ?',desc:'Wybierz swojƒÖ rolƒô:',items:ONBOARDING_ROLES,key:'role'},
    {title:'Twoja bran≈ºa?',desc:'Wybierz bran≈ºƒô:',items:ONBOARDING_INDUSTRIES,key:'industry'},
    {title:'Twoje wyzwanie?',desc:'Co jest najwa≈ºniejsze?',items:ONBOARDING_CHALLENGES,key:'challenge'}
  ];
  const s=steps[onboardingStep];
  el.innerHTML=`
    <div class="flex justify-center gap-2 mb-4">${steps.map((_,i)=>`<div class="w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ${i===onboardingStep?'bg-amber-500 text-dark-950':i<onboardingStep?'bg-emerald-500/20 text-emerald-400':'bg-dark-700 text-slate-500'}">${i+1}</div>`).join('')}</div>
    <h3 class="text-lg font-bold text-slate-200 text-center mb-1">${s.title}</h3>
    <p class="text-sm text-slate-400 text-center mb-4">${s.desc}</p>
    <div class="grid grid-cols-2 gap-2">${s.items.map(item=>`<button onclick="selectOnboarding('${s.key}','${item}')" class="bg-dark-950 border border-dark-700 rounded-lg py-3 px-4 text-sm text-slate-300 hover:border-amber-500 hover:text-amber-400 transition-all">${item}</button>`).join('')}</div>
    ${onboardingStep>0?'<button onclick="onboardingStep--;renderOnboardingStep()" class="text-xs text-slate-500 hover:text-white mt-3 block mx-auto">‚Üê Wstecz</button>':''}`;
}

function selectOnboarding(key,val){
  const profile=JSON.parse(localStorage.getItem('flux_profile')||'{}');
  profile[key]=val;localStorage.setItem('flux_profile',JSON.stringify(profile));
  if(onboardingStep<2){onboardingStep++;renderOnboardingStep()}
  else finishOnboarding(profile);
}

function finishOnboarding(profile){
  closeOnboarding();
  const challengeMap={'Szybko≈õƒá decyzji':'fast','Wsp√≥≈Çpraca w zespole':'liquid','Adaptacja do zmian':'unlearn','Innowacyjno≈õƒá':'experiment','Komunikacja':'liquid','Budowanie zaufania':'liquid'};
  const area=challengeMap[profile.challenge]||'fast';
  if(isModuleOn('diagnostic'))nav('diagnostic');else showDetail(area);
}

// ===== MODULE: PROGRESS (#13) =====
function getProgress(){try{return JSON.parse(localStorage.getItem('flux_progress')||'{"viewed":[],"bookmarks":[],"reflections":[],"exercises":0}')}catch(e){return{viewed:[],bookmarks:[],reflections:[],exercises:0}}}
function saveProgress(p){localStorage.setItem('flux_progress',JSON.stringify(p))}

function trackViewVisit(v){
  if(!isModuleOn('progress'))return;
  const p=getProgress();if(!p.viewed.includes(v)){p.viewed.push(v);saveProgress(p)}updateProgressBar();
}

function updateProgressBar(){
  if(!isModuleOn('progress'))return;
  const p=getProgress();
  const totalViews=5+MODULES.filter(m=>m.nav&&isModuleOn(m.id)).length;
  const pct=Math.min(100,Math.round(p.viewed.length/totalViews*40+p.reflections.length*10+p.exercises*5+p.bookmarks.length*3));
  document.getElementById('progress-fill').style.width=pct+'%';
}

function toggleBookmark(title){
  if(!isModuleOn('progress'))return;
  const p=getProgress();const i=p.bookmarks.indexOf(title);
  if(i===-1)p.bookmarks.push(title);else p.bookmarks.splice(i,1);
  saveProgress(p);updateProgressBar();
}

// ===== MODULE: REFLECTION (#12) =====
function openReflection(){document.getElementById('reflection-overlay').classList.add('open')}
function closeReflection(){document.getElementById('reflection-overlay').classList.remove('open')}
function saveReflection(){
  const r3=document.getElementById('refl-3').value,r2=document.getElementById('refl-2').value,r1=document.getElementById('refl-1').value;
  if(!r3&&!r2&&!r1){return}
  const p=getProgress();p.reflections.push({ts:Date.now(),three:r3,two:r2,one:r1});saveProgress(p);
  document.getElementById('refl-status').innerHTML='<span class="text-emerald-400">Zapisano refleksjƒô!</span>';
  updateProgressBar();setTimeout(closeReflection,1500);
}
function saveAndAskAI(){
  saveReflection();
  const r3=document.getElementById('refl-3').value,r2=document.getElementById('refl-2').value;
  if(r2){document.getElementById('chat-input').value=r2;toggleChat();setTimeout(sendChat,500)}
}

// ===== MODULE: ACTION PLAN (#2) =====
function getActions(){try{return JSON.parse(localStorage.getItem('flux_actions')||'[]')}catch(e){return[]}}
function saveActions(a){localStorage.setItem('flux_actions',JSON.stringify(a))}

function renderActionPlanView(){
  const el=document.getElementById('actionplan-content');if(!el)return;
  const actions=getActions();
  el.innerHTML=`
    <div class="bg-dark-900 rounded-xl p-5 border border-dark-700 mb-4">
      <h3 class="text-sm font-bold text-slate-300 mb-3">Dodaj nowe dzia≈Çanie</h3>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-3">
        <input id="ap-action" placeholder="Dzia≈Çanie..." class="bg-dark-950 border border-dark-700 rounded-lg px-3 py-2 text-sm text-slate-200 outline-none focus:border-amber-500">
        <input id="ap-deadline" type="date" class="bg-dark-950 border border-dark-700 rounded-lg px-3 py-2 text-sm text-slate-200 outline-none focus:border-amber-500">
        <input id="ap-metric" placeholder="Metryka sukcesu..." class="bg-dark-950 border border-dark-700 rounded-lg px-3 py-2 text-sm text-slate-200 outline-none focus:border-amber-500">
      </div>
      <button onclick="addAction()" class="bg-amber-500 hover:bg-amber-400 text-dark-950 font-bold px-6 py-2 rounded-lg text-sm">Dodaj</button>
    </div>
    ${actions.length?`<div class="bg-dark-900 rounded-xl border border-dark-700 overflow-hidden">
      <table class="w-full text-sm"><thead><tr class="border-b border-dark-700"><th class="text-left p-3 text-slate-500 text-xs">Dzia≈Çanie</th><th class="text-left p-3 text-slate-500 text-xs">Deadline</th><th class="text-left p-3 text-slate-500 text-xs">Metryka</th><th class="p-3 text-slate-500 text-xs">Status</th><th class="p-3"></th></tr></thead>
      <tbody>${actions.map((a,i)=>`<tr class="border-b border-dark-700/50 ${a.done?'opacity-50':''}"><td class="p-3 text-slate-300 ${a.done?'line-through':''}">${a.action}</td><td class="p-3 text-slate-400">${a.deadline||'‚Äî'}</td><td class="p-3 text-slate-400">${a.metric||'‚Äî'}</td><td class="p-3 text-center"><button onclick="toggleAction(${i})" class="text-lg">${a.done?'‚úÖ':'‚¨ú'}</button></td><td class="p-3 text-center"><button onclick="removeAction(${i})" class="text-red-400 hover:text-red-300 text-xs">‚úï</button></td></tr>`).join('')}</tbody></table>
    </div>
    <div class="text-center mt-4"><button onclick="exportActions()" class="text-xs text-amber-400 hover:underline">Eksportuj do .txt</button></div>`:`<div class="text-center py-8 text-slate-500 text-sm">Brak dzia≈Ça≈Ñ. Dodaj pierwsze powy≈ºej.</div>`}`;
}

function addAction(){
  const action=document.getElementById('ap-action').value.trim();if(!action)return;
  const deadline=document.getElementById('ap-deadline').value;
  const metric=document.getElementById('ap-metric').value.trim();
  const actions=getActions();actions.push({action,deadline,metric,done:false});saveActions(actions);renderActionPlanView();
}
function toggleAction(i){const a=getActions();a[i].done=!a[i].done;saveActions(a);renderActionPlanView()}
function removeAction(i){const a=getActions();a.splice(i,1);saveActions(a);renderActionPlanView()}
function exportActions(){
  const a=getActions();const txt=a.map((x,i)=>`${x.done?'[‚úì]':'[ ]'} ${x.action} | ${x.deadline||'brak'} | ${x.metric||'brak'}`).join('\n');
  const blob=new Blob(['FLUX Action Plan\n'+new Date().toLocaleDateString('pl')+'\n\n'+txt],{type:'text/plain'});
  const url=URL.createObjectURL(blob);const a2=document.createElement('a');a2.href=url;a2.download='flux-action-plan.txt';a2.click();URL.revokeObjectURL(url);
}

// ===== MODULE: TRAINER DASHBOARD (#3) =====
function renderTrainerView(){
  const el=document.getElementById('trainer-content');if(!el)return;
  const url=window.location.href;
  const hist=JSON.parse(localStorage.getItem('flux_diagnostic_history')||'[]');
  el.innerHTML=`
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <div class="bg-dark-900 rounded-xl p-5 border border-dark-700 text-center">
        <p class="text-xs text-slate-500 mb-3">QR Code ‚Äî udostƒôpnij uczestnikom</p>
        <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(url)}&bgcolor=111827&color=f59e0b" alt="QR" class="mx-auto rounded-lg" style="max-width:200px">
        <p class="text-xs text-slate-400 mt-2 break-all">${url}</p>
      </div>
      <div class="bg-dark-900 rounded-xl p-5 border border-dark-700">
        <p class="text-xs text-slate-500 mb-3">Statystyki diagnostyk</p>
        <div class="text-center">
          <span class="text-3xl font-black text-amber-400">${hist.length}</span>
          <p class="text-sm text-slate-400">wype≈Çnionych diagnostyk</p>
        </div>
        ${hist.length?`<div class="mt-4 space-y-2">${['fast','liquid','unlearn','experiment'].map(a=>{
          const avg=+(hist.reduce((s,h)=>s+h.scores[a],0)/hist.length).toFixed(1);
          return`<div class="flex items-center gap-2"><span class="${CC[a].t} font-bold text-xs w-8">${FLUX[a].letter}</span><div class="flex-1 h-2 bg-dark-700 rounded-full"><div class="h-full rounded-full" style="width:${avg/5*100}%;background:${C[a]}"></div></div><span class="text-xs text-slate-400 w-8">${avg}</span></div>`;
        }).join('')}</div>`:'<p class="text-xs text-slate-500 mt-4 text-center">Brak danych ‚Äî popro≈õ uczestnik√≥w o wype≈Çnienie diagnostyki.</p>'}
      </div>
    </div>
    <div class="text-center"><button onclick="exportTrainerReport()" class="bg-violet-600 hover:bg-violet-500 text-white font-bold px-6 py-2 rounded-lg text-sm">Eksportuj raport HTML</button></div>`;
}

function exportTrainerReport(){
  const hist=JSON.parse(localStorage.getItem('flux_diagnostic_history')||'[]');
  const areas=['fast','liquid','unlearn','experiment'];
  const avgs=areas.map(a=>+(hist.reduce((s,h)=>s+h.scores[a],0)/Math.max(1,hist.length)).toFixed(1));
  const html=`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>FLUX Trainer Report</title><style>body{font-family:Inter,sans-serif;max-width:800px;margin:auto;padding:2rem;background:#0c0f1a;color:#e2e8f0}h1{color:#f59e0b}.bar{height:1.5rem;border-radius:.5rem;margin:.5rem 0}</style></head><body><h1>FLUX Trainer Report</h1><p>Data: ${new Date().toLocaleDateString('pl')}</p><p>Diagnostyk: ${hist.length}</p><h2>≈örednie wyniki</h2>${areas.map((a,i)=>`<p><strong style="color:${C[a]}">${FLUX[a].name}</strong>: ${avgs[i]}/5</p><div class="bar" style="width:${avgs[i]/5*100}%;background:${C[a]}"></div>`).join('')}</body></html>`;
  const blob=new Blob([html],{type:'text/html'});
  const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='flux-trainer-report.html';a.click();URL.revokeObjectURL(url);
}

// ===== MODULE: CASE STUDIES (#4) =====
const CASE_STUDIES={
  'Decyzja cenowa pod presjƒÖ':{situation:'Kierownik sprzeda≈ºy automotive dostaje alert: konkurencja obni≈ºy≈Ça cenƒô o 12%.',context:'Q4, cele roczne niezrealizowane w 85%, centralny pricing wymaga 48h na zmianƒô.',action:'U≈ºy≈Ç Decyzji 15 min: zidentyfikowa≈Ç 3 opcje (rabat, pakiet, warto≈õƒá dodana), wybra≈Ç pakiet z serwisem VIP w 2h.',result:'ZamknƒÖ≈Ç deal w 24h, mar≈ºa -3% ale retencja klienta +100%. Centrala zatwierdzi≈Ça post-factum.',debrief:['Co by siƒô sta≈Ço gdyby czeka≈Ç na centralƒô?','Jakie "good enough" kryteria zastosowa≈Ç?','Jak udokumentowaƒá tƒô decyzjƒô dla przysz≈Çych case\'√≥w?']},
  'Bezpiecze≈Ñstwo psychologiczne w IT':{situation:'Junior developer odkry≈Ç krytyczny bug w kodzie tech leada, ale boi siƒô zg≈Çosiƒá.',context:'Ostatni dev kt√≥ry zg≈Çosi≈Ç problem dosta≈Ç publicznƒÖ krytykƒô na standup. Zesp√≥≈Ç 12 os√≥b.',action:'Wdro≈ºono PS Radar (anonimowy). Wynik: 2.1/5. Team lead przeszed≈Ç coaching na feedbacku. Wprowadzono "Bug Bounty wewnƒôtrzny".',result:'PS wzros≈Ço do 3.8/5 po kwartale. Liczba zg≈Çoszonych bug√≥w x3. Time-to-fix spad≈Ç o 40%.',debrief:['Dlaczego anonimowo≈õƒá by≈Ça kluczowa w pierwszym kroku?','Jak mierzyƒá PS bez ankiet?','Co zmieniƒá je≈õli lider nie chce coachingu?']},
  'Wdro≈ºenie AI w zespole sprzeda≈ºy':{situation:'Handlowcy FMCG (30 os√≥b) bojƒÖ siƒô AI ‚Äî "zastƒÖpi nas", "to zabawka".',context:'Firma kupi≈Ça licencje ChatGPT Enterprise. Po miesiƒÖcu: 3 osoby u≈ºywajƒÖ, reszta ignoruje.',action:'AI Prompt Pack: 5 gotowych prompt√≥w (podsumowanie spotkania, follow-up mail, analiza CRM). Warsztat 2h: pokaz live efektu WOW.',result:'Adopcja po 6 tyg: 73%. ≈öredni czas na follow-up z 24h do 2h. NPS wewnƒôtrzny szkolenia: 9.2.',debrief:['Dlaczego "poka≈º, nie m√≥w" zadzia≈Ça≈Ço lepiej?','Jak dobraƒá prompty do konkretnej roli?','Co z osobami kt√≥re nadal nie adoptujƒÖ?']},
  'Test nowego formatu szkolenia':{situation:'Trener testuje 4√ó2h online vs 1√ó8h offline ‚Äî kt√≥ry format lepszy?',context:'Bud≈ºet na 2 grupy pilota≈ºowe. Temat: komunikacja w zespole. Grupy po 16 os√≥b.',action:'Hypothesis Builder: "4√ó2h ‚Üí NPS>8 i retencja wiedzy po 30d >60%". Pre/post test. Dziennik stosowania.',result:'4√ó2h: NPS 8.4, retencja 67%. 8h offline: NPS 7.9, retencja 52%. Ale engagement offline wy≈ºszy.',debrief:['Czy NPS to wystarczajƒÖca metryka?','Jak zmierzyƒá transfer do praktyki?','Jakie inne formaty warto testowaƒá?']}
};

// ===== MODULE: EVIDENCE MAP (#5) =====
const EVIDENCE_MAP={
  'Decyzja cenowa pod presjƒÖ':{research:0,tier:2},
  'Priorytety backlogu w sprincie':{research:1,tier:2},
  'Bezpiecze≈Ñstwo psychologiczne w IT':{research:3,tier:1},
  'Feedback miƒôdzy agentami':{research:4,tier:1},
  'Trudna rozmowa z partnerem':{research:4,tier:1},
  'Wdro≈ºenie AI w zespole sprzeda≈ºy':{research:8,tier:1},
  'Test nowego formatu szkolenia':{research:10,tier:2},
  'Stare nawyki ≈ºywieniowe':{research:9,tier:1}
};
const EVIDENCE_TIERS={1:'‚òÖ‚òÖ‚òÖ Meta-analiza',2:'‚òÖ‚òÖ Empiryczne',3:'‚òÖ Eksperckie'};

// ===== MODULE: FRAMEWORKS (#7) =====
const FRAMEWORKS={
  'NVC':{name:'Nonviolent Communication',steps:['Obserwacja (fakty, nie oceny)','Uczucia (co czujƒô?)','Potrzeby (czego potrzebujƒô?)','Pro≈õba (konkretna, wykonalna)'],contexts:['husband','father','professional','leader']},
  'STOP':{name:'STOP ‚Üí THINK ‚Üí ACT',steps:['STOP ‚Äî zatrzymaj automatycznƒÖ reakcjƒô','THINK ‚Äî jaki jest m√≥j cel? jakie opcje?','ACT ‚Äî wybierz najlepszƒÖ opcjƒô i dzia≈Çaj'],contexts:['fast','crisis','health','father']},
  'Atomic':{name:'Atomic Habits (Clear)',steps:['1% lepiej codziennie','Stack na istniejƒÖcym nawyku','≈örodowisko > motywacja','To≈ºsamo≈õƒá > wyniki'],contexts:['health','finance','learner','hobby']},
  '52Notatki':{name:'52 Notatki (Gerschmann)',steps:['Systematyczno≈õƒá > kwota','Automatyczny przelew co miesiƒÖc','3 s≈Çoiki: bezpiecze≈Ñstwo/wzrost/wolno≈õƒá','Edukacja finansowa co tydzie≈Ñ'],contexts:['finance']}
};

// ===== MODULE: EXERCISES (#8) =====
const EXERCISES=[
  {id:'eq1',area:'fast',type:'quiz',q:'Zesp√≥≈Ç czeka na pe≈Çne dane od 3 tygodni. Co robisz?',opts:['Czekam dalej ‚Äî dane sƒÖ kluczowe','Podejmujƒô decyzjƒô z tym co mam','Organizujƒô jeszcze jedno spotkanie','Delegujƒô decyzjƒô w g√≥rƒô'],correct:1,feedback:'Decyzja z 80% danych > perfekcyjna za 3 tygodnie. Eisenhardt 1989: szybkie zespo≈Çy zbierajƒÖ WIƒòCEJ info ale decydujƒÖ SZYBCIEJ.'},
  {id:'eq2',area:'fast',type:'quiz',q:'Jaki jest najwiƒôkszy wr√≥g szybkich decyzji?',opts:['Brak danych','Parali≈º analityczny','Z≈Çy lider','Brak bud≈ºetu'],correct:1,feedback:'Parali≈º analityczny ‚Äî czekanie na "idealne" dane. FAST = good enough + action + learn.'},
  {id:'lq1',area:'liquid',type:'quiz',q:'Co jest fundamentem Psychological Safety wg Edmondson?',opts:['Brak konflikt√≥w','Prawo do b≈Çƒôdu bez konsekwencji','Mi≈Çe relacje w zespole','Anonimowo≈õƒá feedbacku'],correct:1,feedback:'PS = ludzie czujƒÖ siƒô bezpiecznie podejmujƒÖc ryzyko interpersonalne. Nie chodzi o "bycie mi≈Çym" ale o prawo do b≈Çƒôdu.'},
  {id:'lq2',area:'liquid',type:'quiz',q:'Jak najszybciej poprawiƒá przep≈Çyw wiedzy w zespole?',opts:['Wiƒôcej spotka≈Ñ','Collaboration Flow Map','Nowe narzƒôdzie IT','Zmiana lidera'],correct:1,feedback:'Collaboration Flow Map identyfikuje bottlenecki. Narzƒôdzie IT bez mapy proces√≥w = chaos z nowym narzƒôdziem.'},
  {id:'uq1',area:'unlearn',type:'quiz',q:'Co oznacza "unlearn" w kontek≈õcie FLUX?',opts:['Zapomnieƒá wszystko','≈öwiadomie porzuciƒá przestarza≈Çe modele','Uczyƒá siƒô od nowa','Ignorowaƒá do≈õwiadczenie'],correct:1,feedback:'Unlearn = ≈õwiadome porzucanie. Nie "zapomnieƒá" ale "zdecydowaƒá ≈ºe X ju≈º nie dzia≈Ça i wybraƒá Y".'},
  {id:'uq2',area:'unlearn',type:'quiz',q:'Brynjolfsson 2023 (NBER) ‚Äî kto zyska≈Ç NAJWIƒòCEJ na AI?',opts:['Eksperci','PoczƒÖtkujƒÖcy pracownicy','Managerowie','Programi≈õci'],correct:1,feedback:'+14% produktywno≈õƒá, ale NAJWIƒòKSZY zysk dla najmniej do≈õwiadczonych. AI = equalizer.'},
  {id:'xq1',area:'experiment',type:'quiz',q:'Co jest kluczowe w kulturze eksperyment√≥w?',opts:['Du≈ºy bud≈ºet na R&D','Traktowanie b≈Çƒôdu jako ≈∫r√≥d≈Ça danych','Zatrudnienie innowator√≥w','Osobny dzia≈Ç innowacji'],correct:1,feedback:'van Dyck 2005: kultura zarzƒÖdzania b≈Çƒôdami (nie unikania!) ‚Üí lepsza wydajno≈õƒá. B≈ÇƒÖd = data point.'},
  {id:'xq2',area:'experiment',type:'quiz',q:'Jak poprawnie sformu≈Çowaƒá hipotezƒô eksperymentu?',opts:['"Sprawdzimy nowy proces"','"Je≈õli X to Y poniewa≈º Z"','"Zrobimy pilot i zobaczymy"','"Nowy spos√≥b bƒôdzie lepszy"'],correct:1,feedback:'Hypothesis Builder: Je≈õli [interwencja] to [wynik] poniewa≈º [mechanizm]. Metryka + timeline.'}
];

function renderExercise(exId){
  const ex=EXERCISES.find(e=>e.id===exId);if(!ex)return'';
  const c=CC[ex.area];
  return`<div class="bg-dark-900 rounded-xl p-5 border border-dark-700 mb-3" id="ex-${ex.id}">
    <div class="flex items-center gap-2 mb-3"><span class="text-sm px-2 py-0.5 rounded-full ${c.bg} ${c.t} font-bold">${FLUX[ex.area].letter}</span><span class="text-xs text-slate-500">Quiz</span></div>
    <p class="text-sm font-medium text-slate-200 mb-3">${ex.q}</p>
    <div class="space-y-2">${ex.opts.map((o,i)=>`<button onclick="checkExercise('${ex.id}',${i})" class="ex-opt w-full text-left bg-dark-950 border border-dark-700 rounded-lg px-4 py-2.5 text-sm text-slate-300 hover:border-amber-500 transition-all">${o}</button>`).join('')}</div>
    <div id="ex-feedback-${ex.id}" class="hidden mt-3 p-3 rounded-lg text-sm"></div></div>`;
}

function checkExercise(exId,chosen){
  const ex=EXERCISES.find(e=>e.id===exId);if(!ex)return;
  const fb=document.getElementById('ex-feedback-'+exId);
  const correct=chosen===ex.correct;
  fb.className='mt-3 p-3 rounded-lg text-sm '+(correct?'bg-emerald-500/10 text-emerald-400 border border-emerald-500/20':'bg-red-500/10 text-red-400 border border-red-500/20');
  fb.innerHTML=(correct?'‚úì Dok≈Çadnie! ':'‚úï Nie tym razem. ')+ex.feedback;
  // Highlight correct
  const btns=document.querySelectorAll(`#ex-${exId} .ex-opt`);
  btns.forEach((b,i)=>{b.disabled=true;if(i===ex.correct)b.classList.add('border-emerald-500','text-emerald-400');else if(i===chosen&&!correct)b.classList.add('border-red-500','text-red-400')});
  if(isModuleOn('progress')){const p=getProgress();p.exercises=(p.exercises||0)+1;saveProgress(p);updateProgressBar()}
}

// ===== MODULE: ANTIPATTERNS DETECTOR (#6) =====
function updateAntiDetector(area){
  const checks=document.querySelectorAll(`#detail-content input[type="checkbox"]`);
  const checked=Array.from(checks).filter(c=>c.checked).length;
  const rec=document.getElementById('anti-recommendations');if(!rec)return;
  if(checked===0){rec.innerHTML='';return}
  const tools=TOOLS.filter(t=>t.area===area);
  rec.innerHTML=`<div class="bg-amber-500/10 border border-amber-500/20 rounded-lg p-3 mt-3"><p class="text-sm text-amber-400 font-medium">${checked}/${checks.length} antywzorc√≥w zaznaczonych</p><p class="text-xs text-slate-400 mt-1">Rekomendowane narzƒôdzia:</p><div class="flex flex-wrap gap-1 mt-2">${tools.slice(0,3).map(t=>`<span class="text-xs px-2 py-1 rounded-full bg-dark-950 text-amber-400 border border-amber-500/20">${t.name}</span>`).join('')}</div></div>`;
}

// ===== MODULE: CANVASES (#9) =====
function downloadCanvas(toolIdx){
  const t=TOOLS[toolIdx];if(!t)return;
  const html=`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>${t.name} ‚Äî FLUX Canvas</title>
<style>*{font-family:Inter,sans-serif;box-sizing:border-box}body{max-width:800px;margin:auto;padding:2rem}h1{color:#f59e0b;border-bottom:3px solid #f59e0b;padding-bottom:.5rem}
.field{border:2px solid #e2e8f0;border-radius:8px;padding:1.5rem;margin:1rem 0;min-height:120px}.label{font-weight:700;margin-bottom:.5rem;color:#334155}
@media print{body{padding:1cm}.field{page-break-inside:avoid}}</style></head>
<body><h1>${t.name}</h1><p style="color:#64748b">${t.type} ‚Äî Model FLUX / ${FLUX[t.area].name}</p>
<div class="field"><div class="label">Opis</div><p>${t.desc}</p></div>
<div class="field"><div class="label">Kiedy stosowaƒá</div><p>${t.use}</p></div>
<div class="field"><div class="label">Notatki / Obserwacje</div><p style="color:#94a3b8;font-style:italic">Twoje notatki...</p></div>
<div class="field"><div class="label">Action Items</div><p style="color:#94a3b8;font-style:italic">1.<br>2.<br>3.</p></div>
<p style="color:#94a3b8;font-size:12px;margin-top:2rem">Wygenerowano z FLUX App | ${new Date().toLocaleDateString('pl')}</p></body></html>`;
  const blob=new Blob([html],{type:'text/html'});
  const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=t.name.toLowerCase().replace(/\s+/g,'-')+'-canvas.html';a.click();URL.revokeObjectURL(url);
}

// ===== GLOBAL SEARCH / CHALLENGE FINDER =====
const SEARCH_SYNONYMS={
  'komunikacja':['feedback','rozmowa','dialog','informacja','przep≈Çyw','spotkanie','silos'],
  'decyzja':['decyzyjny','szybko≈õƒá','tempo','priorytet','wyb√≥r','analiza'],
  'zaufanie':['bezpiecze≈Ñstwo psychologiczne','ps','psychological safety','otwarto≈õƒá','relacja','strach'],
  'zmiana':['adaptacja','transformacja','wdro≈ºenie','nowy','przystosowanie','elastyczno≈õƒá'],
  'ai':['sztuczna inteligencja','automatyzacja','chatgpt','algorytm','robot','technologia','digital'],
  'wypalenie':['stres','burnout','zmƒôczenie','obciƒÖ≈ºenie','produktywno≈õƒá','praca','overload','kryzys'],
  'innowacja':['eksperyment','test','pilot','mvp','nowy pomys≈Ç','kreatywno≈õƒá','prototyp'],
  'konflikt':['polaryzacja','napiƒôcie','sp√≥r','nieporozumienie','r√≥≈ºnice','pokolenie'],
  'kompetencje':['skill','umiejƒôtno≈õƒá','reskilling','upskilling','uczenie','nauka','rozw√≥j','gap'],
  'lider':['manager','kierownik','przyw√≥dztwo','zarzƒÖdzanie','zesp√≥≈Ç','delegowanie']
};

function openSearch(){
  document.getElementById('search-overlay').classList.add('open');
  const inp=document.getElementById('search-input');
  inp.value='';inp.focus();
  document.getElementById('search-results').innerHTML='<div class="text-center py-8 text-slate-500 text-sm">Wpisz wyzwanie lub problem ‚Äî poka≈ºemy adekwatne trendy, scenariusze i narzƒôdzia.</div>';
}
function closeSearch(){document.getElementById('search-overlay').classList.remove('open')}
function quickSearch(q){document.getElementById('search-input').value=q;performSearch(q)}

function performSearch(query){
  const el=document.getElementById('search-results');
  if(!query||query.length<2){el.innerHTML='<div class="text-center py-8 text-slate-500 text-sm">Wpisz wyzwanie lub problem ‚Äî poka≈ºemy adekwatne trendy, scenariusze i narzƒôdzia.</div>';return}
  const q=query.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'');
  const words=q.split(/\s+/).filter(w=>w.length>1);
  // Expand synonyms
  const expanded=new Set(words);
  words.forEach(w=>{
    Object.entries(SEARCH_SYNONYMS).forEach(([key,syns])=>{
      if(key.includes(w)||w.includes(key)||syns.some(s=>s.includes(w)||w.includes(s))){
        expanded.add(key);syns.forEach(s=>expanded.add(s));
      }
    });
  });
  const allTerms=[...expanded];

  function scoreText(text){
    if(!text)return 0;
    const t=text.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'');
    let score=0;
    allTerms.forEach(term=>{
      if(t.includes(term))score+=term.length>3?3:1;
      // Bonus for exact word match
      if(t.split(/\s+/).includes(term))score+=2;
    });
    // Original words get extra weight
    words.forEach(w=>{if(t.includes(w))score+=4});
    return score;
  }

  // Score trends
  const trendResults=TRENDS.map(t=>{
    let s=scoreText(t.name)*3+scoreText(t.desc)*2;
    // Boost by flux area match
    t.flux.forEach(f=>{s+=scoreText(FLUX[f].name)+scoreText(FLUX[f].full)});
    // Boost HR trends
    if(t.hr)s+=1;
    const mw=MEGAWORLDS[t.mw];
    s+=scoreText(mw.name);
    return{type:'trend',item:t,score:s};
  }).filter(r=>r.score>0).sort((a,b)=>b.score-a.score).slice(0,8);

  // Score scenarios
  const scenarioResults=SCENARIOS.map(s=>{
    let sc=scoreText(s.title)*3+scoreText(s.desc)*2+scoreText(s.tip);
    sc+=scoreText(s.fluxWhy||'');
    s.challenge.forEach(c=>{const ch=CHALLENGE_TYPES.find(x=>x.id===c);if(ch)sc+=scoreText(ch.name)*2});
    s.context.forEach(c=>{const ctx=LIFE_CONTEXTS.find(x=>x.id===c);if(ctx)sc+=scoreText(ctx.name)});
    return{type:'scenario',item:s,score:sc};
  }).filter(r=>r.score>0).sort((a,b)=>b.score-a.score).slice(0,6);

  // Score tools
  const toolResults=TOOLS.map(t=>{
    let s=scoreText(t.name)*3+scoreText(t.desc)*2+scoreText(t.type)+scoreText(t.use);
    return{type:'tool',item:t,score:s};
  }).filter(r=>r.score>0).sort((a,b)=>b.score-a.score).slice(0,5);

  // Score research
  const researchResults=RESEARCH.map(r=>{
    let s=scoreText(r.title)*3+scoreText(r.finding)*2+scoreText(r.authors);
    return{type:'research',item:r,score:s};
  }).filter(r=>r.score>0).sort((a,b)=>b.score-a.score).slice(0,4);

  // Build HTML
  let h='';
  const total=trendResults.length+scenarioResults.length+toolResults.length+researchResults.length;
  if(total===0){el.innerHTML='<div class="text-center py-8 text-slate-500 text-sm">Brak wynik√≥w. Spr√≥buj inne s≈Çowa kluczowe.</div>';return}

  // Determine recommended FLUX area based on top results
  const fluxScores={fast:0,liquid:0,unlearn:0,experiment:0};
  trendResults.forEach(r=>r.item.flux.forEach(f=>fluxScores[f]+=r.score));
  scenarioResults.forEach(r=>r.item.area.forEach(a=>fluxScores[a]+=r.score));
  const topFlux=Object.entries(fluxScores).sort((a,b)=>b[1]-a[1])[0];
  if(topFlux[1]>0){
    const fd=FLUX[topFlux[0]],fc=CC[topFlux[0]];
    h+=`<div class="mx-2 mb-3 p-3 rounded-xl ${fc.bg} border ${fc.b}">
      <div class="flex items-center gap-2"><span class="${fc.t} font-black text-lg">${fd.letter}</span><span class="${fc.t} font-bold text-sm">${fd.name}</span></div>
      <p class="text-xs text-slate-400 mt-1">Twoje wyzwanie najbardziej dotyczy obszaru <strong class="${fc.t}">${fd.name}</strong>. ${fd.def.substring(0,80)}...</p>
      <button onclick="closeSearch();showDetail('${topFlux[0]}')" class="text-xs ${fc.t} hover:underline mt-1">Przejd≈∫ do ${fd.letter} ‚Üí</button>
    </div>`;
  }

  if(trendResults.length){
    h+=`<p class="search-cat">üåç Trendy 2025 (${trendResults.length})</p>`;
    trendResults.forEach(r=>{
      const t=r.item,mw=MEGAWORLDS[t.mw];
      h+=`<div class="search-result" onclick="closeSearch();nav('trends');setTimeout(()=>showTrendPopup({clientX:400,clientY:300,stopPropagation:()=>{}},'${t.name.replace(/'/g,"\\'")}'),300)">
        <div class="flex items-center gap-2 mb-1">
          <span class="w-2 h-2 rounded-full flex-shrink-0" style="background:${mw.color}"></span>
          <span class="text-sm font-medium text-slate-200">${t.name}</span>
          ${t.hr?'<span class="text-[9px] px-1.5 py-0.5 rounded-full bg-amber-500/10 text-amber-400">HR</span>':''}
          <span class="text-[9px] text-slate-600 ml-auto">${t.ring.toUpperCase()}</span>
        </div>
        <p class="text-xs text-slate-500">${t.desc.substring(0,80)}...</p>
        <div class="flex gap-1 mt-1">${t.flux.map(a=>`<span class="text-[9px] px-1.5 py-0.5 rounded-full" style="background:${C[a]}15;color:${C[a]}">${FLUX[a].letter}</span>`).join('')}</div>
      </div>`;
    });
  }
  if(scenarioResults.length){
    h+=`<p class="search-cat">üìã Scenariusze (${scenarioResults.length})</p>`;
    scenarioResults.forEach(r=>{
      const s=r.item;
      h+=`<div class="search-result" onclick="closeSearch();nav('explore');filters.area='all';renderExplore()">
        <div class="flex items-center gap-2 mb-1">${s.area.map(a=>`<span class="text-[9px] px-1.5 py-0.5 rounded-full" style="background:${C[a]}15;color:${C[a]}">${FLUX[a].letter}</span>`).join('')}
          <span class="text-sm font-medium text-slate-200">${s.title}</span>
        </div>
        <p class="text-xs text-slate-500">${s.desc.substring(0,80)}...</p>
      </div>`;
    });
  }
  if(toolResults.length){
    h+=`<p class="search-cat">üîß Narzƒôdzia (${toolResults.length})</p>`;
    toolResults.forEach(r=>{
      const t=r.item,c=CC[t.area];
      h+=`<div class="search-result" onclick="closeSearch();nav('tools')">
        <div class="flex items-center gap-2 mb-1"><span class="text-[9px] px-1.5 py-0.5 rounded-full ${c.bg} ${c.t}">${t.type}</span><span class="text-sm font-medium text-slate-200">${t.name}</span></div>
        <p class="text-xs text-slate-500">${t.desc.substring(0,80)}...</p>
      </div>`;
    });
  }
  if(researchResults.length){
    h+=`<p class="search-cat">üìö Badania (${researchResults.length})</p>`;
    researchResults.forEach(r=>{
      const res=r.item;
      h+=`<div class="search-result" onclick="closeSearch();nav('research')">
        <span class="text-sm font-medium text-slate-200">${res.title}</span>
        <p class="text-xs text-slate-500">${res.authors} (${res.year})</p>
      </div>`;
    });
  }

  h+=`<div class="text-center py-3"><p class="text-[10px] text-slate-600">Znaleziono ${total} wynik√≥w dla ‚Äû${query}"</p></div>`;
  el.innerHTML=h;
}

// ===== DOWNLOAD SYSTEM =====
function downloadAsHTML(title,body,filename){
  const html=`<!DOCTYPE html><html lang="pl"><head><meta charset="UTF-8"><title>${title} ‚Äî FLUX</title>
<style>*{font-family:'Inter',system-ui,sans-serif;box-sizing:border-box}body{max-width:900px;margin:auto;padding:2rem;background:#fff;color:#1e293b;line-height:1.6}
h1{color:#f59e0b;border-bottom:3px solid #f59e0b;padding-bottom:.5rem;font-size:1.5rem}h2{color:#334155;font-size:1.2rem;margin-top:2rem}h3{color:#475569;font-size:1rem}
.card{border:1px solid #e2e8f0;border-radius:12px;padding:1.25rem;margin:.75rem 0;page-break-inside:avoid}
.badge{display:inline-block;padding:2px 10px;border-radius:999px;font-size:11px;font-weight:600}
.tip{background:#f0fdf4;border-left:3px solid #22c55e;padding:.75rem 1rem;margin:.5rem 0;border-radius:0 8px 8px 0}
.meta{font-size:12px;color:#94a3b8}
table{width:100%;border-collapse:collapse;margin:1rem 0}th,td{border:1px solid #e2e8f0;padding:.5rem .75rem;text-align:left;font-size:13px}th{background:#f8fafc;font-weight:600}
@media print{body{padding:1cm}.card{page-break-inside:avoid}h1{page-break-before:auto}}
</style></head><body>
<h1>${title}</h1><p class="meta">Wygenerowano z FLUX App | ${new Date().toLocaleDateString('pl')} | flux-diagram.sebastianszajner.github.io</p>
${body}
<hr style="margin-top:2rem;border-color:#e2e8f0"><p class="meta">Model FLUX ¬© Nowe Motywacje | Fast ¬∑ Liquid ¬∑ Unlearn ¬∑ eXperiment</p></body></html>`;
  const blob=new Blob([html],{type:'text/html'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');a.href=url;a.download=filename;a.click();URL.revokeObjectURL(url);
}

function downloadSection(section){
  if(section==='trends'){
    const filtered=trendFilter==='all'&&mwFilter==='all'&&!hrOnly?TRENDS:TRENDS.filter(t=>{
      const showFlux=trendFilter==='all'||t.flux.includes(trendFilter);
      const showMw=mwFilter==='all'||mwFilter===t.mw;
      const showHr=!hrOnly||t.hr;
      return showFlux&&showMw&&showHr;
    });
    const grouped={};filtered.forEach(t=>{if(!grouped[t.mw])grouped[t.mw]=[];grouped[t.mw].push(t)});
    let body=`<p><strong>${filtered.length}</strong> trend√≥w${trendFilter!=='all'?' | Filtr FLUX: '+FLUX[trendFilter].name:''}${mwFilter!=='all'?' | Mega≈õwiat: '+MEGAWORLDS[mwFilter].name:''}${hrOnly?' | Tylko HR':''}</p>`;
    Object.entries(grouped).forEach(([mwId,trends])=>{
      const mw=MEGAWORLDS[mwId];
      body+=`<h2>${mw.icon} ${mw.name}</h2><table><tr><th>Trend</th><th>Horyzont</th><th>FLUX</th><th>HR</th><th>Opis</th></tr>`;
      trends.forEach(t=>{
        body+=`<tr><td><strong>${t.name}</strong></td><td>${t.ring.toUpperCase()}</td><td>${t.flux.map(a=>FLUX[a].letter).join(', ')}</td><td>${t.hr?'‚ö°':''}</td><td>${t.desc}</td></tr>`;
      });
      body+=`</table>`;
    });
    downloadAsHTML('Mapa Trend√≥w FLUX 2025',body,'flux-trendy-2025.html');
  }
  else if(section==='explore'){
    const results=SCENARIOS.filter(s=>{
      if(filters.area!=='all'&&!s.area.includes(filters.area))return false;
      if(filters.industry!=='all'&&!s.industry.includes(filters.industry)&&s.industry.length>0)return false;
      if(filters.industry!=='all'&&s.industry.length===0)return false;
      if(filters.role!=='all'&&!s.role.includes(filters.role)&&s.role.length>0)return false;
      if(filters.role!=='all'&&s.role.length===0)return false;
      if(filters.situation!=='all'&&!s.situation.includes(filters.situation))return false;
      if(filters.context!=='all'&&!s.context.includes(filters.context))return false;
      if(filters.challenge!=='all'&&!s.challenge.includes(filters.challenge))return false;
      return true;
    });
    let body=`<p><strong>${results.length}</strong> scenariuszy</p>`;
    results.forEach(s=>{
      body+=`<div class="card"><h3>${s.title}</h3><p>${s.desc}</p>
      <p class="meta">FLUX: ${s.area.map(a=>FLUX[a].name).join(', ')} | Bran≈ºe: ${s.industry.map(i=>{const ind=INDUSTRIES.find(z=>z.id===i);return ind?ind.name:i}).join(', ')||'Uniwersalny'}</p>
      <div class="tip"><strong>Tip:</strong> ${s.tip}</div>
      ${s.fluxWhy?`<p class="meta" style="margin-top:.5rem"><em>Dlaczego ${s.area.map(a=>FLUX[a].letter).join('+')}:</em> ${s.fluxWhy}</p>`:''}</div>`;
    });
    downloadAsHTML('Scenariusze FLUX',body,'flux-scenariusze.html');
  }
  else if(section==='research'){
    const list=resFilter==='all'?RESEARCH:RESEARCH.filter(r=>r.area===resFilter);
    let body=`<p><strong>${list.length}</strong> bada≈Ñ</p><table><tr><th>Tytu≈Ç</th><th>Autorzy</th><th>Rok</th><th>FLUX</th><th>Typ</th><th>Kluczowy wynik</th></tr>`;
    list.forEach(r=>{
      body+=`<tr><td><strong>${r.title}</strong></td><td>${r.authors}</td><td>${r.year}</td><td>${FLUX[r.area].name}</td><td>${r.type}</td><td>${r.finding}</td></tr>`;
    });
    body+=`</table>`;
    downloadAsHTML('Biblioteka Bada≈Ñ FLUX',body,'flux-badania.html');
  }
  else if(section==='tools'){
    let body='';
    ['fast','liquid','unlearn','experiment'].forEach(a=>{
      const t=TOOLS.filter(x=>x.area===a);
      body+=`<h2>${FLUX[a].letter} ‚Äî ${FLUX[a].name} (${t.length} narzƒôdzi)</h2>`;
      t.forEach(x=>{
        body+=`<div class="card"><span class="badge" style="background:#f59e0b20;color:#f59e0b">${x.type}</span><h3>${x.name}</h3><p>${x.desc}</p><p class="meta"><strong>Kiedy:</strong> ${x.use}</p></div>`;
      });
    });
    downloadAsHTML('Narzƒôdzia FLUX',body,'flux-narzedzia.html');
  }
  else if(section==='detail'&&curArea){
    const d=FLUX[curArea];
    const scenarios=SCENARIOS.filter(s=>s.area.includes(curArea));
    const tools=TOOLS.filter(t=>t.area===curArea);
    const research=RESEARCH.filter(r=>r.area===curArea);
    let body=`<h2>${d.letter} ‚Äî ${d.name}</h2><p>${d.def}</p>
    <div class="card"><h3>Kluczowe pytanie</h3><p style="color:#f59e0b;font-weight:600">${d.q}</p></div>
    <h2>Antywzorce</h2>${d.anti.map(a=>`<p>‚úï ${a}</p>`).join('')}
    <h2>Scenariusze (${scenarios.length})</h2>`;
    scenarios.forEach(s=>{body+=`<div class="card"><h3>${s.title}</h3><p>${s.desc}</p><div class="tip"><strong>Tip:</strong> ${s.tip}</div></div>`});
    body+=`<h2>Narzƒôdzia (${tools.length})</h2>`;
    tools.forEach(t=>{body+=`<div class="card"><span class="badge" style="background:#f59e0b20;color:#f59e0b">${t.type}</span><h3>${t.name}</h3><p>${t.desc}</p></div>`});
    body+=`<h2>Badania (${research.length})</h2>`;
    research.forEach(r=>{body+=`<div class="card"><h3>${r.title}</h3><p class="meta">${r.authors} (${r.year}) ‚Äî ${r.type}</p><p>${r.finding}</p></div>`});
    downloadAsHTML(`FLUX: ${d.name}`,body,`flux-${curArea}.html`);
  }
}

function downloadTrend(name){
  const t=TRENDS.find(tr=>tr.name===name);if(!t)return;
  const mw=MEGAWORLDS[t.mw];
  const relScenarios=getTrendScenarios(t.name);
  const relTools=TOOLS.filter(x=>t.flux.includes(x.area));
  let body=`<div class="card">
    <span class="badge" style="background:${mw.color}20;color:${mw.color}">${mw.icon} ${mw.name}</span>
    <span class="badge" style="background:#f8fafc">${t.ring.toUpperCase()}</span>
    ${t.hr?'<span class="badge" style="background:#fef3c720;color:#f59e0b">‚ö° Trend HR</span>':''}
    <h2>${t.name}</h2><p>${t.desc}</p>
    <p style="margin-top:1rem"><strong>Wp≈Çyw na FLUX:</strong> ${t.flux.map(a=>`${FLUX[a].letter} ‚Äî ${FLUX[a].name}`).join(', ')}</p>
  </div>`;
  if(relScenarios.length){
    body+=`<h2>PowiƒÖzane scenariusze</h2>`;
    relScenarios.forEach(s=>{body+=`<div class="card"><h3>${s.title}</h3><p>${s.desc}</p><div class="tip"><strong>Tip:</strong> ${s.tip}</div></div>`});
  }
  if(relTools.length){
    body+=`<h2>Rekomendowane narzƒôdzia</h2>`;
    relTools.slice(0,4).forEach(x=>{body+=`<div class="card"><span class="badge" style="background:#f59e0b20;color:#f59e0b">${x.type}</span><h3>${x.name}</h3><p>${x.desc}</p></div>`});
  }
  downloadAsHTML(`Trend: ${t.name}`,body,`flux-trend-${t.name.toLowerCase().replace(/\s+/g,'-')}.html`);
}

// ===== CROSS-LINKS: TRENDS ‚Üî SCENARIOS =====
function getTrendScenarios(trendName){
  const t=TRENDS.find(tr=>tr.name===trendName);if(!t)return[];
  return SCENARIOS.filter(s=>s.area.some(a=>t.flux.includes(a))).map(s=>{
    // Score relevance: shared FLUX areas + keyword match in desc/title
    let score=0;
    s.area.forEach(a=>{if(t.flux.includes(a))score+=3});
    const tWords=t.name.toLowerCase().split(/\s+/);
    tWords.forEach(w=>{if(w.length>3&&(s.desc.toLowerCase().includes(w)||s.title.toLowerCase().includes(w)))score+=5});
    return{...s,_score:score};
  }).filter(s=>s._score>0).sort((a,b)=>b._score-a._score).slice(0,4);
}

function getScenarioTrends(scenario){
  return TRENDS.filter(t=>t.flux.some(f=>scenario.area.includes(f))).map(t=>{
    let score=0;
    t.flux.forEach(f=>{if(scenario.area.includes(f))score+=3});
    const words=scenario.title.toLowerCase().split(/\s+/);
    words.forEach(w=>{if(w.length>3&&(t.desc.toLowerCase().includes(w)||t.name.toLowerCase().includes(w)))score+=5});
    return{...t,_score:score};
  }).filter(t=>t._score>0).sort((a,b)=>b._score-a._score).slice(0,5);
}

// ===== SCROLL TO TOP =====
function checkScrollTop(){
  const btn=document.getElementById('scroll-top');
  if(btn)btn.classList.toggle('show',window.scrollY>400);
}

// ===== INIT =====
document.addEventListener('DOMContentLoaded',()=>{
  initFilterChips();
  // Restore projector mode
  if(localStorage.getItem('flux_projector')==='1'){document.documentElement.classList.add('projector');document.querySelector('.projector-btn')?.classList.add('on')}
  // Apply modules (renders nav, shows/hides elements)
  applyModules();
  // Render trend dots on home wheel
  renderWheelTrendDots();
  // Wheel tooltip hover events
  document.querySelectorAll('.flux-quadrant').forEach(g=>{
    const m=g.getAttribute('onclick')?.match(/showDetail\('(\w+)'\)/);
    if(m){
      g.addEventListener('mouseenter',()=>showWheelTooltip(m[1]));
      g.addEventListener('mouseleave',()=>hideWheelTooltip());
    }
  });
  const ttEl=document.getElementById('flux-tooltip');
  if(ttEl){ttEl.addEventListener('mouseenter',keepWheelTooltip);ttEl.addEventListener('mouseleave',hideWheelTooltip);}
  // Keyboard shortcuts
  document.addEventListener('keydown',e=>{
    if((e.ctrlKey||e.metaKey)&&e.key==='k'){e.preventDefault();openSearch()}
    if(e.key==='Escape'){closeSearch();closeSettings();document.getElementById('trend-popup')?.remove();document.getElementById('mini-tooltip')?.remove()}
    if(e.key==='/'&&!e.target.matches('input,textarea')){e.preventDefault();openSearch()}
  });
  // Scroll to top
  window.addEventListener('scroll',checkScrollTop,{passive:true});
});
</script>
</body>
</html>